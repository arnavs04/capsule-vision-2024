2024-10-14 16:53:30,509 - ResNet18 - INFO - Training started for model: ResNet18
2024-10-14 17:06:20,540 - ResNet18 - INFO - Training started for model: ResNet18
2024-10-14 17:09:31,105 - ResNet18 - INFO - Training started for model: ResNet18
2024-10-14 17:13:32,649 - ResNet18 - INFO - Epoch: 1
2024-10-14 17:13:32,651 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.7899768352508545,
        "recall": 0.7376251220703125,
        "f1-score": 0.7629039287567139,
        "specificity": 0.9786198735237122
    },
    "Bleeding": {
        "precision": 0.8502717614173889,
        "recall": 0.8418079018592834,
        "f1-score": 0.8460186719894409,
        "specificity": 0.9837415218353271
    },
    "Erosion": {
        "precision": 0.5436368584632874,
        "recall": 0.5462937951087952,
        "f1-score": 0.5449621081352234,
        "specificity": 0.9502122402191162
    },
    "Erythema": {
        "precision": 0.6364323496818542,
        "recall": 0.6656126379966736,
        "f1-score": 0.6506955027580261,
        "specificity": 0.9573228359222412
    },
    "Foreign Body": {
        "precision": 0.8768116235733032,
        "recall": 0.8532682657241821,
        "f1-score": 0.8648797273635864,
        "specificity": 0.9869693517684937
    },
    "Lymphangiectasia": {
        "precision": 0.8756656050682068,
        "recall": 0.8533990383148193,
        "f1-score": 0.8643889427185059,
        "specificity": 0.9861642122268677
    },
    "Normal": {
        "precision": 0.7963467836380005,
        "recall": 0.7814339399337769,
        "f1-score": 0.7888198494911194,
        "specificity": 0.9779444336891174
    },
    "Polyp": {
        "precision": 0.6598290801048279,
        "recall": 0.7216880321502686,
        "f1-score": 0.6893736720085144,
        "specificity": 0.9588636755943298
    },
    "Ulcer": {
        "precision": 0.9482051134109497,
        "recall": 0.9438489079475403,
        "f1-score": 0.9460219740867615,
        "specificity": 0.99400395154953
    },
    "Worms": {
        "precision": 0.9731437563896179,
        "recall": 0.9793322682380676,
        "f1-score": 0.9762282371520996,
        "specificity": 0.9969851970672607
    },
    "accuracy": 0.7936288714408875,
    "macro avg": {
        "precision": 0.7950319647789001,
        "recall": 0.7924309968948364,
        "f1-score": 0.7934293150901794,
        "specificity": 0.9770827293395996
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9662387371063232,
        "Bleeding": 0.987511396408081,
        "Erosion": 0.9168013334274292,
        "Erythema": 0.9546958208084106,
        "Foreign Body": 0.9888064861297607,
        "Lymphangiectasia": 0.9869257211685181,
        "Normal": 0.9666217565536499,
        "Polyp": 0.9631484746932983,
        "Ulcer": 0.9982044696807861,
        "Worms": 0.9996187090873718
    },
    "average_precision_scores": {
        "Angioectasia": 0.8532909750938416,
        "Bleeding": 0.9238978028297424,
        "Erosion": 0.591129720211029,
        "Erythema": 0.7140191793441772,
        "Foreign Body": 0.936816394329071,
        "Lymphangiectasia": 0.9331316947937012,
        "Normal": 0.8553075790405273,
        "Polyp": 0.758452832698822,
        "Ulcer": 0.9877504110336304,
        "Worms": 0.9965519905090332
    },
    "mean_auc": 0.9728572964668274,
    "mean_average_precision": 0.8550348281860352
}
2024-10-14 17:13:32,651 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.47424042224884033,
        "recall": 0.7223340272903442,
        "f1-score": 0.5725677609443665,
        "specificity": 0.9745442867279053
    },
    "Bleeding": {
        "precision": 0.48784440755844116,
        "recall": 0.8384401202201843,
        "f1-score": 0.6168032884597778,
        "specificity": 0.9799657464027405
    },
    "Erosion": {
        "precision": 0.31019628047943115,
        "recall": 0.5610389709472656,
        "f1-score": 0.3995067775249481,
        "specificity": 0.9037858247756958
    },
    "Erythema": {
        "precision": 0.2572898864746094,
        "recall": 0.5050504803657532,
        "f1-score": 0.34090909361839294,
        "specificity": 0.9726555347442627
    },
    "Foreign Body": {
        "precision": 0.5813449025154114,
        "recall": 0.7882353067398071,
        "f1-score": 0.6691635251045227,
        "specificity": 0.9877786040306091
    },
    "Lymphangiectasia": {
        "precision": 0.5818583965301514,
        "recall": 0.7667638659477234,
        "f1-score": 0.6616352200508118,
        "specificity": 0.9880296587944031
    },
    "Normal": {
        "precision": 0.990409255027771,
        "recall": 0.7227964401245117,
        "f1-score": 0.8357015252113342,
        "specificity": 0.9776332974433899
    },
    "Polyp": {
        "precision": 0.3465045690536499,
        "recall": 0.6840000152587891,
        "f1-score": 0.45998653769493103,
        "specificity": 0.9587385058403015
    },
    "Ulcer": {
        "precision": 0.44136807322502136,
        "recall": 0.9475524425506592,
        "f1-score": 0.602222204208374,
        "specificity": 0.9783541560173035
    },
    "Worms": {
        "precision": 0.11239669471979141,
        "recall": 1.0,
        "f1-score": 0.20208023488521576,
        "specificity": 0.9665712118148804
    },
    "accuracy": 0.7160302400588989,
    "macro avg": {
        "precision": 0.45834532380104065,
        "recall": 0.7536212205886841,
        "f1-score": 0.5360576510429382,
        "specificity": 0.968805730342865
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9477664232254028,
        "Bleeding": 0.9824858903884888,
        "Erosion": 0.8377575278282166,
        "Erythema": 0.9515117406845093,
        "Foreign Body": 0.9729585647583008,
        "Lymphangiectasia": 0.9622588753700256,
        "Normal": 0.9614019393920898,
        "Polyp": 0.9634606838226318,
        "Ulcer": 0.9932796955108643,
        "Worms": 0.9992794990539551
    },
    "average_precision_scores": {
        "Angioectasia": 0.6975440979003906,
        "Bleeding": 0.8085824847221375,
        "Erosion": 0.35831141471862793,
        "Erythema": 0.36692455410957336,
        "Foreign Body": 0.7908612489700317,
        "Lymphangiectasia": 0.7636732459068298,
        "Normal": 0.9873329401016235,
        "Polyp": 0.5507410764694214,
        "Ulcer": 0.9142416715621948,
        "Worms": 0.9432300925254822
    },
    "mean_auc": 0.9572160840034485,
    "mean_average_precision": 0.7181442975997925
}
2024-10-14 17:13:32,652 - ResNet18 - INFO - Epoch: 1 | train_loss: 0.3415 | train_acc: 0.7936 | test_loss: 0.5034 | test_acc: 0.7160
2024-10-14 17:13:32,730 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9572 at epoch 1
2024-10-14 17:17:22,948 - ResNet18 - INFO - Epoch: 2
2024-10-14 17:17:22,949 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8081521987915039,
        "recall": 0.7851108908653259,
        "f1-score": 0.7964649200439453,
        "specificity": 0.9791241884231567
    },
    "Bleeding": {
        "precision": 0.8581847548484802,
        "recall": 0.8561034798622131,
        "f1-score": 0.8571428656578064,
        "specificity": 0.9845114350318909
    },
    "Erosion": {
        "precision": 0.6000526547431946,
        "recall": 0.6033889055252075,
        "f1-score": 0.601716160774231,
        "specificity": 0.9550990462303162
    },
    "Erythema": {
        "precision": 0.6975971460342407,
        "recall": 0.7108622193336487,
        "f1-score": 0.7041671872138977,
        "specificity": 0.9649668335914612
    },
    "Foreign Body": {
        "precision": 0.9018221497535706,
        "recall": 0.8812118172645569,
        "f1-score": 0.8913978338241577,
        "specificity": 0.9893333911895752
    },
    "Lymphangiectasia": {
        "precision": 0.909474790096283,
        "recall": 0.8918219208717346,
        "f1-score": 0.9005618691444397,
        "specificity": 0.9898349046707153
    },
    "Normal": {
        "precision": 0.8199943900108337,
        "recall": 0.8008776903152466,
        "f1-score": 0.8103232979774475,
        "specificity": 0.9811254143714905
    },
    "Polyp": {
        "precision": 0.7038701772689819,
        "recall": 0.75495445728302,
        "f1-score": 0.7285178899765015,
        "specificity": 0.9649868607521057
    },
    "Ulcer": {
        "precision": 0.962992787361145,
        "recall": 0.9596472382545471,
        "f1-score": 0.9613171219825745,
        "specificity": 0.9959250092506409
    },
    "Worms": {
        "precision": 0.9800212979316711,
        "recall": 0.982901394367218,
        "f1-score": 0.9814592599868774,
        "specificity": 0.9977852702140808
    },
    "accuracy": 0.8224532604217529,
    "macro avg": {
        "precision": 0.8242163062095642,
        "recall": 0.8226880431175232,
        "f1-score": 0.8233068585395813,
        "specificity": 0.9802692532539368
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9782935380935669,
        "Bleeding": 0.9902564287185669,
        "Erosion": 0.9352293014526367,
        "Erythema": 0.967463493347168,
        "Foreign Body": 0.9934250712394714,
        "Lymphangiectasia": 0.9928861856460571,
        "Normal": 0.9756194353103638,
        "Polyp": 0.9720697402954102,
        "Ulcer": 0.9993024468421936,
        "Worms": 0.9998189210891724
    },
    "average_precision_scores": {
        "Angioectasia": 0.8918260335922241,
        "Bleeding": 0.9376062154769897,
        "Erosion": 0.6693181991577148,
        "Erythema": 0.786770224571228,
        "Foreign Body": 0.959862232208252,
        "Lymphangiectasia": 0.9595187902450562,
        "Normal": 0.8901596069335938,
        "Polyp": 0.814671516418457,
        "Ulcer": 0.9941195845603943,
        "Worms": 0.9983888268470764
    },
    "mean_auc": 0.9804365038871765,
    "mean_average_precision": 0.8902240991592407
}
2024-10-14 17:17:22,951 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7133890986442566,
        "recall": 0.6861166954040527,
        "f1-score": 0.6994871497154236,
        "specificity": 0.9912375807762146
    },
    "Bleeding": {
        "precision": 0.6697247624397278,
        "recall": 0.8133704662322998,
        "f1-score": 0.7345911860466003,
        "specificity": 0.990870475769043
    },
    "Erosion": {
        "precision": 0.4886753559112549,
        "recall": 0.6164501905441284,
        "f1-score": 0.545176088809967,
        "specificity": 0.9502570629119873
    },
    "Erythema": {
        "precision": 0.25227272510528564,
        "recall": 0.747474730014801,
        "f1-score": 0.3772302567958832,
        "specificity": 0.9584465026855469
    },
    "Foreign Body": {
        "precision": 0.32154005765914917,
        "recall": 0.908823549747467,
        "f1-score": 0.4750192165374756,
        "specificity": 0.9587132930755615
    },
    "Lymphangiectasia": {
        "precision": 0.5340909361839294,
        "recall": 0.8221574425697327,
        "f1-score": 0.6475315690040588,
        "specificity": 0.9844195246696472
    },
    "Normal": {
        "precision": 0.9895415902137756,
        "recall": 0.8239603042602539,
        "f1-score": 0.8991917371749878,
        "specificity": 0.9721716642379761
    },
    "Polyp": {
        "precision": 0.42050519585609436,
        "recall": 0.5659999847412109,
        "f1-score": 0.48252344131469727,
        "specificity": 0.9750511646270752
    },
    "Ulcer": {
        "precision": 0.7584269642829895,
        "recall": 0.9440559148788452,
        "f1-score": 0.84112149477005,
        "specificity": 0.9945727586746216
    },
    "Worms": {
        "precision": 0.49242424964904785,
        "recall": 0.9558823704719543,
        "f1-score": 0.6499999761581421,
        "specificity": 0.995829164981842
    },
    "accuracy": 0.7996528744697571,
    "macro avg": {
        "precision": 0.5640591382980347,
        "recall": 0.7884292006492615,
        "f1-score": 0.6351872086524963,
        "specificity": 0.9771568179130554
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9577631950378418,
        "Bleeding": 0.9881727695465088,
        "Erosion": 0.9375576972961426,
        "Erythema": 0.9617960453033447,
        "Foreign Body": 0.9822105169296265,
        "Lymphangiectasia": 0.9719254970550537,
        "Normal": 0.973379373550415,
        "Polyp": 0.9667210578918457,
        "Ulcer": 0.9986482262611389,
        "Worms": 0.9989801645278931
    },
    "average_precision_scores": {
        "Angioectasia": 0.7460321187973022,
        "Bleeding": 0.8260135054588318,
        "Erosion": 0.6231412291526794,
        "Erythema": 0.4763544797897339,
        "Foreign Body": 0.8512413501739502,
        "Lymphangiectasia": 0.775055468082428,
        "Normal": 0.991466760635376,
        "Polyp": 0.5413838624954224,
        "Ulcer": 0.9523929357528687,
        "Worms": 0.9165953397750854
    },
    "mean_auc": 0.9737154841423035,
    "mean_average_precision": 0.7699676752090454
}
2024-10-14 17:17:22,952 - ResNet18 - INFO - Epoch: 2 | train_loss: 0.2741 | train_acc: 0.8225 | test_loss: 0.3435 | test_acc: 0.7997
2024-10-14 17:17:23,067 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9737 at epoch 2
2024-10-14 17:21:20,696 - ResNet18 - INFO - Epoch: 3
2024-10-14 17:21:20,697 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8501082062721252,
        "recall": 0.8167403340339661,
        "f1-score": 0.8330903053283691,
        "specificity": 0.9835900664329529
    },
    "Bleeding": {
        "precision": 0.8871740102767944,
        "recall": 0.8820105791091919,
        "f1-score": 0.8845847845077515,
        "specificity": 0.9874656200408936
    },
    "Erosion": {
        "precision": 0.6284574270248413,
        "recall": 0.6396859884262085,
        "f1-score": 0.6340219974517822,
        "specificity": 0.9588063359260559
    },
    "Erythema": {
        "precision": 0.7359330058097839,
        "recall": 0.7462844848632812,
        "f1-score": 0.7410725951194763,
        "specificity": 0.9701823592185974
    },
    "Foreign Body": {
        "precision": 0.9153094291687012,
        "recall": 0.902569591999054,
        "f1-score": 0.9088948965072632,
        "specificity": 0.9907885789871216
    },
    "Lymphangiectasia": {
        "precision": 0.9185764193534851,
        "recall": 0.8982335925102234,
        "f1-score": 0.9082911014556885,
        "specificity": 0.9910687804222107
    },
    "Normal": {
        "precision": 0.8549874424934387,
        "recall": 0.829943060874939,
        "f1-score": 0.8422791361808777,
        "specificity": 0.9846993088722229
    },
    "Polyp": {
        "precision": 0.7503105401992798,
        "recall": 0.8031914830207825,
        "f1-score": 0.7758510112762451,
        "specificity": 0.9703075885772705
    },
    "Ulcer": {
        "precision": 0.9713147282600403,
        "recall": 0.9723477959632874,
        "f1-score": 0.9718309640884399,
        "specificity": 0.9968090653419495
    },
    "Worms": {
        "precision": 0.9811023473739624,
        "recall": 0.9886273741722107,
        "f1-score": 0.9848504662513733,
        "specificity": 0.997871458530426
    },
    "accuracy": 0.8483793139457703,
    "macro avg": {
        "precision": 0.8493273854255676,
        "recall": 0.8479634523391724,
        "f1-score": 0.8484767079353333,
        "specificity": 0.9831588864326477
    },
    "auc_roc_scores": {
        "Angioectasia": 0.983632504940033,
        "Bleeding": 0.9929904341697693,
        "Erosion": 0.9447593092918396,
        "Erythema": 0.9744225144386292,
        "Foreign Body": 0.9956117868423462,
        "Lymphangiectasia": 0.9941601753234863,
        "Normal": 0.9794405102729797,
        "Polyp": 0.9790297746658325,
        "Ulcer": 0.9995045065879822,
        "Worms": 0.9998713731765747
    },
    "average_precision_scores": {
        "Angioectasia": 0.9160301089286804,
        "Bleeding": 0.9533534049987793,
        "Erosion": 0.7051997780799866,
        "Erythema": 0.8196166753768921,
        "Foreign Body": 0.9696224927902222,
        "Lymphangiectasia": 0.9658820629119873,
        "Normal": 0.9106369018554688,
        "Polyp": 0.8571953773498535,
        "Ulcer": 0.9960001707077026,
        "Worms": 0.998871922492981
    },
    "mean_auc": 0.9843422770500183,
    "mean_average_precision": 0.9092409014701843
}
2024-10-14 17:21:20,699 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.5122615694999695,
        "recall": 0.7565392255783081,
        "f1-score": 0.6108854413032532,
        "specificity": 0.9771026372909546
    },
    "Bleeding": {
        "precision": 0.8692810535430908,
        "recall": 0.7409470677375793,
        "f1-score": 0.800000011920929,
        "specificity": 0.9974640011787415
    },
    "Erosion": {
        "precision": 0.5300721526145935,
        "recall": 0.5722943544387817,
        "f1-score": 0.5503746867179871,
        "specificity": 0.9608733654022217
    },
    "Erythema": {
        "precision": 0.20903955399990082,
        "recall": 0.6228955984115601,
        "f1-score": 0.3130287528038025,
        "specificity": 0.9557941555976868
    },
    "Foreign Body": {
        "precision": 0.4621451199054718,
        "recall": 0.8617647290229797,
        "f1-score": 0.6016427278518677,
        "specificity": 0.9784067869186401
    },
    "Lymphangiectasia": {
        "precision": 0.3679245412349701,
        "recall": 0.795918345451355,
        "f1-score": 0.5032258033752441,
        "specificity": 0.970295786857605
    },
    "Normal": {
        "precision": 0.9888755083084106,
        "recall": 0.8030438423156738,
        "f1-score": 0.8863238096237183,
        "specificity": 0.9711313247680664
    },
    "Polyp": {
        "precision": 0.3277243673801422,
        "recall": 0.8180000185966492,
        "f1-score": 0.46796339750289917,
        "specificity": 0.9463280439376831
    },
    "Ulcer": {
        "precision": 0.8888888955116272,
        "recall": 0.8951048851013184,
        "f1-score": 0.891986072063446,
        "specificity": 0.997980535030365
    },
    "Worms": {
        "precision": 0.9142857193946838,
        "recall": 0.9411764740943909,
        "f1-score": 0.9275362491607666,
        "specificity": 0.9996265172958374
    },
    "accuracy": 0.7841557264328003,
    "macro avg": {
        "precision": 0.6070498824119568,
        "recall": 0.7807684540748596,
        "f1-score": 0.6552966833114624,
        "specificity": 0.9755002856254578
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9670054912567139,
        "Bleeding": 0.9853646159172058,
        "Erosion": 0.9454963207244873,
        "Erythema": 0.9420356750488281,
        "Foreign Body": 0.9758274555206299,
        "Lymphangiectasia": 0.9592970609664917,
        "Normal": 0.9716438055038452,
        "Polyp": 0.9716127514839172,
        "Ulcer": 0.9975441098213196,
        "Worms": 0.9998708963394165
    },
    "average_precision_scores": {
        "Angioectasia": 0.766155481338501,
        "Bleeding": 0.8534459471702576,
        "Erosion": 0.6270897388458252,
        "Erythema": 0.36992383003234863,
        "Foreign Body": 0.8099339008331299,
        "Lymphangiectasia": 0.7155333757400513,
        "Normal": 0.9910018444061279,
        "Polyp": 0.6048611998558044,
        "Ulcer": 0.9466279149055481,
        "Worms": 0.976087749004364
    },
    "mean_auc": 0.971569836139679,
    "mean_average_precision": 0.7660660743713379
}
2024-10-14 17:21:20,700 - ResNet18 - INFO - Epoch: 3 | train_loss: 0.2338 | train_acc: 0.8484 | test_loss: 0.3550 | test_acc: 0.7842
2024-10-14 17:21:20,701 - ResNet18 - INFO - No improvement for 1 consecutive epochs.
2024-10-14 17:25:14,260 - ResNet18 - INFO - Epoch: 4
2024-10-14 17:25:14,261 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8583515286445618,
        "recall": 0.8368813395500183,
        "f1-score": 0.8474804759025574,
        "specificity": 0.984667181968689
    },
    "Bleeding": {
        "precision": 0.8994638323783875,
        "recall": 0.9009130001068115,
        "f1-score": 0.9001877903938293,
        "specificity": 0.9889324903488159
    },
    "Erosion": {
        "precision": 0.67513108253479,
        "recall": 0.6681234836578369,
        "f1-score": 0.6716089844703674,
        "specificity": 0.965327262878418
    },
    "Erythema": {
        "precision": 0.7763910293579102,
        "recall": 0.7920424342155457,
        "f1-score": 0.7841386795043945,
        "specificity": 0.9745840430259705
    },
    "Foreign Body": {
        "precision": 0.9289573431015015,
        "recall": 0.9168221950531006,
        "f1-score": 0.9228498339653015,
        "specificity": 0.9922317862510681
    },
    "Lymphangiectasia": {
        "precision": 0.9242629408836365,
        "recall": 0.9107142686843872,
        "f1-score": 0.9174385666847229,
        "specificity": 0.9917294383049011
    },
    "Normal": {
        "precision": 0.8699122071266174,
        "recall": 0.8478091955184937,
        "f1-score": 0.8587185144424438,
        "specificity": 0.9855111241340637
    },
    "Polyp": {
        "precision": 0.777917206287384,
        "recall": 0.8249068856239319,
        "f1-score": 0.8007232546806335,
        "specificity": 0.9738544821739197
    },
    "Ulcer": {
        "precision": 0.9754505157470703,
        "recall": 0.97826087474823,
        "f1-score": 0.9768536686897278,
        "specificity": 0.9972180128097534
    },
    "Worms": {
        "precision": 0.9875397682189941,
        "recall": 0.9912187457084656,
        "f1-score": 0.9893758296966553,
        "specificity": 0.9986115097999573
    },
    "accuracy": 0.8673385381698608,
    "macro avg": {
        "precision": 0.8673378229141235,
        "recall": 0.8667692542076111,
        "f1-score": 0.8669375777244568,
        "specificity": 0.9852668046951294
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9877957105636597,
        "Bleeding": 0.9952205419540405,
        "Erosion": 0.9545386433601379,
        "Erythema": 0.9810048937797546,
        "Foreign Body": 0.996208667755127,
        "Lymphangiectasia": 0.9951897263526917,
        "Normal": 0.9831075668334961,
        "Polyp": 0.9839465022087097,
        "Ulcer": 0.9996625781059265,
        "Worms": 0.9999526739120483
    },
    "average_precision_scores": {
        "Angioectasia": 0.9307188987731934,
        "Bleeding": 0.9649074077606201,
        "Erosion": 0.7573215961456299,
        "Erythema": 0.8605780601501465,
        "Foreign Body": 0.9745062589645386,
        "Lymphangiectasia": 0.9720965623855591,
        "Normal": 0.9239193201065063,
        "Polyp": 0.886391818523407,
        "Ulcer": 0.9973288774490356,
        "Worms": 0.9995725154876709
    },
    "mean_auc": 0.9876627326011658,
    "mean_average_precision": 0.9267341494560242
}
2024-10-14 17:25:14,263 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.48231130838394165,
        "recall": 0.8229376077651978,
        "f1-score": 0.608178436756134,
        "specificity": 0.971921980381012
    },
    "Bleeding": {
        "precision": 0.681922197341919,
        "recall": 0.8300835490226746,
        "f1-score": 0.7487437129020691,
        "specificity": 0.9911874532699585
    },
    "Erosion": {
        "precision": 0.5884057879447937,
        "recall": 0.5272727012634277,
        "f1-score": 0.5561643838882446,
        "specificity": 0.9715563654899597
    },
    "Erythema": {
        "precision": 0.25647348165512085,
        "recall": 0.7003366947174072,
        "f1-score": 0.3754512667655945,
        "specificity": 0.9619197845458984
    },
    "Foreign Body": {
        "precision": 0.4215552508831024,
        "recall": 0.908823549747467,
        "f1-score": 0.5759552717208862,
        "specificity": 0.9731509685516357
    },
    "Lymphangiectasia": {
        "precision": 0.6136363744735718,
        "recall": 0.8658891916275024,
        "f1-score": 0.7182587385177612,
        "specificity": 0.9881563186645508
    },
    "Normal": {
        "precision": 0.9886223673820496,
        "recall": 0.8486204743385315,
        "f1-score": 0.9132872223854065,
        "specificity": 0.9687906503677368
    },
    "Polyp": {
        "precision": 0.4138321876525879,
        "recall": 0.7300000190734863,
        "f1-score": 0.528219997882843,
        "specificity": 0.9669268131256104
    },
    "Ulcer": {
        "precision": 0.9260563254356384,
        "recall": 0.9195803999900818,
        "f1-score": 0.9228070378303528,
        "specificity": 0.998674750328064
    },
    "Worms": {
        "precision": 0.8732394576072693,
        "recall": 0.9117646813392639,
        "f1-score": 0.8920863270759583,
        "specificity": 0.9994397163391113
    },
    "accuracy": 0.8211628794670105,
    "macro avg": {
        "precision": 0.6246055364608765,
        "recall": 0.8065308928489685,
        "f1-score": 0.6839152574539185,
        "specificity": 0.9791725277900696
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9654749631881714,
        "Bleeding": 0.9886376857757568,
        "Erosion": 0.929950475692749,
        "Erythema": 0.9555549621582031,
        "Foreign Body": 0.9850203990936279,
        "Lymphangiectasia": 0.9822792410850525,
        "Normal": 0.979863166809082,
        "Polyp": 0.9751708507537842,
        "Ulcer": 0.9990652799606323,
        "Worms": 0.9999111890792847
    },
    "average_precision_scores": {
        "Angioectasia": 0.777894914150238,
        "Bleeding": 0.8446984887123108,
        "Erosion": 0.5895683169364929,
        "Erythema": 0.4192954897880554,
        "Foreign Body": 0.8545770645141602,
        "Lymphangiectasia": 0.853213906288147,
        "Normal": 0.9935712814331055,
        "Polyp": 0.6421483755111694,
        "Ulcer": 0.9762815237045288,
        "Worms": 0.9834034442901611
    },
    "mean_auc": 0.9760928153991699,
    "mean_average_precision": 0.7934653162956238
}
2024-10-14 17:25:14,264 - ResNet18 - INFO - Epoch: 4 | train_loss: 0.1988 | train_acc: 0.8673 | test_loss: 0.2736 | test_acc: 0.8212
2024-10-14 17:25:14,370 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9761 at epoch 4
2024-10-14 17:29:08,459 - ResNet18 - INFO - Epoch: 5
2024-10-14 17:29:08,460 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8883965611457825,
        "recall": 0.865856945514679,
        "f1-score": 0.8769819736480713,
        "specificity": 0.9881128072738647
    },
    "Bleeding": {
        "precision": 0.9077163934707642,
        "recall": 0.9110413193702698,
        "f1-score": 0.909375786781311,
        "specificity": 0.9895219802856445
    },
    "Erosion": {
        "precision": 0.7138356566429138,
        "recall": 0.7024024724960327,
        "f1-score": 0.7080729007720947,
        "specificity": 0.9676902890205383
    },
    "Erythema": {
        "precision": 0.7930945158004761,
        "recall": 0.8170633912086487,
        "f1-score": 0.8049005270004272,
        "specificity": 0.976467490196228
    },
    "Foreign Body": {
        "precision": 0.936307430267334,
        "recall": 0.9258570075035095,
        "f1-score": 0.9310529232025146,
        "specificity": 0.9929972887039185
    },
    "Lymphangiectasia": {
        "precision": 0.9337284564971924,
        "recall": 0.9259951710700989,
        "f1-score": 0.9298457503318787,
        "specificity": 0.9927356243133545
    },
    "Normal": {
        "precision": 0.8880965709686279,
        "recall": 0.8653126955032349,
        "f1-score": 0.8765565752983093,
        "specificity": 0.9879521727561951
    },
    "Polyp": {
        "precision": 0.8109679222106934,
        "recall": 0.853003740310669,
        "f1-score": 0.831454873085022,
        "specificity": 0.9778992533683777
    },
    "Ulcer": {
        "precision": 0.9816879034042358,
        "recall": 0.9809069037437439,
        "f1-score": 0.9812972545623779,
        "specificity": 0.9979607462882996
    },
    "Worms": {
        "precision": 0.9910690188407898,
        "recall": 0.9926809668540955,
        "f1-score": 0.9918743371963501,
        "specificity": 0.9990270733833313
    },
    "accuracy": 0.8833993673324585,
    "macro avg": {
        "precision": 0.8844900131225586,
        "recall": 0.8840120434761047,
        "f1-score": 0.8841413855552673,
        "specificity": 0.9870365262031555
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9907004833221436,
        "Bleeding": 0.9959459900856018,
        "Erosion": 0.9621173739433289,
        "Erythema": 0.9848241806030273,
        "Foreign Body": 0.9973427653312683,
        "Lymphangiectasia": 0.9968043565750122,
        "Normal": 0.9865758419036865,
        "Polyp": 0.9881966710090637,
        "Ulcer": 0.9997715950012207,
        "Worms": 0.9999655485153198
    },
    "average_precision_scores": {
        "Angioectasia": 0.9469409584999084,
        "Bleeding": 0.9706035852432251,
        "Erosion": 0.7945356965065002,
        "Erythema": 0.8795158863067627,
        "Foreign Body": 0.9817767143249512,
        "Lymphangiectasia": 0.979511022567749,
        "Normal": 0.9392043352127075,
        "Polyp": 0.9138063192367554,
        "Ulcer": 0.9979763031005859,
        "Worms": 0.999681293964386
    },
    "mean_auc": 0.9902244806289673,
    "mean_average_precision": 0.9403552412986755
}
2024-10-14 17:29:08,462 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.4973958432674408,
        "recall": 0.7686116695404053,
        "f1-score": 0.6039525866508484,
        "specificity": 0.975311815738678
    },
    "Bleeding": {
        "precision": 0.7526041865348816,
        "recall": 0.8050139546394348,
        "f1-score": 0.7779273390769958,
        "specificity": 0.9939770698547363
    },
    "Erosion": {
        "precision": 0.5279291272163391,
        "recall": 0.6709956526756287,
        "f1-score": 0.5909264087677002,
        "specificity": 0.9537290334701538
    },
    "Erythema": {
        "precision": 0.24036280810832977,
        "recall": 0.7138047218322754,
        "f1-score": 0.35962679982185364,
        "specificity": 0.9576886892318726
    },
    "Foreign Body": {
        "precision": 0.5410714149475098,
        "recall": 0.8911764621734619,
        "f1-score": 0.6733333468437195,
        "specificity": 0.9837259650230408
    },
    "Lymphangiectasia": {
        "precision": 0.5785288214683533,
        "recall": 0.8483964800834656,
        "f1-score": 0.6879432797431946,
        "specificity": 0.9865729212760925
    },
    "Normal": {
        "precision": 0.9907522201538086,
        "recall": 0.8457719683647156,
        "f1-score": 0.912539541721344,
        "specificity": 0.9747724533081055
    },
    "Polyp": {
        "precision": 0.5163297057151794,
        "recall": 0.6639999747276306,
        "f1-score": 0.5809273719787598,
        "specificity": 0.980104923248291
    },
    "Ulcer": {
        "precision": 0.7964601516723633,
        "recall": 0.9440559148788452,
        "f1-score": 0.8640000224113464,
        "specificity": 0.9956455826759338
    },
    "Worms": {
        "precision": 0.7083333134651184,
        "recall": 1.0,
        "f1-score": 0.8292682766914368,
        "specificity": 0.9982569813728333
    },
    "accuracy": 0.8253161311149597,
    "macro avg": {
        "precision": 0.6149768233299255,
        "recall": 0.8151826858520508,
        "f1-score": 0.6880444884300232,
        "specificity": 0.9799785614013672
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9564318656921387,
        "Bleeding": 0.9911991357803345,
        "Erosion": 0.938799262046814,
        "Erythema": 0.9573371410369873,
        "Foreign Body": 0.9871441125869751,
        "Lymphangiectasia": 0.978601336479187,
        "Normal": 0.9810253381729126,
        "Polyp": 0.9768598079681396,
        "Ulcer": 0.9988203048706055,
        "Worms": 0.9999057054519653
    },
    "average_precision_scores": {
        "Angioectasia": 0.7551060914993286,
        "Bleeding": 0.8592116236686707,
        "Erosion": 0.6541093587875366,
        "Erythema": 0.3832247257232666,
        "Foreign Body": 0.8759798407554626,
        "Lymphangiectasia": 0.8517506122589111,
        "Normal": 0.9939676523208618,
        "Polyp": 0.6561977863311768,
        "Ulcer": 0.9620524644851685,
        "Worms": 0.9780385494232178
    },
    "mean_auc": 0.9766125082969666,
    "mean_average_precision": 0.7969638705253601
}
2024-10-14 17:29:08,463 - ResNet18 - INFO - Epoch: 5 | train_loss: 0.1686 | train_acc: 0.8834 | test_loss: 0.2812 | test_acc: 0.8253
2024-10-14 17:29:08,585 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9766 at epoch 5
2024-10-14 17:32:59,875 - ResNet18 - INFO - Epoch: 6
2024-10-14 17:32:59,876 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8929254412651062,
        "recall": 0.8742979168891907,
        "f1-score": 0.8835135102272034,
        "specificity": 0.9884256720542908
    },
    "Bleeding": {
        "precision": 0.9098445773124695,
        "recall": 0.9186502695083618,
        "f1-score": 0.914226233959198,
        "specificity": 0.9896992444992065
    },
    "Erosion": {
        "precision": 0.7258676886558533,
        "recall": 0.7134861350059509,
        "f1-score": 0.7196236848831177,
        "specificity": 0.970137357711792
    },
    "Erythema": {
        "precision": 0.816266655921936,
        "recall": 0.8281926512718201,
        "f1-score": 0.8221864104270935,
        "specificity": 0.9796820878982544
    },
    "Foreign Body": {
        "precision": 0.9336390495300293,
        "recall": 0.929377019405365,
        "f1-score": 0.931503176689148,
        "specificity": 0.992739737033844
    },
    "Lymphangiectasia": {
        "precision": 0.9384781718254089,
        "recall": 0.932939887046814,
        "f1-score": 0.9357008337974548,
        "specificity": 0.9932701587677002
    },
    "Normal": {
        "precision": 0.878899097442627,
        "recall": 0.8650670647621155,
        "f1-score": 0.8719282150268555,
        "specificity": 0.9863033890724182
    },
    "Polyp": {
        "precision": 0.8272493481636047,
        "recall": 0.8592790365219116,
        "f1-score": 0.8429600596427917,
        "specificity": 0.9801547527313232
    },
    "Ulcer": {
        "precision": 0.980320155620575,
        "recall": 0.9790356159210205,
        "f1-score": 0.9796774387359619,
        "specificity": 0.9977805018424988
    },
    "Worms": {
        "precision": 0.9903199672698975,
        "recall": 0.9932578206062317,
        "f1-score": 0.9917867183685303,
        "specificity": 0.9989380240440369
    },
    "accuracy": 0.8894088864326477,
    "macro avg": {
        "precision": 0.8893810510635376,
        "recall": 0.8893583416938782,
        "f1-score": 0.8893106579780579,
        "specificity": 0.9877130389213562
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9919732809066772,
        "Bleeding": 0.9965215921401978,
        "Erosion": 0.9675381183624268,
        "Erythema": 0.9880058765411377,
        "Foreign Body": 0.9976124167442322,
        "Lymphangiectasia": 0.9975647926330566,
        "Normal": 0.9879429936408997,
        "Polyp": 0.9894808530807495,
        "Ulcer": 0.9997725486755371,
        "Worms": 0.9999489784240723
    },
    "average_precision_scores": {
        "Angioectasia": 0.9543289542198181,
        "Bleeding": 0.9730470180511475,
        "Erosion": 0.815500795841217,
        "Erythema": 0.8993438482284546,
        "Foreign Body": 0.9826692342758179,
        "Lymphangiectasia": 0.9828956723213196,
        "Normal": 0.9430279731750488,
        "Polyp": 0.9234572649002075,
        "Ulcer": 0.9981659054756165,
        "Worms": 0.9995545744895935
    },
    "mean_auc": 0.9916362166404724,
    "mean_average_precision": 0.9471991658210754
}
2024-10-14 17:32:59,878 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6040688753128052,
        "recall": 0.7766599655151367,
        "f1-score": 0.6795774698257446,
        "specificity": 0.9838183522224426
    },
    "Bleeding": {
        "precision": 0.7173396944999695,
        "recall": 0.8412256240844727,
        "f1-score": 0.7743589878082275,
        "specificity": 0.9924554824829102
    },
    "Erosion": {
        "precision": 0.5615491271018982,
        "recall": 0.7030302882194519,
        "f1-score": 0.6243752241134644,
        "specificity": 0.9576684236526489
    },
    "Erythema": {
        "precision": 0.408983439207077,
        "recall": 0.5824915766716003,
        "f1-score": 0.48055556416511536,
        "specificity": 0.9842121601104736
    },
    "Foreign Body": {
        "precision": 0.7397959232330322,
        "recall": 0.8529411554336548,
        "f1-score": 0.7923497557640076,
        "specificity": 0.9935410618782043
    },
    "Lymphangiectasia": {
        "precision": 0.5509839057922363,
        "recall": 0.8979591727256775,
        "f1-score": 0.6829268336296082,
        "specificity": 0.9841028451919556
    },
    "Normal": {
        "precision": 0.9901401996612549,
        "recall": 0.8908602595329285,
        "f1-score": 0.9378802180290222,
        "specificity": 0.9716514945030212
    },
    "Polyp": {
        "precision": 0.4542936384677887,
        "recall": 0.656000018119812,
        "f1-score": 0.5368248820304871,
        "specificity": 0.9747952818870544
    },
    "Ulcer": {
        "precision": 0.6997518539428711,
        "recall": 0.9860140085220337,
        "f1-score": 0.8185776472091675,
        "specificity": 0.9923639893531799
    },
    "Worms": {
        "precision": 0.9166666865348816,
        "recall": 0.970588207244873,
        "f1-score": 0.9428571462631226,
        "specificity": 0.9996265172958374
    },
    "accuracy": 0.8612075448036194,
    "macro avg": {
        "precision": 0.6643573641777039,
        "recall": 0.8157770037651062,
        "f1-score": 0.7270283699035645,
        "specificity": 0.98342365026474
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9719032049179077,
        "Bleeding": 0.98869788646698,
        "Erosion": 0.952444314956665,
        "Erythema": 0.9632959365844727,
        "Foreign Body": 0.9807506799697876,
        "Lymphangiectasia": 0.9902714490890503,
        "Normal": 0.9835532307624817,
        "Polyp": 0.9717910289764404,
        "Ulcer": 0.999311089515686,
        "Worms": 0.9999716281890869
    },
    "average_precision_scores": {
        "Angioectasia": 0.801384449005127,
        "Bleeding": 0.8758175373077393,
        "Erosion": 0.7078883647918701,
        "Erythema": 0.5228224396705627,
        "Foreign Body": 0.8681735396385193,
        "Lymphangiectasia": 0.8637385368347168,
        "Normal": 0.9949084520339966,
        "Polyp": 0.6113804578781128,
        "Ulcer": 0.9739453792572021,
        "Worms": 0.9938294291496277
    },
    "mean_auc": 0.9801990389823914,
    "mean_average_precision": 0.821388840675354
}
2024-10-14 17:32:59,878 - ResNet18 - INFO - Epoch: 6 | train_loss: 0.1551 | train_acc: 0.8894 | test_loss: 0.2475 | test_acc: 0.8612
2024-10-14 17:32:59,992 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9802 at epoch 6
2024-10-14 17:36:54,226 - ResNet18 - INFO - Epoch: 7
2024-10-14 17:36:54,228 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.904321014881134,
        "recall": 0.8793997168540955,
        "f1-score": 0.8916862607002258,
        "specificity": 0.9899534583091736
    },
    "Bleeding": {
        "precision": 0.9239968061447144,
        "recall": 0.9296791553497314,
        "f1-score": 0.9268292784690857,
        "specificity": 0.9915552139282227
    },
    "Erosion": {
        "precision": 0.7528089880943298,
        "recall": 0.7557712197303772,
        "f1-score": 0.7542871832847595,
        "specificity": 0.972007691860199
    },
    "Erythema": {
        "precision": 0.8398109078407288,
        "recall": 0.8559957146644592,
        "f1-score": 0.8478260636329651,
        "specificity": 0.9819905161857605
    },
    "Foreign Body": {
        "precision": 0.9469220042228699,
        "recall": 0.935405433177948,
        "f1-score": 0.9411284923553467,
        "specificity": 0.9942784905433655
    },
    "Lymphangiectasia": {
        "precision": 0.9467084407806396,
        "recall": 0.9420327544212341,
        "f1-score": 0.9443648457527161,
        "specificity": 0.9939573407173157
    },
    "Normal": {
        "precision": 0.9050819873809814,
        "recall": 0.8790807127952576,
        "f1-score": 0.8918918967247009,
        "specificity": 0.9895493984222412
    },
    "Polyp": {
        "precision": 0.84013432264328,
        "recall": 0.8728199601173401,
        "f1-score": 0.8561652898788452,
        "specificity": 0.9817296266555786
    },
    "Ulcer": {
        "precision": 0.9815008044242859,
        "recall": 0.9848365783691406,
        "f1-score": 0.9831658601760864,
        "specificity": 0.997898280620575
    },
    "Worms": {
        "precision": 0.993035078048706,
        "recall": 0.9949007034301758,
        "f1-score": 0.9939669966697693,
        "specificity": 0.9992325901985168
    },
    "accuracy": 0.9029436111450195,
    "macro avg": {
        "precision": 0.9034320712089539,
        "recall": 0.9029922485351562,
        "f1-score": 0.9031311869621277,
        "specificity": 0.9892153143882751
    },
    "auc_roc_scores": {
        "Angioectasia": 0.993944525718689,
        "Bleeding": 0.997459888458252,
        "Erosion": 0.9721663594245911,
        "Erythema": 0.989997148513794,
        "Foreign Body": 0.9978697299957275,
        "Lymphangiectasia": 0.9980273246765137,
        "Normal": 0.9891467094421387,
        "Polyp": 0.9912304878234863,
        "Ulcer": 0.9998782873153687,
        "Worms": 0.9999788999557495
    },
    "average_precision_scores": {
        "Angioectasia": 0.9599140882492065,
        "Bleeding": 0.9798557162284851,
        "Erosion": 0.8405052423477173,
        "Erythema": 0.916961669921875,
        "Foreign Body": 0.9851994514465332,
        "Lymphangiectasia": 0.9863376617431641,
        "Normal": 0.9505072832107544,
        "Polyp": 0.9334495067596436,
        "Ulcer": 0.9989431500434875,
        "Worms": 0.9998074769973755
    },
    "mean_auc": 0.9929699301719666,
    "mean_average_precision": 0.9551481604576111
}
2024-10-14 17:36:54,230 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.5720653533935547,
        "recall": 0.7746478915214539,
        "f1-score": 0.6581196784973145,
        "specificity": 0.9815797805786133
    },
    "Bleeding": {
        "precision": 0.678815484046936,
        "recall": 0.8300835490226746,
        "f1-score": 0.7468671798706055,
        "specificity": 0.9910606741905212
    },
    "Erosion": {
        "precision": 0.6215517520904541,
        "recall": 0.6242424249649048,
        "f1-score": 0.6228941679000854,
        "specificity": 0.9706884026527405
    },
    "Erythema": {
        "precision": 0.3359133005142212,
        "recall": 0.7306397557258606,
        "f1-score": 0.46023330092430115,
        "specificity": 0.9729081392288208
    },
    "Foreign Body": {
        "precision": 0.5988258123397827,
        "recall": 0.8999999761581421,
        "f1-score": 0.7191539406776428,
        "specificity": 0.9870187640190125
    },
    "Lymphangiectasia": {
        "precision": 0.5529196858406067,
        "recall": 0.8833819031715393,
        "f1-score": 0.680134654045105,
        "specificity": 0.9844828844070435
    },
    "Normal": {
        "precision": 0.9873452186584473,
        "recall": 0.8889883756637573,
        "f1-score": 0.9355888366699219,
        "specificity": 0.963589072227478
    },
    "Polyp": {
        "precision": 0.49127906560897827,
        "recall": 0.6759999990463257,
        "f1-score": 0.5690235495567322,
        "specificity": 0.9776100516319275
    },
    "Ulcer": {
        "precision": 0.8611111044883728,
        "recall": 0.9755244851112366,
        "f1-score": 0.9147540926933289,
        "specificity": 0.9971601963043213
    },
    "Worms": {
        "precision": 0.8374999761581421,
        "recall": 0.9852941036224365,
        "f1-score": 0.9054054021835327,
        "specificity": 0.9991907477378845
    },
    "accuracy": 0.8577361702919006,
    "macro avg": {
        "precision": 0.6537327170372009,
        "recall": 0.8268802762031555,
        "f1-score": 0.7212175130844116,
        "specificity": 0.9825288653373718
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9621819257736206,
        "Bleeding": 0.9857605695724487,
        "Erosion": 0.9538066983222961,
        "Erythema": 0.9685013294219971,
        "Foreign Body": 0.9850468039512634,
        "Lymphangiectasia": 0.9826228618621826,
        "Normal": 0.9826726913452148,
        "Polyp": 0.9694443345069885,
        "Ulcer": 0.9996522068977356,
        "Worms": 0.9993563890457153
    },
    "average_precision_scores": {
        "Angioectasia": 0.7962338924407959,
        "Bleeding": 0.8471313118934631,
        "Erosion": 0.7132110595703125,
        "Erythema": 0.5449728965759277,
        "Foreign Body": 0.8797803521156311,
        "Lymphangiectasia": 0.8311871290206909,
        "Normal": 0.9946085214614868,
        "Polyp": 0.6496155858039856,
        "Ulcer": 0.9770509600639343,
        "Worms": 0.9830166101455688
    },
    "mean_auc": 0.9789045453071594,
    "mean_average_precision": 0.8216808438301086
}
2024-10-14 17:36:54,231 - ResNet18 - INFO - Epoch: 7 | train_loss: 0.1379 | train_acc: 0.9029 | test_loss: 0.2516 | test_acc: 0.8577
2024-10-14 17:36:54,232 - ResNet18 - INFO - No improvement for 1 consecutive epochs.
2024-10-14 17:40:47,580 - ResNet18 - INFO - Epoch: 8
2024-10-14 17:40:47,581 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9080962538719177,
        "recall": 0.8929532170295715,
        "f1-score": 0.9004610776901245,
        "specificity": 0.9900853037834167
    },
    "Bleeding": {
        "precision": 0.9263297915458679,
        "recall": 0.9290477633476257,
        "f1-score": 0.9276867508888245,
        "specificity": 0.9918187856674194
    },
    "Erosion": {
        "precision": 0.7805071473121643,
        "recall": 0.7727510333061218,
        "f1-score": 0.7766097187995911,
        "specificity": 0.9754018187522888
    },
    "Erythema": {
        "precision": 0.8530303239822388,
        "recall": 0.869498074054718,
        "f1-score": 0.8611854910850525,
        "specificity": 0.9827412366867065
    },
    "Foreign Body": {
        "precision": 0.949185311794281,
        "recall": 0.9457897543907166,
        "f1-score": 0.9474844932556152,
        "specificity": 0.9945839047431946
    },
    "Lymphangiectasia": {
        "precision": 0.9500401020050049,
        "recall": 0.9447396397590637,
        "f1-score": 0.9473824501037598,
        "specificity": 0.994474470615387
    },
    "Normal": {
        "precision": 0.9082669615745544,
        "recall": 0.8837519884109497,
        "f1-score": 0.8958417773246765,
        "specificity": 0.9901373386383057
    },
    "Polyp": {
        "precision": 0.858545184135437,
        "recall": 0.8906005024909973,
        "f1-score": 0.8742791414260864,
        "specificity": 0.9833614826202393
    },
    "Ulcer": {
        "precision": 0.9868385791778564,
        "recall": 0.9855149984359741,
        "f1-score": 0.9861763715744019,
        "specificity": 0.9985536932945251
    },
    "Worms": {
        "precision": 0.9911859035491943,
        "recall": 0.9941065907478333,
        "f1-score": 0.9926441311836243,
        "specificity": 0.999025821685791
    },
    "accuracy": 0.9102560877799988,
    "macro avg": {
        "precision": 0.911202609539032,
        "recall": 0.9108753204345703,
        "f1-score": 0.9109750986099243,
        "specificity": 0.9900184869766235
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9946316480636597,
        "Bleeding": 0.9974291324615479,
        "Erosion": 0.9763820767402649,
        "Erythema": 0.9914944171905518,
        "Foreign Body": 0.9981147050857544,
        "Lymphangiectasia": 0.9981259107589722,
        "Normal": 0.9904941320419312,
        "Polyp": 0.9930379390716553,
        "Ulcer": 0.999861478805542,
        "Worms": 0.9999730587005615
    },
    "average_precision_scores": {
        "Angioectasia": 0.9650251865386963,
        "Bleeding": 0.9801609516143799,
        "Erosion": 0.8610160946846008,
        "Erythema": 0.9326024055480957,
        "Foreign Body": 0.9870232343673706,
        "Lymphangiectasia": 0.986754298210144,
        "Normal": 0.9546961784362793,
        "Polyp": 0.9470174312591553,
        "Ulcer": 0.998717725276947,
        "Worms": 0.9997526407241821
    },
    "mean_auc": 0.9939544796943665,
    "mean_average_precision": 0.961276650428772
}
2024-10-14 17:40:47,582 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.5828313231468201,
        "recall": 0.7786720395088196,
        "f1-score": 0.6666666865348816,
        "specificity": 0.982283353805542
    },
    "Bleeding": {
        "precision": 0.7098321318626404,
        "recall": 0.8245125412940979,
        "f1-score": 0.7628865838050842,
        "specificity": 0.9923286437988281
    },
    "Erosion": {
        "precision": 0.6112957000732422,
        "recall": 0.6372294425964355,
        "f1-score": 0.6239932179450989,
        "specificity": 0.9687520861625671
    },
    "Erythema": {
        "precision": 0.3924843370914459,
        "recall": 0.6329966187477112,
        "f1-score": 0.4845360815525055,
        "specificity": 0.9816229939460754
    },
    "Foreign Body": {
        "precision": 0.6127744317054749,
        "recall": 0.9029411673545837,
        "f1-score": 0.7300832271575928,
        "specificity": 0.9877153038978577
    },
    "Lymphangiectasia": {
        "precision": 0.523809552192688,
        "recall": 0.8658891916275024,
        "f1-score": 0.6527472734451294,
        "specificity": 0.9828994870185852
    },
    "Normal": {
        "precision": 0.9902443289756775,
        "recall": 0.900463879108429,
        "f1-score": 0.9432225227355957,
        "specificity": 0.9716514945030212
    },
    "Polyp": {
        "precision": 0.47894737124443054,
        "recall": 0.7279999852180481,
        "f1-score": 0.5777778029441833,
        "specificity": 0.9746673703193665
    },
    "Ulcer": {
        "precision": 0.9515570998191833,
        "recall": 0.9615384340286255,
        "f1-score": 0.95652174949646,
        "specificity": 0.9991164803504944
    },
    "Worms": {
        "precision": 0.8461538553237915,
        "recall": 0.970588207244873,
        "f1-score": 0.9041095972061157,
        "specificity": 0.99925297498703
    },
    "accuracy": 0.8666005730628967,
    "macro avg": {
        "precision": 0.6699930429458618,
        "recall": 0.8202831149101257,
        "f1-score": 0.7302545309066772,
        "specificity": 0.9840289950370789
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9686732292175293,
        "Bleeding": 0.9902216196060181,
        "Erosion": 0.955417811870575,
        "Erythema": 0.9721336960792542,
        "Foreign Body": 0.9867739677429199,
        "Lymphangiectasia": 0.9833025336265564,
        "Normal": 0.9839573502540588,
        "Polyp": 0.9764717817306519,
        "Ulcer": 0.9994874000549316,
        "Worms": 0.9999231100082397
    },
    "average_precision_scores": {
        "Angioectasia": 0.7921111583709717,
        "Bleeding": 0.8583664894104004,
        "Erosion": 0.7041633129119873,
        "Erythema": 0.5350848436355591,
        "Foreign Body": 0.8848605155944824,
        "Lymphangiectasia": 0.8472132086753845,
        "Normal": 0.9949805736541748,
        "Polyp": 0.6670619249343872,
        "Ulcer": 0.9853582382202148,
        "Worms": 0.9857013821601868
    },
    "mean_auc": 0.9816362261772156,
    "mean_average_precision": 0.8254901766777039
}
2024-10-14 17:40:47,583 - ResNet18 - INFO - Epoch: 8 | train_loss: 0.1251 | train_acc: 0.9103 | test_loss: 0.2226 | test_acc: 0.8666
2024-10-14 17:40:47,688 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9816 at epoch 8
2024-10-14 17:44:38,613 - ResNet18 - INFO - Epoch: 9
2024-10-14 17:44:38,614 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9181286692619324,
        "recall": 0.909186601638794,
        "f1-score": 0.913635790348053,
        "specificity": 0.9908897280693054
    },
    "Bleeding": {
        "precision": 0.9375,
        "recall": 0.948142409324646,
        "f1-score": 0.9427911639213562,
        "specificity": 0.9927366375923157
    },
    "Erosion": {
        "precision": 0.7915880084037781,
        "recall": 0.7879763841629028,
        "f1-score": 0.7897780537605286,
        "specificity": 0.9771848320960999
    },
    "Erythema": {
        "precision": 0.8617191910743713,
        "recall": 0.874559760093689,
        "f1-score": 0.8680920004844666,
        "specificity": 0.9847269654273987
    },
    "Foreign Body": {
        "precision": 0.9575757384300232,
        "recall": 0.9485774040222168,
        "f1-score": 0.9530553221702576,
        "specificity": 0.9952332973480225
    },
    "Lymphangiectasia": {
        "precision": 0.9515823721885681,
        "recall": 0.9462076425552368,
        "f1-score": 0.9488874077796936,
        "specificity": 0.994718074798584
    },
    "Normal": {
        "precision": 0.9153103232383728,
        "recall": 0.8840927481651306,
        "f1-score": 0.8994307518005371,
        "specificity": 0.9909316301345825
    },
    "Polyp": {
        "precision": 0.8648297190666199,
        "recall": 0.8957996964454651,
        "f1-score": 0.880042314529419,
        "specificity": 0.9846575856208801
    },
    "Ulcer": {
        "precision": 0.9871279001235962,
        "recall": 0.9876576066017151,
        "f1-score": 0.9873927235603333,
        "specificity": 0.9985832571983337
    },
    "Worms": {
        "precision": 0.9965581297874451,
        "recall": 0.9978790879249573,
        "f1-score": 0.9972181916236877,
        "specificity": 0.9996157884597778
    },
    "accuracy": 0.9183130860328674,
    "macro avg": {
        "precision": 0.9181920289993286,
        "recall": 0.9180078506469727,
        "f1-score": 0.9180323481559753,
        "specificity": 0.9909278154373169
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9960505366325378,
        "Bleeding": 0.9984431862831116,
        "Erosion": 0.9792133569717407,
        "Erythema": 0.9929347038269043,
        "Foreign Body": 0.9988589286804199,
        "Lymphangiectasia": 0.9983185529708862,
        "Normal": 0.9907404184341431,
        "Polyp": 0.9934346675872803,
        "Ulcer": 0.9999011754989624,
        "Worms": 0.9999849200248718
    },
    "average_precision_scores": {
        "Angioectasia": 0.9729349613189697,
        "Bleeding": 0.9869475960731506,
        "Erosion": 0.8754110336303711,
        "Erythema": 0.9404885768890381,
        "Foreign Body": 0.9910240173339844,
        "Lymphangiectasia": 0.988500714302063,
        "Normal": 0.9565318822860718,
        "Polyp": 0.9489651322364807,
        "Ulcer": 0.9991406798362732,
        "Worms": 0.9998648762702942
    },
    "mean_auc": 0.9947881102561951,
    "mean_average_precision": 0.9659809470176697
}
2024-10-14 17:44:38,618 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7183908224105835,
        "recall": 0.7545271515846252,
        "f1-score": 0.7360156774520874,
        "specificity": 0.9905980229377747
    },
    "Bleeding": {
        "precision": 0.7449495196342468,
        "recall": 0.8217270374298096,
        "f1-score": 0.7814569473266602,
        "specificity": 0.9935966730117798
    },
    "Erosion": {
        "precision": 0.558282196521759,
        "recall": 0.7090908885002136,
        "f1-score": 0.6247139573097229,
        "specificity": 0.9567336440086365
    },
    "Erythema": {
        "precision": 0.27513226866722107,
        "recall": 0.7003366947174072,
        "f1-score": 0.395061731338501,
        "specificity": 0.9653931260108948
    },
    "Foreign Body": {
        "precision": 0.6487695574760437,
        "recall": 0.8529411554336548,
        "f1-score": 0.7369758486747742,
        "specificity": 0.9900582432746887
    },
    "Lymphangiectasia": {
        "precision": 0.6622516512870789,
        "recall": 0.8746355772018433,
        "f1-score": 0.7537688612937927,
        "specificity": 0.9903097152709961
    },
    "Normal": {
        "precision": 0.9882310628890991,
        "recall": 0.8884186744689941,
        "f1-score": 0.9356704950332642,
        "specificity": 0.9661898612976074
    },
    "Polyp": {
        "precision": 0.5099236369132996,
        "recall": 0.6679999828338623,
        "f1-score": 0.5783549547195435,
        "specificity": 0.9794651865959167
    },
    "Ulcer": {
        "precision": 0.8602484464645386,
        "recall": 0.9685314893722534,
        "f1-score": 0.9111841917037964,
        "specificity": 0.9971601963043213
    },
    "Worms": {
        "precision": 0.9852941036224365,
        "recall": 0.9852941036224365,
        "f1-score": 0.9852941036224365,
        "specificity": 0.9999377727508545
    },
    "accuracy": 0.8604636788368225,
    "macro avg": {
        "precision": 0.6951473355293274,
        "recall": 0.8223503232002258,
        "f1-score": 0.7438496947288513,
        "specificity": 0.9829443097114563
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9708424806594849,
        "Bleeding": 0.9876546859741211,
        "Erosion": 0.9416375160217285,
        "Erythema": 0.9570927619934082,
        "Foreign Body": 0.976196825504303,
        "Lymphangiectasia": 0.98591148853302,
        "Normal": 0.9846316576004028,
        "Polyp": 0.9720568060874939,
        "Ulcer": 0.9995843172073364,
        "Worms": 0.9999971985816956
    },
    "average_precision_scores": {
        "Angioectasia": 0.8160275220870972,
        "Bleeding": 0.8643069267272949,
        "Erosion": 0.6844504475593567,
        "Erythema": 0.4389760494232178,
        "Foreign Body": 0.8670554161071777,
        "Lymphangiectasia": 0.8734950423240662,
        "Normal": 0.9951353073120117,
        "Polyp": 0.6664823293685913,
        "Ulcer": 0.9801447987556458,
        "Worms": 0.9993510842323303
    },
    "mean_auc": 0.9775605201721191,
    "mean_average_precision": 0.81854248046875
}
2024-10-14 17:44:38,619 - ResNet18 - INFO - Epoch: 9 | train_loss: 0.1117 | train_acc: 0.9183 | test_loss: 0.2293 | test_acc: 0.8605
2024-10-14 17:44:38,620 - ResNet18 - INFO - No improvement for 1 consecutive epochs.
2024-10-14 17:48:30,700 - ResNet18 - INFO - Epoch: 10
2024-10-14 17:48:30,702 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9255912899971008,
        "recall": 0.916337788105011,
        "f1-score": 0.9209412932395935,
        "specificity": 0.9917174577713013
    },
    "Bleeding": {
        "precision": 0.9397238492965698,
        "recall": 0.9493025541305542,
        "f1-score": 0.9444889426231384,
        "specificity": 0.993299663066864
    },
    "Erosion": {
        "precision": 0.8020152449607849,
        "recall": 0.7976706624031067,
        "f1-score": 0.799837052822113,
        "specificity": 0.9785640835762024
    },
    "Erythema": {
        "precision": 0.8769757747650146,
        "recall": 0.8920149803161621,
        "f1-score": 0.8844314813613892,
        "specificity": 0.9862140417098999
    },
    "Foreign Body": {
        "precision": 0.9574058651924133,
        "recall": 0.9545205235481262,
        "f1-score": 0.9559610486030579,
        "specificity": 0.9954354166984558
    },
    "Lymphangiectasia": {
        "precision": 0.9579718112945557,
        "recall": 0.9543489813804626,
        "f1-score": 0.9561569690704346,
        "specificity": 0.9954283833503723
    },
    "Normal": {
        "precision": 0.9232403635978699,
        "recall": 0.8993531465530396,
        "f1-score": 0.9111402630805969,
        "specificity": 0.9914349913597107
    },
    "Polyp": {
        "precision": 0.889761745929718,
        "recall": 0.909042239189148,
        "f1-score": 0.8992986679077148,
        "specificity": 0.9875697493553162
    },
    "Ulcer": {
        "precision": 0.9891359210014343,
        "recall": 0.9891359210014343,
        "f1-score": 0.9891359210014343,
        "specificity": 0.9987220764160156
    },
    "Worms": {
        "precision": 0.9954557418823242,
        "recall": 0.9954557418823242,
        "f1-score": 0.9954557418823242,
        "specificity": 0.9994980096817017
    },
    "accuracy": 0.9260510206222534,
    "macro avg": {
        "precision": 0.9257278442382812,
        "recall": 0.9257183074951172,
        "f1-score": 0.9256847500801086,
        "specificity": 0.991788387298584
    },
    "auc_roc_scores": {
        "Angioectasia": 0.996584415435791,
        "Bleeding": 0.9983749389648438,
        "Erosion": 0.9821832180023193,
        "Erythema": 0.9942790865898132,
        "Foreign Body": 0.9988579750061035,
        "Lymphangiectasia": 0.9987162351608276,
        "Normal": 0.992851972579956,
        "Polyp": 0.9956854581832886,
        "Ulcer": 0.9999048709869385,
        "Worms": 0.9999886751174927
    },
    "average_precision_scores": {
        "Angioectasia": 0.9777307510375977,
        "Bleeding": 0.9856549501419067,
        "Erosion": 0.8912988901138306,
        "Erythema": 0.9509375095367432,
        "Foreign Body": 0.9917593598365784,
        "Lymphangiectasia": 0.9907947182655334,
        "Normal": 0.964648962020874,
        "Polyp": 0.9647883176803589,
        "Ulcer": 0.9990894198417664,
        "Worms": 0.999897301197052
    },
    "mean_auc": 0.9957427382469177,
    "mean_average_precision": 0.9716600775718689
}
2024-10-14 17:48:30,705 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6502463221549988,
        "recall": 0.7967807054519653,
        "f1-score": 0.7160940170288086,
        "specificity": 0.9863767027854919
    },
    "Bleeding": {
        "precision": 0.7070938348770142,
        "recall": 0.8607242107391357,
        "f1-score": 0.7763819098472595,
        "specificity": 0.9918848872184753
    },
    "Erosion": {
        "precision": 0.599078357219696,
        "recall": 0.6753246784210205,
        "f1-score": 0.6349206566810608,
        "specificity": 0.965146541595459
    },
    "Erythema": {
        "precision": 0.468137264251709,
        "recall": 0.6430976390838623,
        "f1-score": 0.5418439507484436,
        "specificity": 0.9862961769104004
    },
    "Foreign Body": {
        "precision": 0.727053165435791,
        "recall": 0.8852941393852234,
        "f1-score": 0.7984085083007812,
        "specificity": 0.9928444623947144
    },
    "Lymphangiectasia": {
        "precision": 0.6689655184745789,
        "recall": 0.8483964800834656,
        "f1-score": 0.7480719685554504,
        "specificity": 0.9908797144889832
    },
    "Normal": {
        "precision": 0.9882881045341492,
        "recall": 0.9134044051170349,
        "f1-score": 0.9493719339370728,
        "specificity": 0.9654096364974976
    },
    "Polyp": {
        "precision": 0.481575608253479,
        "recall": 0.7580000162124634,
        "f1-score": 0.5889666080474854,
        "specificity": 0.9738997220993042
    },
    "Ulcer": {
        "precision": 0.8881788849830627,
        "recall": 0.9720279574394226,
        "f1-score": 0.9282137155532837,
        "specificity": 0.9977912306785583
    },
    "Worms": {
        "precision": 0.9436619877815247,
        "recall": 0.9852941036224365,
        "f1-score": 0.9640287756919861,
        "specificity": 0.9997509717941284
    },
    "accuracy": 0.8811678886413574,
    "macro avg": {
        "precision": 0.7122279405593872,
        "recall": 0.8338344693183899,
        "f1-score": 0.7646301984786987,
        "specificity": 0.9850279688835144
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9692062735557556,
        "Bleeding": 0.9890069961547852,
        "Erosion": 0.9500049352645874,
        "Erythema": 0.974172830581665,
        "Foreign Body": 0.987891674041748,
        "Lymphangiectasia": 0.9848322868347168,
        "Normal": 0.9867287278175354,
        "Polyp": 0.978837251663208,
        "Ulcer": 0.9997894763946533,
        "Worms": 0.9999578595161438
    },
    "average_precision_scores": {
        "Angioectasia": 0.8142266869544983,
        "Bleeding": 0.8770049810409546,
        "Erosion": 0.7175360918045044,
        "Erythema": 0.6321105360984802,
        "Foreign Body": 0.9090895652770996,
        "Lymphangiectasia": 0.8454722166061401,
        "Normal": 0.9958014488220215,
        "Polyp": 0.708869457244873,
        "Ulcer": 0.9905275702476501,
        "Worms": 0.9915604591369629
    },
    "mean_auc": 0.9820427894592285,
    "mean_average_precision": 0.8482198715209961
}
2024-10-14 17:48:30,707 - ResNet18 - INFO - Epoch: 10 | train_loss: 0.0982 | train_acc: 0.9261 | test_loss: 0.1980 | test_acc: 0.8812
2024-10-14 17:48:30,811 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9820 at epoch 10
2024-10-14 17:52:23,907 - ResNet18 - INFO - Epoch: 11
2024-10-14 17:52:23,908 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9332799315452576,
        "recall": 0.9275861978530884,
        "f1-score": 0.9304243922233582,
        "specificity": 0.9926116466522217
    },
    "Bleeding": {
        "precision": 0.9449838399887085,
        "recall": 0.9506239891052246,
        "f1-score": 0.9477955102920532,
        "specificity": 0.9939860105514526
    },
    "Erosion": {
        "precision": 0.8249194622039795,
        "recall": 0.815936267375946,
        "f1-score": 0.8204032778739929,
        "specificity": 0.9807339906692505
    },
    "Erythema": {
        "precision": 0.8905165791511536,
        "recall": 0.906593382358551,
        "f1-score": 0.8984830975532532,
        "specificity": 0.9873908758163452
    },
    "Foreign Body": {
        "precision": 0.9550315141677856,
        "recall": 0.9521596431732178,
        "f1-score": 0.9535934329032898,
        "specificity": 0.9951692223548889
    },
    "Lymphangiectasia": {
        "precision": 0.9628185033798218,
        "recall": 0.9595749974250793,
        "f1-score": 0.9611940383911133,
        "specificity": 0.9957627058029175
    },
    "Normal": {
        "precision": 0.9199676513671875,
        "recall": 0.8962982296943665,
        "f1-score": 0.9079787135124207,
        "specificity": 0.9912124872207642
    },
    "Polyp": {
        "precision": 0.8937210440635681,
        "recall": 0.9141879677772522,
        "f1-score": 0.9038386344909668,
        "specificity": 0.9877839684486389
    },
    "Ulcer": {
        "precision": 0.9896907210350037,
        "recall": 0.9907382726669312,
        "f1-score": 0.9902142286300659,
        "specificity": 0.9988471269607544
    },
    "Worms": {
        "precision": 0.9961790442466736,
        "recall": 0.9972677826881409,
        "f1-score": 0.9967231154441833,
        "specificity": 0.9995875954627991
    },
    "accuracy": 0.9308107495307922,
    "macro avg": {
        "precision": 0.9311107993125916,
        "recall": 0.9310966730117798,
        "f1-score": 0.931064784526825,
        "specificity": 0.9923086166381836
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9972023963928223,
        "Bleeding": 0.9985664486885071,
        "Erosion": 0.9847239255905151,
        "Erythema": 0.995255708694458,
        "Foreign Body": 0.9989620447158813,
        "Lymphangiectasia": 0.9989678859710693,
        "Normal": 0.9925907850265503,
        "Polyp": 0.9958007335662842,
        "Ulcer": 0.9999234080314636,
        "Worms": 0.9999935626983643
    },
    "average_precision_scores": {
        "Angioectasia": 0.9808476567268372,
        "Bleeding": 0.9885738492012024,
        "Erosion": 0.9043868184089661,
        "Erythema": 0.9603381156921387,
        "Foreign Body": 0.9918356537818909,
        "Lymphangiectasia": 0.9926149845123291,
        "Normal": 0.9648169875144958,
        "Polyp": 0.966283917427063,
        "Ulcer": 0.9993821978569031,
        "Worms": 0.9999402761459351
    },
    "mean_auc": 0.9961986541748047,
    "mean_average_precision": 0.9749020934104919
}
2024-10-14 17:52:23,911 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6130030751228333,
        "recall": 0.7967807054519653,
        "f1-score": 0.6929134130477905,
        "specificity": 0.9840102195739746
    },
    "Bleeding": {
        "precision": 0.7801046967506409,
        "recall": 0.8300835490226746,
        "f1-score": 0.8043184876441956,
        "specificity": 0.9946744441986084
    },
    "Erosion": {
        "precision": 0.5945144295692444,
        "recall": 0.694372296333313,
        "f1-score": 0.6405750513076782,
        "specificity": 0.9634773135185242
    },
    "Erythema": {
        "precision": 0.4739725887775421,
        "recall": 0.5824915766716003,
        "f1-score": 0.5226585865020752,
        "specificity": 0.9878749847412109
    },
    "Foreign Body": {
        "precision": 0.7163814306259155,
        "recall": 0.8617647290229797,
        "f1-score": 0.7823765277862549,
        "specificity": 0.9926545023918152
    },
    "Lymphangiectasia": {
        "precision": 0.6068548560142517,
        "recall": 0.8775510191917419,
        "f1-score": 0.7175208330154419,
        "specificity": 0.9876496195793152
    },
    "Normal": {
        "precision": 0.9899381995201111,
        "recall": 0.9128347039222717,
        "f1-score": 0.9498242735862732,
        "specificity": 0.9703510999679565
    },
    "Polyp": {
        "precision": 0.5038560628890991,
        "recall": 0.7839999794960022,
        "f1-score": 0.613458514213562,
        "specificity": 0.975307047367096
    },
    "Ulcer": {
        "precision": 0.8925081491470337,
        "recall": 0.9580419659614563,
        "f1-score": 0.9241146445274353,
        "specificity": 0.9979174733161926
    },
    "Worms": {
        "precision": 0.9714285731315613,
        "recall": 1.0,
        "f1-score": 0.9855072498321533,
        "specificity": 0.9998754858970642
    },
    "accuracy": 0.8810439109802246,
    "macro avg": {
        "precision": 0.714256227016449,
        "recall": 0.8297920227050781,
        "f1-score": 0.7633267641067505,
        "specificity": 0.9853792190551758
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9746423959732056,
        "Bleeding": 0.9883379936218262,
        "Erosion": 0.9534986019134521,
        "Erythema": 0.9696593284606934,
        "Foreign Body": 0.9803541302680969,
        "Lymphangiectasia": 0.9793641567230225,
        "Normal": 0.9872786402702332,
        "Polyp": 0.9802906513214111,
        "Ulcer": 0.9993019104003906,
        "Worms": 0.9999816417694092
    },
    "average_precision_scores": {
        "Angioectasia": 0.8142784833908081,
        "Bleeding": 0.8764641880989075,
        "Erosion": 0.7309389710426331,
        "Erythema": 0.5672339200973511,
        "Foreign Body": 0.8754018545150757,
        "Lymphangiectasia": 0.8510565757751465,
        "Normal": 0.9960207939147949,
        "Polyp": 0.7132446765899658,
        "Ulcer": 0.9820802807807922,
        "Worms": 0.995306134223938
    },
    "mean_auc": 0.981270968914032,
    "mean_average_precision": 0.8402025103569031
}
2024-10-14 17:52:23,913 - ResNet18 - INFO - Epoch: 11 | train_loss: 0.0923 | train_acc: 0.9308 | test_loss: 0.2034 | test_acc: 0.8810
2024-10-14 17:52:23,915 - ResNet18 - INFO - No improvement for 1 consecutive epochs.
2024-10-14 17:56:17,430 - ResNet18 - INFO - Epoch: 12
2024-10-14 17:56:17,431 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9365208148956299,
        "recall": 0.928992509841919,
        "f1-score": 0.9327414631843567,
        "specificity": 0.9930627346038818
    },
    "Bleeding": {
        "precision": 0.9479221701622009,
        "recall": 0.9496706128120422,
        "f1-score": 0.9487955570220947,
        "specificity": 0.994144082069397
    },
    "Erosion": {
        "precision": 0.8412438631057739,
        "recall": 0.8319395780563354,
        "f1-score": 0.8365658521652222,
        "specificity": 0.9828318357467651
    },
    "Erythema": {
        "precision": 0.8962885141372681,
        "recall": 0.9123794436454773,
        "f1-score": 0.904262363910675,
        "specificity": 0.9883689880371094
    },
    "Foreign Body": {
        "precision": 0.9637236595153809,
        "recall": 0.9632098078727722,
        "f1-score": 0.9634666442871094,
        "specificity": 0.9959830045700073
    },
    "Lymphangiectasia": {
        "precision": 0.9634310007095337,
        "recall": 0.9631720185279846,
        "f1-score": 0.9633015394210815,
        "specificity": 0.9959866404533386
    },
    "Normal": {
        "precision": 0.9365761876106262,
        "recall": 0.9108729958534241,
        "f1-score": 0.923545777797699,
        "specificity": 0.9930137991905212
    },
    "Polyp": {
        "precision": 0.9058645963668823,
        "recall": 0.9311772584915161,
        "f1-score": 0.9183465242385864,
        "specificity": 0.9889159202575684
    },
    "Ulcer": {
        "precision": 0.9901856780052185,
        "recall": 0.9888741970062256,
        "f1-score": 0.9895294904708862,
        "specificity": 0.9989063739776611
    },
    "Worms": {
        "precision": 0.9964921474456787,
        "recall": 0.9970302581787109,
        "f1-score": 0.99676114320755,
        "specificity": 0.9996165633201599
    },
    "accuracy": 0.9377509355545044,
    "macro avg": {
        "precision": 0.9378248453140259,
        "recall": 0.937731921672821,
        "f1-score": 0.9377316832542419,
        "specificity": 0.9930830001831055
    },
    "auc_roc_scores": {
        "Angioectasia": 0.997360110282898,
        "Bleeding": 0.9986780881881714,
        "Erosion": 0.9861962199211121,
        "Erythema": 0.9959826469421387,
        "Foreign Body": 0.9992427825927734,
        "Lymphangiectasia": 0.9990254640579224,
        "Normal": 0.9945725798606873,
        "Polyp": 0.9966557621955872,
        "Ulcer": 0.9999242424964905,
        "Worms": 0.9999945759773254
    },
    "average_precision_scores": {
        "Angioectasia": 0.9819819331169128,
        "Bleeding": 0.9891719818115234,
        "Erosion": 0.9159961938858032,
        "Erythema": 0.9647362232208252,
        "Foreign Body": 0.9940494298934937,
        "Lymphangiectasia": 0.9932743310928345,
        "Normal": 0.9732183218002319,
        "Polyp": 0.9733547568321228,
        "Ulcer": 0.9993124008178711,
        "Worms": 0.9999497532844543
    },
    "mean_auc": 0.9967632293701172,
    "mean_average_precision": 0.9785045981407166
}
2024-10-14 17:56:17,433 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6251993775367737,
        "recall": 0.7887324094772339,
        "f1-score": 0.6975088715553284,
        "specificity": 0.9849696159362793
    },
    "Bleeding": {
        "precision": 0.7792553305625916,
        "recall": 0.8161559700965881,
        "f1-score": 0.7972789406776428,
        "specificity": 0.9947378635406494
    },
    "Erosion": {
        "precision": 0.574035108089447,
        "recall": 0.7082251310348511,
        "f1-score": 0.6341085433959961,
        "specificity": 0.9594711661338806
    },
    "Erythema": {
        "precision": 0.4151785671710968,
        "recall": 0.6262626051902771,
        "f1-score": 0.4993288516998291,
        "specificity": 0.9834543466567993
    },
    "Foreign Body": {
        "precision": 0.7170263528823853,
        "recall": 0.8794117569923401,
        "f1-score": 0.7899603843688965,
        "specificity": 0.9925278425216675
    },
    "Lymphangiectasia": {
        "precision": 0.6985294222831726,
        "recall": 0.8309037685394287,
        "f1-score": 0.7589880228042603,
        "specificity": 0.992209792137146
    },
    "Normal": {
        "precision": 0.9856981039047241,
        "recall": 0.9199153780937195,
        "f1-score": 0.951671302318573,
        "specificity": 0.9573472142219543
    },
    "Polyp": {
        "precision": 0.584055483341217,
        "recall": 0.6740000247955322,
        "f1-score": 0.6258124709129333,
        "specificity": 0.9846468567848206
    },
    "Ulcer": {
        "precision": 0.8899676203727722,
        "recall": 0.9615384340286255,
        "f1-score": 0.924369752407074,
        "specificity": 0.9978543519973755
    },
    "Worms": {
        "precision": 0.8589743375778198,
        "recall": 0.9852941036224365,
        "f1-score": 0.9178082346916199,
        "specificity": 0.9993152618408203
    },
    "accuracy": 0.8836473822593689,
    "macro avg": {
        "precision": 0.7127920389175415,
        "recall": 0.8190439343452454,
        "f1-score": 0.7596835494041443,
        "specificity": 0.9846534729003906
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9654884934425354,
        "Bleeding": 0.9892533421516418,
        "Erosion": 0.9595375061035156,
        "Erythema": 0.970964252948761,
        "Foreign Body": 0.9824404716491699,
        "Lymphangiectasia": 0.9836825728416443,
        "Normal": 0.98726886510849,
        "Polyp": 0.9762520790100098,
        "Ulcer": 0.9990538954734802,
        "Worms": 0.9998974800109863
    },
    "average_precision_scores": {
        "Angioectasia": 0.8161367177963257,
        "Bleeding": 0.8737809658050537,
        "Erosion": 0.7364866733551025,
        "Erythema": 0.574631929397583,
        "Foreign Body": 0.8995705842971802,
        "Lymphangiectasia": 0.8667833805084229,
        "Normal": 0.9959993958473206,
        "Polyp": 0.6972935795783997,
        "Ulcer": 0.9828276634216309,
        "Worms": 0.9885461330413818
    },
    "mean_auc": 0.9813839197158813,
    "mean_average_precision": 0.8432057499885559
}
2024-10-14 17:56:17,435 - ResNet18 - INFO - Epoch: 12 | train_loss: 0.0831 | train_acc: 0.9378 | test_loss: 0.1928 | test_acc: 0.8836
2024-10-14 17:56:17,437 - ResNet18 - INFO - No improvement for 2 consecutive epochs.
2024-10-14 18:00:09,170 - ResNet18 - INFO - Epoch: 13
2024-10-14 18:00:09,172 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9454061388969421,
        "recall": 0.940397322177887,
        "f1-score": 0.9428951144218445,
        "specificity": 0.9939406514167786
    },
    "Bleeding": {
        "precision": 0.9465851783752441,
        "recall": 0.956498384475708,
        "f1-score": 0.9515159726142883,
        "specificity": 0.9940678477287292
    },
    "Erosion": {
        "precision": 0.8475494384765625,
        "recall": 0.8413978219032288,
        "f1-score": 0.8444624543190002,
        "specificity": 0.9833859801292419
    },
    "Erythema": {
        "precision": 0.9015212059020996,
        "recall": 0.9149512648582458,
        "f1-score": 0.9081865549087524,
        "specificity": 0.9891198873519897
    },
    "Foreign Body": {
        "precision": 0.9608637094497681,
        "recall": 0.9626825451850891,
        "f1-score": 0.9617722630500793,
        "specificity": 0.9957238435745239
    },
    "Lymphangiectasia": {
        "precision": 0.9697130918502808,
        "recall": 0.9643328785896301,
        "f1-score": 0.9670155048370361,
        "specificity": 0.9966294169425964
    },
    "Normal": {
        "precision": 0.9441760778427124,
        "recall": 0.9175795316696167,
        "f1-score": 0.9306878447532654,
        "specificity": 0.9938412308692932
    },
    "Polyp": {
        "precision": 0.9094477891921997,
        "recall": 0.9261727333068848,
        "f1-score": 0.9177340269088745,
        "specificity": 0.9897799491882324
    },
    "Ulcer": {
        "precision": 0.9925238490104675,
        "recall": 0.9935483932495117,
        "f1-score": 0.9930358529090881,
        "specificity": 0.9991402626037598
    },
    "Worms": {
        "precision": 0.9968034029006958,
        "recall": 0.9973347783088684,
        "f1-score": 0.9970690011978149,
        "specificity": 0.9996455311775208
    },
    "accuracy": 0.9417129755020142,
    "macro avg": {
        "precision": 0.9414590001106262,
        "recall": 0.9414896368980408,
        "f1-score": 0.9414374232292175,
        "specificity": 0.9935274124145508
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9980106949806213,
        "Bleeding": 0.9990171790122986,
        "Erosion": 0.9884852766990662,
        "Erythema": 0.9969009757041931,
        "Foreign Body": 0.9992491006851196,
        "Lymphangiectasia": 0.9992830753326416,
        "Normal": 0.9957302212715149,
        "Polyp": 0.9973025918006897,
        "Ulcer": 0.9999743103981018,
        "Worms": 0.9999946355819702
    },
    "average_precision_scores": {
        "Angioectasia": 0.9863141179084778,
        "Bleeding": 0.9913232922554016,
        "Erosion": 0.9270201921463013,
        "Erythema": 0.9721367359161377,
        "Foreign Body": 0.9940301775932312,
        "Lymphangiectasia": 0.9944444894790649,
        "Normal": 0.9772424697875977,
        "Polyp": 0.9789479970932007,
        "Ulcer": 0.9997777342796326,
        "Worms": 0.9999521374702454
    },
    "mean_auc": 0.997394859790802,
    "mean_average_precision": 0.9821190237998962
}
2024-10-14 18:00:09,175 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.658823549747467,
        "recall": 0.7887324094772339,
        "f1-score": 0.7179487347602844,
        "specificity": 0.9870163202285767
    },
    "Bleeding": {
        "precision": 0.7648578882217407,
        "recall": 0.8245125412940979,
        "f1-score": 0.7935656905174255,
        "specificity": 0.9942306280136108
    },
    "Erosion": {
        "precision": 0.6385449171066284,
        "recall": 0.7142857313156128,
        "f1-score": 0.6742950677871704,
        "specificity": 0.9688188433647156
    },
    "Erythema": {
        "precision": 0.4628712832927704,
        "recall": 0.6296296119689941,
        "f1-score": 0.5335235595703125,
        "specificity": 0.9862961769104004
    },
    "Foreign Body": {
        "precision": 0.7183098793029785,
        "recall": 0.8999999761581421,
        "f1-score": 0.7989556193351746,
        "specificity": 0.9924012422561646
    },
    "Lymphangiectasia": {
        "precision": 0.6757990717887878,
        "recall": 0.8629737496376038,
        "f1-score": 0.7580025792121887,
        "specificity": 0.9910063743591309
    },
    "Normal": {
        "precision": 0.9898295998573303,
        "recall": 0.9267518520355225,
        "f1-score": 0.9572527408599854,
        "specificity": 0.9695708751678467
    },
    "Polyp": {
        "precision": 0.5131034255027771,
        "recall": 0.7440000176429749,
        "f1-score": 0.6073469519615173,
        "specificity": 0.9774181246757507
    },
    "Ulcer": {
        "precision": 0.9480968713760376,
        "recall": 0.9580419659614563,
        "f1-score": 0.9530434608459473,
        "specificity": 0.999053418636322
    },
    "Worms": {
        "precision": 0.9305555820465088,
        "recall": 0.9852941036224365,
        "f1-score": 0.9571428298950195,
        "specificity": 0.9996887445449829
    },
    "accuracy": 0.8927597403526306,
    "macro avg": {
        "precision": 0.730079174041748,
        "recall": 0.8334221839904785,
        "f1-score": 0.7751078009605408,
        "specificity": 0.9865501523017883
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9698650240898132,
        "Bleeding": 0.9902486801147461,
        "Erosion": 0.9639393091201782,
        "Erythema": 0.9699734449386597,
        "Foreign Body": 0.9871436953544617,
        "Lymphangiectasia": 0.9845306873321533,
        "Normal": 0.9889302849769592,
        "Polyp": 0.9779171943664551,
        "Ulcer": 0.9996263980865479,
        "Worms": 0.9999459981918335
    },
    "average_precision_scores": {
        "Angioectasia": 0.8288041353225708,
        "Bleeding": 0.8770995140075684,
        "Erosion": 0.7678956985473633,
        "Erythema": 0.5417096614837646,
        "Foreign Body": 0.9092049598693848,
        "Lymphangiectasia": 0.8687393665313721,
        "Normal": 0.9966212511062622,
        "Polyp": 0.7003234624862671,
        "Ulcer": 0.9879668354988098,
        "Worms": 0.9870114326477051
    },
    "mean_auc": 0.9832121133804321,
    "mean_average_precision": 0.8465375900268555
}
2024-10-14 18:00:09,176 - ResNet18 - INFO - Epoch: 13 | train_loss: 0.0720 | train_acc: 0.9417 | test_loss: 0.1921 | test_acc: 0.8928
2024-10-14 18:00:09,285 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9832 at epoch 13
2024-10-14 18:04:02,933 - ResNet18 - INFO - Epoch: 14
2024-10-14 18:04:02,935 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9489110112190247,
        "recall": 0.9430785775184631,
        "f1-score": 0.9459857940673828,
        "specificity": 0.9943894743919373
    },
    "Bleeding": {
        "precision": 0.9534050226211548,
        "recall": 0.9630204439163208,
        "f1-score": 0.9581885933876038,
        "specificity": 0.9946057796478271
    },
    "Erosion": {
        "precision": 0.8683351278305054,
        "recall": 0.8582952618598938,
        "f1-score": 0.863286018371582,
        "specificity": 0.9857176542282104
    },
    "Erythema": {
        "precision": 0.9143370389938354,
        "recall": 0.9305664300918579,
        "f1-score": 0.9223803281784058,
        "specificity": 0.9901113510131836
    },
    "Foreign Body": {
        "precision": 0.9705723524093628,
        "recall": 0.9658785462379456,
        "f1-score": 0.9682197570800781,
        "specificity": 0.9967832565307617
    },
    "Lymphangiectasia": {
        "precision": 0.9659152030944824,
        "recall": 0.965656042098999,
        "f1-score": 0.965785562992096,
        "specificity": 0.9962514638900757
    },
    "Normal": {
        "precision": 0.939709484577179,
        "recall": 0.9180722832679749,
        "f1-score": 0.9287648797035217,
        "specificity": 0.9935049414634705
    },
    "Polyp": {
        "precision": 0.921818196773529,
        "recall": 0.937648594379425,
        "f1-score": 0.9296659827232361,
        "specificity": 0.9911004900932312
    },
    "Ulcer": {
        "precision": 0.9947410225868225,
        "recall": 0.9936957955360413,
        "f1-score": 0.994218111038208,
        "specificity": 0.9994083046913147
    },
    "Worms": {
        "precision": 0.9970067739486694,
        "recall": 0.9978213310241699,
        "f1-score": 0.9974139332771301,
        "specificity": 0.9996758699417114
    },
    "accuracy": 0.9474034309387207,
    "macro avg": {
        "precision": 0.9474750757217407,
        "recall": 0.9473733305931091,
        "f1-score": 0.9473909735679626,
        "specificity": 0.9941549301147461
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9984396696090698,
        "Bleeding": 0.9992142915725708,
        "Erosion": 0.9904050230979919,
        "Erythema": 0.9973398447036743,
        "Foreign Body": 0.9994354248046875,
        "Lymphangiectasia": 0.9993996024131775,
        "Normal": 0.9944531321525574,
        "Polyp": 0.9978676438331604,
        "Ulcer": 0.9999867677688599,
        "Worms": 0.9999973773956299
    },
    "average_precision_scores": {
        "Angioectasia": 0.9883933067321777,
        "Bleeding": 0.9930859804153442,
        "Erosion": 0.9370924234390259,
        "Erythema": 0.9761368036270142,
        "Foreign Body": 0.9954639673233032,
        "Lymphangiectasia": 0.9952929019927979,
        "Normal": 0.9745882153511047,
        "Polyp": 0.9822646379470825,
        "Ulcer": 0.9998824000358582,
        "Worms": 0.9999760389328003
    },
    "mean_auc": 0.9976539015769958,
    "mean_average_precision": 0.984217643737793
}
2024-10-14 18:04:02,938 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6388012766838074,
        "recall": 0.8148893117904663,
        "f1-score": 0.7161803841590881,
        "specificity": 0.9853533506393433
    },
    "Bleeding": {
        "precision": 0.7452380657196045,
        "recall": 0.8718662858009338,
        "f1-score": 0.8035943508148193,
        "specificity": 0.9932162761688232
    },
    "Erosion": {
        "precision": 0.608174741268158,
        "recall": 0.7471861243247986,
        "f1-score": 0.6705516576766968,
        "specificity": 0.9628764390945435
    },
    "Erythema": {
        "precision": 0.5124653577804565,
        "recall": 0.6228955984115601,
        "f1-score": 0.5623100399971008,
        "specificity": 0.9888854026794434
    },
    "Foreign Body": {
        "precision": 0.7159624695777893,
        "recall": 0.8970588445663452,
        "f1-score": 0.7963446378707886,
        "specificity": 0.9923378825187683
    },
    "Lymphangiectasia": {
        "precision": 0.710073709487915,
        "recall": 0.8425655961036682,
        "f1-score": 0.7706666588783264,
        "specificity": 0.9925264716148376
    },
    "Normal": {
        "precision": 0.9918277859687805,
        "recall": 0.9186131954193115,
        "f1-score": 0.9538175463676453,
        "specificity": 0.9758127331733704
    },
    "Polyp": {
        "precision": 0.5232067704200745,
        "recall": 0.7440000176429749,
        "f1-score": 0.6143683195114136,
        "specificity": 0.9783137440681458
    },
    "Ulcer": {
        "precision": 0.9395973086357117,
        "recall": 0.9790209531784058,
        "f1-score": 0.9589040875434875,
        "specificity": 0.9988640546798706
    },
    "Worms": {
        "precision": 0.8947368264198303,
        "recall": 1.0,
        "f1-score": 0.9444444179534912,
        "specificity": 0.9995020031929016
    },
    "accuracy": 0.8905901312828064,
    "macro avg": {
        "precision": 0.7280083894729614,
        "recall": 0.8438096046447754,
        "f1-score": 0.7791182398796082,
        "specificity": 0.9867688417434692
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9730620980262756,
        "Bleeding": 0.9912068843841553,
        "Erosion": 0.9564213156700134,
        "Erythema": 0.9702895283699036,
        "Foreign Body": 0.9872620105743408,
        "Lymphangiectasia": 0.9824020266532898,
        "Normal": 0.9904047250747681,
        "Polyp": 0.9784761667251587,
        "Ulcer": 0.9998642206192017,
        "Worms": 0.9999917149543762
    },
    "average_precision_scores": {
        "Angioectasia": 0.8276746273040771,
        "Bleeding": 0.8921636939048767,
        "Erosion": 0.7481677532196045,
        "Erythema": 0.606253981590271,
        "Foreign Body": 0.9101695418357849,
        "Lymphangiectasia": 0.8775101900100708,
        "Normal": 0.9970383644104004,
        "Polyp": 0.6945854425430298,
        "Ulcer": 0.9936261177062988,
        "Worms": 0.99810791015625
    },
    "mean_auc": 0.9829381108283997,
    "mean_average_precision": 0.8545297980308533
}
2024-10-14 18:04:02,939 - ResNet18 - INFO - Epoch: 14 | train_loss: 0.0653 | train_acc: 0.9474 | test_loss: 0.1888 | test_acc: 0.8906
2024-10-14 18:04:02,941 - ResNet18 - INFO - No improvement for 1 consecutive epochs.
2024-10-14 18:07:56,067 - ResNet18 - INFO - Epoch: 15
2024-10-14 18:07:56,069 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9468367695808411,
        "recall": 0.9445770382881165,
        "f1-score": 0.9457055330276489,
        "specificity": 0.9940891265869141
    },
    "Bleeding": {
        "precision": 0.9583775401115417,
        "recall": 0.9619478583335876,
        "f1-score": 0.9601593613624573,
        "specificity": 0.9953617453575134
    },
    "Erosion": {
        "precision": 0.8686171770095825,
        "recall": 0.8671810626983643,
        "f1-score": 0.8678985238075256,
        "specificity": 0.9859909415245056
    },
    "Erythema": {
        "precision": 0.9261898994445801,
        "recall": 0.9393391609191895,
        "f1-score": 0.9327181577682495,
        "specificity": 0.9914031028747559
    },
    "Foreign Body": {
        "precision": 0.9648529291152954,
        "recall": 0.968129575252533,
        "f1-score": 0.9664884805679321,
        "specificity": 0.9960034489631653
    },
    "Lymphangiectasia": {
        "precision": 0.9712133407592773,
        "recall": 0.968607485294342,
        "f1-score": 0.9699086546897888,
        "specificity": 0.9968417882919312
    },
    "Normal": {
        "precision": 0.9522660374641418,
        "recall": 0.9249804615974426,
        "f1-score": 0.9384249448776245,
        "specificity": 0.9947287440299988
    },
    "Polyp": {
        "precision": 0.9293010830879211,
        "recall": 0.9422186017036438,
        "f1-score": 0.9357152581214905,
        "specificity": 0.9922505617141724
    },
    "Ulcer": {
        "precision": 0.9960317611694336,
        "recall": 0.9952418804168701,
        "f1-score": 0.9956366419792175,
        "specificity": 0.9995565414428711
    },
    "Worms": {
        "precision": 0.9959828853607178,
        "recall": 0.9973183274269104,
        "f1-score": 0.9966501593589783,
        "specificity": 0.9995572566986084
    },
    "accuracy": 0.9511793255805969,
    "macro avg": {
        "precision": 0.9509669542312622,
        "recall": 0.9509541392326355,
        "f1-score": 0.9509305953979492,
        "specificity": 0.9945783615112305
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9985736608505249,
        "Bleeding": 0.9992231130599976,
        "Erosion": 0.9914960861206055,
        "Erythema": 0.9977672100067139,
        "Foreign Body": 0.9995533227920532,
        "Lymphangiectasia": 0.999427080154419,
        "Normal": 0.9963301420211792,
        "Polyp": 0.9980446100234985,
        "Ulcer": 0.9999825954437256,
        "Worms": 0.9999974370002747
    },
    "average_precision_scores": {
        "Angioectasia": 0.989606499671936,
        "Bleeding": 0.993314266204834,
        "Erosion": 0.9443585872650146,
        "Erythema": 0.9811212420463562,
        "Foreign Body": 0.9961562752723694,
        "Lymphangiectasia": 0.9959866404533386,
        "Normal": 0.9813140630722046,
        "Polyp": 0.9842269420623779,
        "Ulcer": 0.9998550415039062,
        "Worms": 0.9999767541885376
    },
    "mean_auc": 0.9980396628379822,
    "mean_average_precision": 0.9865917563438416
}
2024-10-14 18:07:56,072 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6871704459190369,
        "recall": 0.786720335483551,
        "f1-score": 0.7335835099220276,
        "specificity": 0.9886152744293213
    },
    "Bleeding": {
        "precision": 0.8048128485679626,
        "recall": 0.8384401202201843,
        "f1-score": 0.8212823867797852,
        "specificity": 0.9953718185424805
    },
    "Erosion": {
        "precision": 0.6543887257575989,
        "recall": 0.7229437232017517,
        "f1-score": 0.6869601011276245,
        "specificity": 0.9705548286437988
    },
    "Erythema": {
        "precision": 0.481675386428833,
        "recall": 0.619528591632843,
        "f1-score": 0.5419734716415405,
        "specificity": 0.9874960780143738
    },
    "Foreign Body": {
        "precision": 0.7984085083007812,
        "recall": 0.8852941393852234,
        "f1-score": 0.8396095037460327,
        "specificity": 0.9951874613761902
    },
    "Lymphangiectasia": {
        "precision": 0.6796338558197021,
        "recall": 0.8658891916275024,
        "f1-score": 0.7615384459495544,
        "specificity": 0.9911330938339233
    },
    "Normal": {
        "precision": 0.98325115442276,
        "recall": 0.9412387013435364,
        "f1-score": 0.9617863297462463,
        "specificity": 0.9487646222114563
    },
    "Polyp": {
        "precision": 0.5959596037864685,
        "recall": 0.7080000042915344,
        "f1-score": 0.64716637134552,
        "specificity": 0.9846468567848206
    },
    "Ulcer": {
        "precision": 0.9652777910232544,
        "recall": 0.9720279574394226,
        "f1-score": 0.9686411023139954,
        "specificity": 0.9993689060211182
    },
    "Worms": {
        "precision": 0.931506872177124,
        "recall": 1.0,
        "f1-score": 0.9645389914512634,
        "specificity": 0.9996887445449829
    },
    "accuracy": 0.9034217596054077,
    "macro avg": {
        "precision": 0.7582084536552429,
        "recall": 0.8340083360671997,
        "f1-score": 0.7927080988883972,
        "specificity": 0.9860827326774597
    },
    "auc_roc_scores": {
        "Angioectasia": 0.975011944770813,
        "Bleeding": 0.9921661615371704,
        "Erosion": 0.9671491384506226,
        "Erythema": 0.9698834419250488,
        "Foreign Body": 0.9912447929382324,
        "Lymphangiectasia": 0.9839589595794678,
        "Normal": 0.9893504977226257,
        "Polyp": 0.9789531826972961,
        "Ulcer": 0.9997172355651855,
        "Worms": 0.9999945163726807
    },
    "average_precision_scores": {
        "Angioectasia": 0.8355687856674194,
        "Bleeding": 0.8973764181137085,
        "Erosion": 0.7736401557922363,
        "Erythema": 0.5706770420074463,
        "Foreign Body": 0.9163112044334412,
        "Lymphangiectasia": 0.8776613473892212,
        "Normal": 0.9966422319412231,
        "Polyp": 0.7380715608596802,
        "Ulcer": 0.9933449029922485,
        "Worms": 0.9986722469329834
    },
    "mean_auc": 0.984743058681488,
    "mean_average_precision": 0.8597966432571411
}
2024-10-14 18:07:56,074 - ResNet18 - INFO - Epoch: 15 | train_loss: 0.0606 | train_acc: 0.9512 | test_loss: 0.1657 | test_acc: 0.9034
2024-10-14 18:07:56,188 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9847 at epoch 15
2024-10-14 18:11:48,968 - ResNet18 - INFO - Epoch: 16
2024-10-14 18:11:48,969 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.958355724811554,
        "recall": 0.9524699449539185,
        "f1-score": 0.9554038047790527,
        "specificity": 0.9954226016998291
    },
    "Bleeding": {
        "precision": 0.9539682269096375,
        "recall": 0.9585326910018921,
        "f1-score": 0.9562450051307678,
        "specificity": 0.9948589205741882
    },
    "Erosion": {
        "precision": 0.8901278376579285,
        "recall": 0.8791297078132629,
        "f1-score": 0.8845946192741394,
        "specificity": 0.9880769848823547
    },
    "Erythema": {
        "precision": 0.9230971336364746,
        "recall": 0.9393696784973145,
        "f1-score": 0.9311622977256775,
        "specificity": 0.9913474917411804
    },
    "Foreign Body": {
        "precision": 0.9717369079589844,
        "recall": 0.970241129398346,
        "f1-score": 0.9709884524345398,
        "specificity": 0.9967367649078369
    },
    "Lymphangiectasia": {
        "precision": 0.9741170406341553,
        "recall": 0.9709755182266235,
        "f1-score": 0.9725437164306641,
        "specificity": 0.9971669912338257
    },
    "Normal": {
        "precision": 0.9564864635467529,
        "recall": 0.9414737820625305,
        "f1-score": 0.9489207863807678,
        "specificity": 0.9952434301376343
    },
    "Polyp": {
        "precision": 0.932084321975708,
        "recall": 0.9463672637939453,
        "f1-score": 0.9391714930534363,
        "specificity": 0.9922831058502197
    },
    "Ulcer": {
        "precision": 0.9952368140220642,
        "recall": 0.9960275292396545,
        "f1-score": 0.9956320524215698,
        "specificity": 0.9994679689407349
    },
    "Worms": {
        "precision": 0.998376190662384,
        "recall": 0.9986464381217957,
        "f1-score": 0.9985113143920898,
        "specificity": 0.9998230934143066
    },
    "accuracy": 0.9553806185722351,
    "macro avg": {
        "precision": 0.9553586840629578,
        "recall": 0.9553233981132507,
        "f1-score": 0.9553173184394836,
        "specificity": 0.9950427412986755
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9990373253822327,
        "Bleeding": 0.9992478489875793,
        "Erosion": 0.9930691719055176,
        "Erythema": 0.9979411363601685,
        "Foreign Body": 0.9996260404586792,
        "Lymphangiectasia": 0.9995684623718262,
        "Normal": 0.9968502521514893,
        "Polyp": 0.9982821345329285,
        "Ulcer": 0.9999839067459106,
        "Worms": 0.9999938011169434
    },
    "average_precision_scores": {
        "Angioectasia": 0.9920514822006226,
        "Bleeding": 0.993491530418396,
        "Erosion": 0.9541938304901123,
        "Erythema": 0.9808818101882935,
        "Foreign Body": 0.9969313740730286,
        "Lymphangiectasia": 0.9967046976089478,
        "Normal": 0.9839423298835754,
        "Polyp": 0.9864797592163086,
        "Ulcer": 0.9998555779457092,
        "Worms": 0.9999411106109619
    },
    "mean_auc": 0.9983600974082947,
    "mean_average_precision": 0.988447368144989
}
2024-10-14 18:11:48,974 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6913793087005615,
        "recall": 0.8068410754203796,
        "f1-score": 0.7446610927581787,
        "specificity": 0.9885513186454773
    },
    "Bleeding": {
        "precision": 0.755667507648468,
        "recall": 0.835654616355896,
        "f1-score": 0.7936508059501648,
        "specificity": 0.9938502311706543
    },
    "Erosion": {
        "precision": 0.6430205702781677,
        "recall": 0.7298701405525208,
        "f1-score": 0.683698296546936,
        "specificity": 0.9687520861625671
    },
    "Erythema": {
        "precision": 0.5112359523773193,
        "recall": 0.6127946376800537,
        "f1-score": 0.5574272871017456,
        "specificity": 0.9890117049217224
    },
    "Foreign Body": {
        "precision": 0.8031914830207825,
        "recall": 0.8882352709770203,
        "f1-score": 0.8435754179954529,
        "specificity": 0.9953140616416931
    },
    "Lymphangiectasia": {
        "precision": 0.7212713956832886,
        "recall": 0.8600583076477051,
        "f1-score": 0.7845744490623474,
        "specificity": 0.9927797913551331
    },
    "Normal": {
        "precision": 0.9879724979400635,
        "recall": 0.9359485507011414,
        "f1-score": 0.9612571597099304,
        "specificity": 0.963589072227478
    },
    "Polyp": {
        "precision": 0.5359195470809937,
        "recall": 0.7459999918937683,
        "f1-score": 0.6237457990646362,
        "specificity": 0.9793372750282288
    },
    "Ulcer": {
        "precision": 0.9387755393981934,
        "recall": 0.9650349617004395,
        "f1-score": 0.951724112033844,
        "specificity": 0.9988640546798706
    },
    "Worms": {
        "precision": 0.9178082346916199,
        "recall": 0.9852941036224365,
        "f1-score": 0.9503546357154846,
        "specificity": 0.9996265172958374
    },
    "accuracy": 0.9012521505355835,
    "macro avg": {
        "precision": 0.7506242394447327,
        "recall": 0.8365732431411743,
        "f1-score": 0.789466917514801,
        "specificity": 0.9869676828384399
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9789271354675293,
        "Bleeding": 0.9935406446456909,
        "Erosion": 0.9592680931091309,
        "Erythema": 0.9749240875244141,
        "Foreign Body": 0.9865920543670654,
        "Lymphangiectasia": 0.9867302775382996,
        "Normal": 0.9901189804077148,
        "Polyp": 0.9778188467025757,
        "Ulcer": 0.9996544122695923,
        "Worms": 0.9999560117721558
    },
    "average_precision_scores": {
        "Angioectasia": 0.843975305557251,
        "Bleeding": 0.8855117559432983,
        "Erosion": 0.7648692727088928,
        "Erythema": 0.5935384631156921,
        "Foreign Body": 0.9108270406723022,
        "Lymphangiectasia": 0.8886885643005371,
        "Normal": 0.9969228506088257,
        "Polyp": 0.7228687405586243,
        "Ulcer": 0.9908575415611267,
        "Worms": 0.9906877875328064
    },
    "mean_auc": 0.9847530722618103,
    "mean_average_precision": 0.8588747382164001
}
2024-10-14 18:11:48,978 - ResNet18 - INFO - Epoch: 16 | train_loss: 0.0539 | train_acc: 0.9554 | test_loss: 0.1753 | test_acc: 0.9013
2024-10-14 18:11:48,979 - ResNet18 - INFO - No improvement for 1 consecutive epochs.
2024-10-14 18:15:41,472 - ResNet18 - INFO - Epoch: 17
2024-10-14 18:15:41,475 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.951381504535675,
        "recall": 0.9516343474388123,
        "f1-score": 0.9515079259872437,
        "specificity": 0.9945928454399109
    },
    "Bleeding": {
        "precision": 0.9577352404594421,
        "recall": 0.9688088297843933,
        "f1-score": 0.9632402062416077,
        "specificity": 0.9953081011772156
    },
    "Erosion": {
        "precision": 0.8912402987480164,
        "recall": 0.8782998919487,
        "f1-score": 0.8847227692604065,
        "specificity": 0.987994909286499
    },
    "Erythema": {
        "precision": 0.9172971844673157,
        "recall": 0.9356040358543396,
        "f1-score": 0.9263601899147034,
        "specificity": 0.9906348586082458
    },
    "Foreign Body": {
        "precision": 0.96942538022995,
        "recall": 0.9743046164512634,
        "f1-score": 0.9718589186668396,
        "specificity": 0.9965713024139404
    },
    "Lymphangiectasia": {
        "precision": 0.976719856262207,
        "recall": 0.9736636281013489,
        "f1-score": 0.9751893281936646,
        "specificity": 0.9973646998405457
    },
    "Normal": {
        "precision": 0.9616346955299377,
        "recall": 0.9346122741699219,
        "f1-score": 0.9479309320449829,
        "specificity": 0.9959298968315125
    },
    "Polyp": {
        "precision": 0.9366047978401184,
        "recall": 0.9441176652908325,
        "f1-score": 0.9403461813926697,
        "specificity": 0.9929429888725281
    },
    "Ulcer": {
        "precision": 0.9951547980308533,
        "recall": 0.9962274432182312,
        "f1-score": 0.9956908226013184,
        "specificity": 0.999468982219696
    },
    "Worms": {
        "precision": 0.9986897110939026,
        "recall": 0.9984281063079834,
        "f1-score": 0.9985588788986206,
        "specificity": 0.9998520016670227
    },
    "accuracy": 0.9555933475494385,
    "macro avg": {
        "precision": 0.9555883407592773,
        "recall": 0.9555700421333313,
        "f1-score": 0.955540657043457,
        "specificity": 0.9950661063194275
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9986739158630371,
        "Bleeding": 0.9994285106658936,
        "Erosion": 0.9928939342498779,
        "Erythema": 0.9978296756744385,
        "Foreign Body": 0.9995291233062744,
        "Lymphangiectasia": 0.9994823932647705,
        "Normal": 0.9967188835144043,
        "Polyp": 0.998418390750885,
        "Ulcer": 0.9999805688858032,
        "Worms": 0.999998927116394
    },
    "average_precision_scores": {
        "Angioectasia": 0.9905989170074463,
        "Bleeding": 0.9945884346961975,
        "Erosion": 0.9538202285766602,
        "Erythema": 0.9806426763534546,
        "Foreign Body": 0.9965629577636719,
        "Lymphangiectasia": 0.9962143898010254,
        "Normal": 0.9831060767173767,
        "Polyp": 0.9862877130508423,
        "Ulcer": 0.9998324513435364,
        "Worms": 0.9999901056289673
    },
    "mean_auc": 0.9982954263687134,
    "mean_average_precision": 0.9881643652915955
}
2024-10-14 18:15:41,477 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6683250665664673,
        "recall": 0.8108651638031006,
        "f1-score": 0.7327272891998291,
        "specificity": 0.9872081875801086
    },
    "Bleeding": {
        "precision": 0.8157181739807129,
        "recall": 0.8384401202201843,
        "f1-score": 0.8269230723381042,
        "specificity": 0.9956888556480408
    },
    "Erosion": {
        "precision": 0.6541698575019836,
        "recall": 0.7402597665786743,
        "f1-score": 0.694557249546051,
        "specificity": 0.9698203802108765
    },
    "Erythema": {
        "precision": 0.5071225166320801,
        "recall": 0.5993266105651855,
        "f1-score": 0.5493826866149902,
        "specificity": 0.9890748262405396
    },
    "Foreign Body": {
        "precision": 0.7989130616188049,
        "recall": 0.8647058606147766,
        "f1-score": 0.8305084705352783,
        "specificity": 0.9953140616416931
    },
    "Lymphangiectasia": {
        "precision": 0.7552083134651184,
        "recall": 0.8454810380935669,
        "f1-score": 0.7977991700172424,
        "specificity": 0.9940465092658997
    },
    "Normal": {
        "precision": 0.9842606782913208,
        "recall": 0.9415642619132996,
        "f1-score": 0.9624391794204712,
        "specificity": 0.9518855810165405
    },
    "Polyp": {
        "precision": 0.5871999859809875,
        "recall": 0.734000027179718,
        "f1-score": 0.6524444222450256,
        "specificity": 0.9834954142570496
    },
    "Ulcer": {
        "precision": 0.936241626739502,
        "recall": 0.9755244851112366,
        "f1-score": 0.9554794430732727,
        "specificity": 0.9988009333610535
    },
    "Worms": {
        "precision": 0.9041095972061157,
        "recall": 0.970588207244873,
        "f1-score": 0.936170220375061,
        "specificity": 0.9995642304420471
    },
    "accuracy": 0.9051574468612671,
    "macro avg": {
        "precision": 0.7611269354820251,
        "recall": 0.8320755362510681,
        "f1-score": 0.793843150138855,
        "specificity": 0.9864898920059204
    },
    "auc_roc_scores": {
        "Angioectasia": 0.977001428604126,
        "Bleeding": 0.9930963516235352,
        "Erosion": 0.9651526212692261,
        "Erythema": 0.9720005989074707,
        "Foreign Body": 0.9858498573303223,
        "Lymphangiectasia": 0.9843116998672485,
        "Normal": 0.9899472594261169,
        "Polyp": 0.9783289432525635,
        "Ulcer": 0.9990213513374329,
        "Worms": 0.9999276399612427
    },
    "average_precision_scores": {
        "Angioectasia": 0.831183671951294,
        "Bleeding": 0.8938502073287964,
        "Erosion": 0.7804296016693115,
        "Erythema": 0.5840052366256714,
        "Foreign Body": 0.9066950082778931,
        "Lymphangiectasia": 0.8890045285224915,
        "Normal": 0.9968982338905334,
        "Polyp": 0.7287060618400574,
        "Ulcer": 0.9839815497398376,
        "Worms": 0.9850970506668091
    },
    "mean_auc": 0.9844638109207153,
    "mean_average_precision": 0.8579851388931274
}
2024-10-14 18:15:41,479 - ResNet18 - INFO - Epoch: 17 | train_loss: 0.0542 | train_acc: 0.9556 | test_loss: 0.1694 | test_acc: 0.9052
2024-10-14 18:15:41,480 - ResNet18 - INFO - No improvement for 2 consecutive epochs.
2024-10-14 18:19:35,770 - ResNet18 - INFO - Epoch: 18
2024-10-14 18:19:35,772 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9488621354103088,
        "recall": 0.9542272686958313,
        "f1-score": 0.9515371322631836,
        "specificity": 0.9943646192550659
    },
    "Bleeding": {
        "precision": 0.9602649211883545,
        "recall": 0.9684745073318481,
        "f1-score": 0.9643522500991821,
        "specificity": 0.9955705404281616
    },
    "Erosion": {
        "precision": 0.891105592250824,
        "recall": 0.8758170008659363,
        "f1-score": 0.8833951354026794,
        "specificity": 0.9884190559387207
    },
    "Erythema": {
        "precision": 0.928027331829071,
        "recall": 0.9418821930885315,
        "f1-score": 0.9349034428596497,
        "specificity": 0.9919068813323975
    },
    "Foreign Body": {
        "precision": 0.9725918173789978,
        "recall": 0.9692389369010925,
        "f1-score": 0.9709124565124512,
        "specificity": 0.996955931186676
    },
    "Lymphangiectasia": {
        "precision": 0.9745739698410034,
        "recall": 0.972994863986969,
        "f1-score": 0.9737837910652161,
        "specificity": 0.9972274899482727
    },
    "Normal": {
        "precision": 0.9598371982574463,
        "recall": 0.9442071318626404,
        "f1-score": 0.9519580006599426,
        "specificity": 0.9956291913986206
    },
    "Polyp": {
        "precision": 0.9401950836181641,
        "recall": 0.9492096304893494,
        "f1-score": 0.9446808695793152,
        "specificity": 0.993095874786377
    },
    "Ulcer": {
        "precision": 0.9965444207191467,
        "recall": 0.9957503080368042,
        "f1-score": 0.9961472153663635,
        "specificity": 0.9996158480644226
    },
    "Worms": {
        "precision": 0.9981972575187683,
        "recall": 0.9981972575187683,
        "f1-score": 0.9981972575187683,
        "specificity": 0.9997924566268921
    },
    "accuracy": 0.9572951793670654,
    "macro avg": {
        "precision": 0.9570199847221375,
        "recall": 0.9569998979568481,
        "f1-score": 0.9569867253303528,
        "specificity": 0.9952577948570251
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9988980293273926,
        "Bleeding": 0.999424934387207,
        "Erosion": 0.9931875467300415,
        "Erythema": 0.9984176158905029,
        "Foreign Body": 0.9995657205581665,
        "Lymphangiectasia": 0.9995759725570679,
        "Normal": 0.9967947006225586,
        "Polyp": 0.9985228776931763,
        "Ulcer": 0.9999893307685852,
        "Worms": 0.9999986290931702
    },
    "average_precision_scores": {
        "Angioectasia": 0.992002010345459,
        "Bleeding": 0.9946351647377014,
        "Erosion": 0.9549694657325745,
        "Erythema": 0.9855359792709351,
        "Foreign Body": 0.996661365032196,
        "Lymphangiectasia": 0.9966286420822144,
        "Normal": 0.984908938407898,
        "Polyp": 0.9880267977714539,
        "Ulcer": 0.9999045133590698,
        "Worms": 0.999988317489624
    },
    "mean_auc": 0.9984375238418579,
    "mean_average_precision": 0.9893261194229126
}
2024-10-14 18:19:35,776 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7409523725509644,
        "recall": 0.7826961874961853,
        "f1-score": 0.7612524628639221,
        "specificity": 0.9913015961647034
    },
    "Bleeding": {
        "precision": 0.7550504803657532,
        "recall": 0.8328690528869629,
        "f1-score": 0.7920529842376709,
        "specificity": 0.9938502311706543
    },
    "Erosion": {
        "precision": 0.6223328709602356,
        "recall": 0.7575757503509521,
        "f1-score": 0.6833268404006958,
        "specificity": 0.9645456075668335
    },
    "Erythema": {
        "precision": 0.5364431738853455,
        "recall": 0.619528591632843,
        "f1-score": 0.574999988079071,
        "specificity": 0.9899589419364929
    },
    "Foreign Body": {
        "precision": 0.8128342032432556,
        "recall": 0.8941176533699036,
        "f1-score": 0.8515406250953674,
        "specificity": 0.9955673813819885
    },
    "Lymphangiectasia": {
        "precision": 0.7538461685180664,
        "recall": 0.8571428656578064,
        "f1-score": 0.8021827936172485,
        "specificity": 0.9939197897911072
    },
    "Normal": {
        "precision": 0.9870229363441467,
        "recall": 0.9409131407737732,
        "f1-score": 0.9634166955947876,
        "specificity": 0.9604681134223938
    },
    "Polyp": {
        "precision": 0.5826645493507385,
        "recall": 0.7260000109672546,
        "f1-score": 0.6464826464653015,
        "specificity": 0.9833674430847168
    },
    "Ulcer": {
        "precision": 0.9586206674575806,
        "recall": 0.9720279574394226,
        "f1-score": 0.9652777910232544,
        "specificity": 0.9992427229881287
    },
    "Worms": {
        "precision": 0.9444444179534912,
        "recall": 1.0,
        "f1-score": 0.9714285731315613,
        "specificity": 0.9997509717941284
    },
    "accuracy": 0.9059633016586304,
    "macro avg": {
        "precision": 0.7694212198257446,
        "recall": 0.8382871747016907,
        "f1-score": 0.8011960983276367,
        "specificity": 0.9871973395347595
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9760216474533081,
        "Bleeding": 0.9910546541213989,
        "Erosion": 0.9629199504852295,
        "Erythema": 0.9771004915237427,
        "Foreign Body": 0.9889724850654602,
        "Lymphangiectasia": 0.9837498068809509,
        "Normal": 0.9909098148345947,
        "Polyp": 0.9788605570793152,
        "Ulcer": 0.9996283650398254,
        "Worms": 0.9999762177467346
    },
    "average_precision_scores": {
        "Angioectasia": 0.8361403942108154,
        "Bleeding": 0.8894079923629761,
        "Erosion": 0.7754966020584106,
        "Erythema": 0.6161333918571472,
        "Foreign Body": 0.9237467050552368,
        "Lymphangiectasia": 0.883831262588501,
        "Normal": 0.9972020983695984,
        "Polyp": 0.7330113053321838,
        "Ulcer": 0.9894312620162964,
        "Worms": 0.9940186738967896
    },
    "mean_auc": 0.9849194884300232,
    "mean_average_precision": 0.8638419508934021
}
2024-10-14 18:19:35,777 - ResNet18 - INFO - Epoch: 18 | train_loss: 0.0519 | train_acc: 0.9573 | test_loss: 0.1686 | test_acc: 0.9060
2024-10-14 18:19:35,888 - ResNet18 - INFO - Best model saved with mean AUC score: 0.9849 at epoch 18
2024-10-14 18:23:28,706 - ResNet18 - INFO - Epoch: 19
2024-10-14 18:23:28,709 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9553453922271729,
        "recall": 0.9454119801521301,
        "f1-score": 0.9503527283668518,
        "specificity": 0.9949644804000854
    },
    "Bleeding": {
        "precision": 0.9571201801300049,
        "recall": 0.9647812247276306,
        "f1-score": 0.9609354138374329,
        "specificity": 0.9952154755592346
    },
    "Erosion": {
        "precision": 0.9008667469024658,
        "recall": 0.890256941318512,
        "f1-score": 0.8955304026603699,
        "specificity": 0.9891942739486694
    },
    "Erythema": {
        "precision": 0.9273815751075745,
        "recall": 0.946096658706665,
        "f1-score": 0.9366456270217896,
        "specificity": 0.9917555451393127
    },
    "Foreign Body": {
        "precision": 0.9707291126251221,
        "recall": 0.9746192693710327,
        "f1-score": 0.972670316696167,
        "specificity": 0.9967517256736755
    },
    "Lymphangiectasia": {
        "precision": 0.9749289155006409,
        "recall": 0.9729171991348267,
        "f1-score": 0.9739220142364502,
        "specificity": 0.997124195098877
    },
    "Normal": {
        "precision": 0.966611921787262,
        "recall": 0.9428724050521851,
        "f1-score": 0.954594612121582,
        "specificity": 0.9963970184326172
    },
    "Polyp": {
        "precision": 0.9372559189796448,
        "recall": 0.9541478753089905,
        "f1-score": 0.9456264972686768,
        "specificity": 0.9928770065307617
    },
    "Ulcer": {
        "precision": 0.9964597225189209,
        "recall": 0.9956462383270264,
        "f1-score": 0.9960528016090393,
        "specificity": 0.9996168613433838
    },
    "Worms": {
        "precision": 0.9986464381217957,
        "recall": 0.998106062412262,
        "f1-score": 0.998376190662384,
        "specificity": 0.9998525381088257
    },
    "accuracy": 0.9583854079246521,
    "macro avg": {
        "precision": 0.9585346579551697,
        "recall": 0.9584856033325195,
        "f1-score": 0.9584706425666809,
        "specificity": 0.995374858379364
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9988216161727905,
        "Bleeding": 0.9994112849235535,
        "Erosion": 0.9943124651908875,
        "Erythema": 0.9983991384506226,
        "Foreign Body": 0.999622106552124,
        "Lymphangiectasia": 0.9996351003646851,
        "Normal": 0.9961462616920471,
        "Polyp": 0.9987664818763733,
        "Ulcer": 0.999992311000824,
        "Worms": 0.9999980926513672
    },
    "average_precision_scores": {
        "Angioectasia": 0.9915856122970581,
        "Bleeding": 0.994899332523346,
        "Erosion": 0.9615281820297241,
        "Erythema": 0.9857098460197449,
        "Foreign Body": 0.996947705745697,
        "Lymphangiectasia": 0.9971208572387695,
        "Normal": 0.9833759069442749,
        "Polyp": 0.9897903203964233,
        "Ulcer": 0.9999305009841919,
        "Worms": 0.9999828934669495
    },
    "mean_auc": 0.998510479927063,
    "mean_average_precision": 0.9900871515274048
}
2024-10-14 18:23:28,712 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7073608636856079,
        "recall": 0.7927565574645996,
        "f1-score": 0.7476280927658081,
        "specificity": 0.989574670791626
    },
    "Bleeding": {
        "precision": 0.7973684072494507,
        "recall": 0.844011127948761,
        "f1-score": 0.8200270533561707,
        "specificity": 0.995118260383606
    },
    "Erosion": {
        "precision": 0.6111498475074768,
        "recall": 0.7593073844909668,
        "f1-score": 0.6772201061248779,
        "specificity": 0.9627428650856018
    },
    "Erythema": {
        "precision": 0.5227272510528564,
        "recall": 0.619528591632843,
        "f1-score": 0.5670261979103088,
        "specificity": 0.9893906116485596
    },
    "Foreign Body": {
        "precision": 0.7444717288017273,
        "recall": 0.8911764621734619,
        "f1-score": 0.8112449645996094,
        "specificity": 0.9934144020080566
    },
    "Lymphangiectasia": {
        "precision": 0.7594936490058899,
        "recall": 0.8746355772018433,
        "f1-score": 0.8130081295967102,
        "specificity": 0.9939831495285034
    },
    "Normal": {
        "precision": 0.989859938621521,
        "recall": 0.9374949336051941,
        "f1-score": 0.9629660844802856,
        "specificity": 0.9693108201026917
    },
    "Polyp": {
        "precision": 0.6162790656089783,
        "recall": 0.7419999837875366,
        "f1-score": 0.6733212471008301,
        "specificity": 0.9852226376533508
    },
    "Ulcer": {
        "precision": 0.9457626938819885,
        "recall": 0.9755244851112366,
        "f1-score": 0.9604130983352661,
        "specificity": 0.9989902973175049
    },
    "Worms": {
        "precision": 0.9444444179534912,
        "recall": 1.0,
        "f1-score": 0.9714285731315613,
        "specificity": 0.9997509717941284
    },
    "accuracy": 0.9049094915390015,
    "macro avg": {
        "precision": 0.7638918161392212,
        "recall": 0.8436434864997864,
        "f1-score": 0.8004283905029297,
        "specificity": 0.9877498745918274
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9785516858100891,
        "Bleeding": 0.9886398315429688,
        "Erosion": 0.9633939266204834,
        "Erythema": 0.9741955995559692,
        "Foreign Body": 0.9859117269515991,
        "Lymphangiectasia": 0.9868115186691284,
        "Normal": 0.9912823438644409,
        "Polyp": 0.9798747897148132,
        "Ulcer": 0.9994953870773315,
        "Worms": 0.9999834895133972
    },
    "average_precision_scores": {
        "Angioectasia": 0.8411635160446167,
        "Bleeding": 0.890568733215332,
        "Erosion": 0.7711098194122314,
        "Erythema": 0.6229615211486816,
        "Foreign Body": 0.913459062576294,
        "Lymphangiectasia": 0.8928709030151367,
        "Normal": 0.9972749352455139,
        "Polyp": 0.7439055442810059,
        "Ulcer": 0.9869879484176636,
        "Worms": 0.9957946538925171
    },
    "mean_auc": 0.9848141074180603,
    "mean_average_precision": 0.8656096458435059
}
2024-10-14 18:23:28,713 - ResNet18 - INFO - Epoch: 19 | train_loss: 0.0508 | train_acc: 0.9584 | test_loss: 0.1680 | test_acc: 0.9049
2024-10-14 18:23:28,714 - ResNet18 - INFO - No improvement for 1 consecutive epochs.
2024-10-14 18:27:21,752 - ResNet18 - INFO - Epoch: 20
2024-10-14 18:27:21,755 - ResNet18 - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9587096571922302,
        "recall": 0.9604446887969971,
        "f1-score": 0.9595763683319092,
        "specificity": 0.9952577352523804
    },
    "Bleeding": {
        "precision": 0.9627262949943542,
        "recall": 0.9673622250556946,
        "f1-score": 0.9650387167930603,
        "specificity": 0.9958664178848267
    },
    "Erosion": {
        "precision": 0.9088683128356934,
        "recall": 0.8949906229972839,
        "f1-score": 0.9018760919570923,
        "specificity": 0.9901103973388672
    },
    "Erythema": {
        "precision": 0.9309442639350891,
        "recall": 0.9450345039367676,
        "f1-score": 0.9379364848136902,
        "specificity": 0.9921988248825073
    },
    "Foreign Body": {
        "precision": 0.9691441059112549,
        "recall": 0.9709677696228027,
        "f1-score": 0.9700550436973572,
        "specificity": 0.9966063499450684
    },
    "Lymphangiectasia": {
        "precision": 0.9735047221183777,
        "recall": 0.9717203378677368,
        "f1-score": 0.9726117253303528,
        "specificity": 0.9970107674598694
    },
    "Normal": {
        "precision": 0.95721036195755,
        "recall": 0.9381808042526245,
        "f1-score": 0.9476000666618347,
        "specificity": 0.9954619407653809
    },
    "Polyp": {
        "precision": 0.9395604133605957,
        "recall": 0.9502514004707336,
        "f1-score": 0.9448756575584412,
        "specificity": 0.9931713342666626
    },
    "Ulcer": {
        "precision": 0.9965599179267883,
        "recall": 0.9973517060279846,
        "f1-score": 0.9969556331634521,
        "specificity": 0.9996157288551331
    },
    "Worms": {
        "precision": 0.9983948469161987,
        "recall": 0.9989293217658997,
        "f1-score": 0.9986620545387268,
        "specificity": 0.9998228549957275
    },
    "accuracy": 0.9596085548400879,
    "macro avg": {
        "precision": 0.9595623016357422,
        "recall": 0.9595233798027039,
        "f1-score": 0.9595188498497009,
        "specificity": 0.9955121874809265
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9990471601486206,
        "Bleeding": 0.9994559288024902,
        "Erosion": 0.994858980178833,
        "Erythema": 0.9984538555145264,
        "Foreign Body": 0.9995179176330566,
        "Lymphangiectasia": 0.9995854496955872,
        "Normal": 0.9973369240760803,
        "Polyp": 0.9986051321029663,
        "Ulcer": 0.9999936819076538,
        "Worms": 0.9999985098838806
    },
    "average_precision_scores": {
        "Angioectasia": 0.9928470849990845,
        "Bleeding": 0.9952013492584229,
        "Erosion": 0.9655759334564209,
        "Erythema": 0.9860312938690186,
        "Foreign Body": 0.9963788986206055,
        "Lymphangiectasia": 0.9969991445541382,
        "Normal": 0.9854493141174316,
        "Polyp": 0.9880917072296143,
        "Ulcer": 0.9999434947967529,
        "Worms": 0.9999867677688599
    },
    "mean_auc": 0.998685359954834,
    "mean_average_precision": 0.990650475025177
}
2024-10-14 18:27:21,758 - ResNet18 - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.739051103591919,
        "recall": 0.8148893117904663,
        "f1-score": 0.7751196026802063,
        "specificity": 0.9908538460731506
    },
    "Bleeding": {
        "precision": 0.8070651888847351,
        "recall": 0.8272980451583862,
        "f1-score": 0.81705641746521,
        "specificity": 0.9954986572265625
    },
    "Erosion": {
        "precision": 0.6362308263778687,
        "recall": 0.7541125416755676,
        "f1-score": 0.6901743412017822,
        "specificity": 0.9667490124702454
    },
    "Erythema": {
        "precision": 0.4910486042499542,
        "recall": 0.6464646458625793,
        "f1-score": 0.5581395626068115,
        "specificity": 0.9874328970909119
    },
    "Foreign Body": {
        "precision": 0.8186812996864319,
        "recall": 0.8764705657958984,
        "f1-score": 0.8465909361839294,
        "specificity": 0.9958206415176392
    },
    "Lymphangiectasia": {
        "precision": 0.7584415674209595,
        "recall": 0.851311981678009,
        "f1-score": 0.8021978139877319,
        "specificity": 0.9941098093986511
    },
    "Normal": {
        "precision": 0.9868791103363037,
        "recall": 0.9427036643028259,
        "f1-score": 0.9642857313156128,
        "specificity": 0.9599480032920837
    },
    "Polyp": {
        "precision": 0.5929054021835327,
        "recall": 0.7020000219345093,
        "f1-score": 0.6428571343421936,
        "specificity": 0.9845829010009766
    },
    "Ulcer": {
        "precision": 0.9111841917037964,
        "recall": 0.9685314893722534,
        "f1-score": 0.9389830231666565,
        "specificity": 0.9982960820198059
    },
    "Worms": {
        "precision": 0.9189189076423645,
        "recall": 1.0,
        "f1-score": 0.9577465057373047,
        "specificity": 0.9996265172958374
    },
    "accuracy": 0.9071410894393921,
    "macro avg": {
        "precision": 0.7660406231880188,
        "recall": 0.8383781313896179,
        "f1-score": 0.7993150949478149,
        "specificity": 0.9872918128967285
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9769404530525208,
        "Bleeding": 0.9887274503707886,
        "Erosion": 0.9651964902877808,
        "Erythema": 0.9718434810638428,
        "Foreign Body": 0.9897348880767822,
        "Lymphangiectasia": 0.9875372052192688,
        "Normal": 0.9910563230514526,
        "Polyp": 0.9784976243972778,
        "Ulcer": 0.9996305704116821,
        "Worms": 0.9999770522117615
    },
    "average_precision_scores": {
        "Angioectasia": 0.8454799652099609,
        "Bleeding": 0.8868936896324158,
        "Erosion": 0.7744002342224121,
        "Erythema": 0.6109603643417358,
        "Foreign Body": 0.9221805930137634,
        "Lymphangiectasia": 0.8829383254051208,
        "Normal": 0.9972249269485474,
        "Polyp": 0.7291233539581299,
        "Ulcer": 0.986914873123169,
        "Worms": 0.9943822622299194
    },
    "mean_auc": 0.984914243221283,
    "mean_average_precision": 0.8630499243736267
}
2024-10-14 18:27:21,760 - ResNet18 - INFO - Epoch: 20 | train_loss: 0.0491 | train_acc: 0.9596 | test_loss: 0.1634 | test_acc: 0.9071
2024-10-14 18:27:21,761 - ResNet18 - INFO - No improvement for 2 consecutive epochs.
2024-10-14 18:27:21,763 - ResNet18 - INFO - Training completed for model: ResNet18. Best model at epoch 18 with mean AUC: 0.9849
