2024-10-15 03:29:49,268 - BEiT - INFO - Training started for model: BEiT
2024-10-15 03:43:37,489 - BEiT - INFO - Epoch: 1
2024-10-15 03:43:37,491 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.7461809515953064,
        "recall": 0.6703615784645081,
        "f1-score": 0.7062422037124634,
        "specificity": 0.97445148229599
    },
    "Bleeding": {
        "precision": 0.7802547812461853,
        "recall": 0.7873918414115906,
        "f1-score": 0.7838070392608643,
        "specificity": 0.9732733368873596
    },
    "Erosion": {
        "precision": 0.4707479774951935,
        "recall": 0.5066418647766113,
        "f1-score": 0.48803582787513733,
        "specificity": 0.9366486668586731
    },
    "Erythema": {
        "precision": 0.5825714468955994,
        "recall": 0.560935378074646,
        "f1-score": 0.5715487003326416,
        "specificity": 0.9569939970970154
    },
    "Foreign Body": {
        "precision": 0.8284843564033508,
        "recall": 0.8026845455169678,
        "f1-score": 0.8153803944587708,
        "specificity": 0.9817306995391846
    },
    "Lymphangiectasia": {
        "precision": 0.829937756061554,
        "recall": 0.80180424451828,
        "f1-score": 0.8156284689903259,
        "specificity": 0.9822970032691956
    },
    "Normal": {
        "precision": 0.7573052048683167,
        "recall": 0.7344529032707214,
        "f1-score": 0.7457039952278137,
        "specificity": 0.9734584093093872
    },
    "Polyp": {
        "precision": 0.5994956493377686,
        "recall": 0.6778123378753662,
        "f1-score": 0.6362530589103699,
        "specificity": 0.9482355117797852
    },
    "Ulcer": {
        "precision": 0.8984743356704712,
        "recall": 0.879923939704895,
        "f1-score": 0.8891023993492126,
        "specificity": 0.9892117977142334
    },
    "Worms": {
        "precision": 0.8977152109146118,
        "recall": 0.9280417561531067,
        "f1-score": 0.9126266241073608,
        "specificity": 0.9886651635169983
    },
    "accuracy": 0.7345972657203674,
    "macro avg": {
        "precision": 0.7391167879104614,
        "recall": 0.7350050806999207,
        "f1-score": 0.7364328503608704,
        "specificity": 0.9704965949058533
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9451783299446106,
        "Bleeding": 0.9721505641937256,
        "Erosion": 0.8832183480262756,
        "Erythema": 0.9271849393844604,
        "Foreign Body": 0.9781204462051392,
        "Lymphangiectasia": 0.9752131700515747,
        "Normal": 0.9553205966949463,
        "Polyp": 0.944265604019165,
        "Ulcer": 0.9898669123649597,
        "Worms": 0.9968144297599792
    },
    "average_precision_scores": {
        "Angioectasia": 0.793386697769165,
        "Bleeding": 0.8743882775306702,
        "Erosion": 0.5144401788711548,
        "Erythema": 0.639641523361206,
        "Foreign Body": 0.9014083743095398,
        "Lymphangiectasia": 0.8898922801017761,
        "Normal": 0.8146299123764038,
        "Polyp": 0.6990698575973511,
        "Ulcer": 0.9524644613265991,
        "Worms": 0.9776279330253601
    },
    "mean_auc": 0.9567333459854126,
    "mean_average_precision": 0.8056949973106384
}
2024-10-15 03:43:37,491 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6157804727554321,
        "recall": 0.7223340272903442,
        "f1-score": 0.664814829826355,
        "specificity": 0.985673189163208
    },
    "Bleeding": {
        "precision": 0.6359832882881165,
        "recall": 0.8467966318130493,
        "f1-score": 0.7264038324356079,
        "specificity": 0.9889684915542603
    },
    "Erosion": {
        "precision": 0.5732870697975159,
        "recall": 0.5722943544387817,
        "f1-score": 0.572790265083313,
        "specificity": 0.9671496152877808
    },
    "Erythema": {
        "precision": 0.20020325481891632,
        "recall": 0.6632996797561646,
        "f1-score": 0.30757221579551697,
        "specificity": 0.9502999782562256
    },
    "Foreign Body": {
        "precision": 0.2192474603652954,
        "recall": 0.8911764621734619,
        "f1-score": 0.3519163727760315,
        "specificity": 0.9316742420196533
    },
    "Lymphangiectasia": {
        "precision": 0.5866388082504272,
        "recall": 0.819242000579834,
        "f1-score": 0.683698296546936,
        "specificity": 0.9874595999717712
    },
    "Normal": {
        "precision": 0.9832448959350586,
        "recall": 0.7689427733421326,
        "f1-score": 0.8629886507987976,
        "specificity": 0.9581274390220642
    },
    "Polyp": {
        "precision": 0.36814892292022705,
        "recall": 0.7120000123977661,
        "f1-score": 0.4853442311286926,
        "specificity": 0.9609135389328003
    },
    "Ulcer": {
        "precision": 0.6367924809455872,
        "recall": 0.9440559148788452,
        "f1-score": 0.7605633735656738,
        "specificity": 0.9902814626693726
    },
    "Worms": {
        "precision": 0.8493150472640991,
        "recall": 0.9117646813392639,
        "f1-score": 0.8794326186180115,
        "specificity": 0.9993152618408203
    },
    "accuracy": 0.7588023543357849,
    "macro avg": {
        "precision": 0.5668641924858093,
        "recall": 0.7851907014846802,
        "f1-score": 0.6295524835586548,
        "specificity": 0.9719862937927246
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9608678817749023,
        "Bleeding": 0.9900438189506531,
        "Erosion": 0.9367136359214783,
        "Erythema": 0.9402387142181396,
        "Foreign Body": 0.9601259231567383,
        "Lymphangiectasia": 0.9788447618484497,
        "Normal": 0.9690725803375244,
        "Polyp": 0.9659639596939087,
        "Ulcer": 0.9963958263397217,
        "Worms": 0.9987925291061401
    },
    "average_precision_scores": {
        "Angioectasia": 0.7593223452568054,
        "Bleeding": 0.8750869631767273,
        "Erosion": 0.6221839189529419,
        "Erythema": 0.3256043493747711,
        "Foreign Body": 0.7576971054077148,
        "Lymphangiectasia": 0.7764045000076294,
        "Normal": 0.9898121356964111,
        "Polyp": 0.5736194849014282,
        "Ulcer": 0.9447734355926514,
        "Worms": 0.9464651942253113
    },
    "mean_auc": 0.9697059988975525,
    "mean_average_precision": 0.7570969462394714
}
2024-10-15 03:43:37,492 - BEiT - INFO - Epoch: 1 | train_loss: 0.4952 | train_acc: 0.7346 | test_loss: 0.3505 | test_acc: 0.7588
2024-10-15 03:43:37,950 - BEiT - INFO - Best model saved with mean AUC score: 0.9697 at epoch 1
2024-10-15 03:57:28,525 - BEiT - INFO - Epoch: 2
2024-10-15 03:57:28,527 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8540145754814148,
        "recall": 0.8169123530387878,
        "f1-score": 0.8350515365600586,
        "specificity": 0.983995258808136
    },
    "Bleeding": {
        "precision": 0.8815330862998962,
        "recall": 0.893507182598114,
        "f1-score": 0.8874797821044922,
        "specificity": 0.9869716167449951
    },
    "Erosion": {
        "precision": 0.6603624820709229,
        "recall": 0.6661367416381836,
        "f1-score": 0.6632370352745056,
        "specificity": 0.9617828726768494
    },
    "Erythema": {
        "precision": 0.753727376461029,
        "recall": 0.755537748336792,
        "f1-score": 0.7546314597129822,
        "specificity": 0.9726816415786743
    },
    "Foreign Body": {
        "precision": 0.9259157776832581,
        "recall": 0.9126920104026794,
        "f1-score": 0.919256329536438,
        "specificity": 0.992004930973053
    },
    "Lymphangiectasia": {
        "precision": 0.9158903360366821,
        "recall": 0.9098360538482666,
        "f1-score": 0.9128531813621521,
        "specificity": 0.9906578063964844
    },
    "Normal": {
        "precision": 0.8494946956634521,
        "recall": 0.83221834897995,
        "f1-score": 0.8407678008079529,
        "specificity": 0.9837319254875183
    },
    "Polyp": {
        "precision": 0.770351767539978,
        "recall": 0.8213233351707458,
        "f1-score": 0.7950214147567749,
        "specificity": 0.9730176329612732
    },
    "Ulcer": {
        "precision": 0.9722442626953125,
        "recall": 0.9666228890419006,
        "f1-score": 0.96942538022995,
        "specificity": 0.9968937039375305
    },
    "Worms": {
        "precision": 0.985165536403656,
        "recall": 0.9864721298217773,
        "f1-score": 0.9858184456825256,
        "specificity": 0.9983450174331665
    },
    "accuracy": 0.8560640215873718,
    "macro avg": {
        "precision": 0.8568699955940247,
        "recall": 0.8561258316040039,
        "f1-score": 0.8563542366027832,
        "specificity": 0.984008252620697
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9838881492614746,
        "Bleeding": 0.9936327934265137,
        "Erosion": 0.9491130709648132,
        "Erythema": 0.9757788181304932,
        "Foreign Body": 0.9957972168922424,
        "Lymphangiectasia": 0.9941686391830444,
        "Normal": 0.9820226430892944,
        "Polyp": 0.9819177985191345,
        "Ulcer": 0.999148964881897,
        "Worms": 0.9998475313186646
    },
    "average_precision_scores": {
        "Angioectasia": 0.9192060232162476,
        "Bleeding": 0.956369161605835,
        "Erosion": 0.7310426235198975,
        "Erythema": 0.8348734974861145,
        "Foreign Body": 0.9749487042427063,
        "Lymphangiectasia": 0.9674476981163025,
        "Normal": 0.914654552936554,
        "Polyp": 0.8735543489456177,
        "Ulcer": 0.9937925338745117,
        "Worms": 0.9987018704414368
    },
    "mean_auc": 0.9855315089225769,
    "mean_average_precision": 0.9164590835571289
}
2024-10-15 03:57:28,529 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6120300889015198,
        "recall": 0.818913459777832,
        "f1-score": 0.7005163431167603,
        "specificity": 0.9834985733032227
    },
    "Bleeding": {
        "precision": 0.7585301995277405,
        "recall": 0.8050139546394348,
        "f1-score": 0.7810810804367065,
        "specificity": 0.9941672682762146
    },
    "Erosion": {
        "precision": 0.4671814739704132,
        "recall": 0.7333333492279053,
        "f1-score": 0.5707547068595886,
        "specificity": 0.9355010986328125
    },
    "Erythema": {
        "precision": 0.3882863223552704,
        "recall": 0.6026936173439026,
        "f1-score": 0.47229552268981934,
        "specificity": 0.9821913242340088
    },
    "Foreign Body": {
        "precision": 0.7058823704719543,
        "recall": 0.8470588326454163,
        "f1-score": 0.7700534462928772,
        "specificity": 0.9924012422561646
    },
    "Lymphangiectasia": {
        "precision": 0.9116607904434204,
        "recall": 0.7521865963935852,
        "f1-score": 0.8242811560630798,
        "specificity": 0.9984166026115417
    },
    "Normal": {
        "precision": 0.9895651936531067,
        "recall": 0.8798730373382568,
        "f1-score": 0.9315009713172913,
        "specificity": 0.9703510999679565
    },
    "Polyp": {
        "precision": 0.4443053901195526,
        "recall": 0.7099999785423279,
        "f1-score": 0.5465742945671082,
        "specificity": 0.9715967178344727
    },
    "Ulcer": {
        "precision": 0.8242811560630798,
        "recall": 0.9020978808403015,
        "f1-score": 0.8614357113838196,
        "specificity": 0.9965291023254395
    },
    "Worms": {
        "precision": 0.773809552192688,
        "recall": 0.9558823704719543,
        "f1-score": 0.8552631735801697,
        "specificity": 0.9988172054290771
    },
    "accuracy": 0.8527770638465881,
    "macro avg": {
        "precision": 0.6875532865524292,
        "recall": 0.8007053732872009,
        "f1-score": 0.7313756346702576,
        "specificity": 0.9823470115661621
    },
    "auc_roc_scores": {
        "Angioectasia": 0.977823793888092,
        "Bleeding": 0.9894641637802124,
        "Erosion": 0.9381701946258545,
        "Erythema": 0.9767261147499084,
        "Foreign Body": 0.9836037158966064,
        "Lymphangiectasia": 0.988272488117218,
        "Normal": 0.9800708293914795,
        "Polyp": 0.9694908857345581,
        "Ulcer": 0.9977049827575684,
        "Worms": 0.9994269609451294
    },
    "average_precision_scores": {
        "Angioectasia": 0.8254418969154358,
        "Bleeding": 0.8738991022109985,
        "Erosion": 0.6366631388664246,
        "Erythema": 0.5454291105270386,
        "Foreign Body": 0.8784053325653076,
        "Lymphangiectasia": 0.8868668079376221,
        "Normal": 0.9938942790031433,
        "Polyp": 0.6602804660797119,
        "Ulcer": 0.9324300289154053,
        "Worms": 0.9741717576980591
    },
    "mean_auc": 0.980075478553772,
    "mean_average_precision": 0.8207481503486633
}
2024-10-15 03:57:28,530 - BEiT - INFO - Epoch: 2 | train_loss: 0.2261 | train_acc: 0.8561 | test_loss: 0.2693 | test_acc: 0.8528
2024-10-15 03:57:29,289 - BEiT - INFO - Best model saved with mean AUC score: 0.9801 at epoch 2
2024-10-15 04:11:16,966 - BEiT - INFO - Epoch: 3
2024-10-15 04:11:16,967 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8741998076438904,
        "recall": 0.8493780493736267,
        "f1-score": 0.8616102337837219,
        "specificity": 0.986670196056366
    },
    "Bleeding": {
        "precision": 0.910103440284729,
        "recall": 0.9181380271911621,
        "f1-score": 0.914103090763092,
        "specificity": 0.9899908304214478
    },
    "Erosion": {
        "precision": 0.7153626084327698,
        "recall": 0.721930742263794,
        "f1-score": 0.7186316847801208,
        "specificity": 0.9675987362861633
    },
    "Erythema": {
        "precision": 0.8094855546951294,
        "recall": 0.8112244606018066,
        "f1-score": 0.8103540539741516,
        "specificity": 0.9790160059928894
    },
    "Foreign Body": {
        "precision": 0.9372161626815796,
        "recall": 0.9344698786735535,
        "f1-score": 0.9358410239219666,
        "specificity": 0.9930582046508789
    },
    "Lymphangiectasia": {
        "precision": 0.9372831583023071,
        "recall": 0.9286091923713684,
        "f1-score": 0.9329259991645813,
        "specificity": 0.9930524826049805
    },
    "Normal": {
        "precision": 0.8823695182800293,
        "recall": 0.8555798530578613,
        "f1-score": 0.8687682151794434,
        "specificity": 0.9877175688743591
    },
    "Polyp": {
        "precision": 0.8062826991081238,
        "recall": 0.8448275923728943,
        "f1-score": 0.8251052498817444,
        "specificity": 0.9769975543022156
    },
    "Ulcer": {
        "precision": 0.9799893498420715,
        "recall": 0.9779019951820374,
        "f1-score": 0.9789445400238037,
        "specificity": 0.997784435749054
    },
    "Worms": {
        "precision": 0.9896640777587891,
        "recall": 0.9924851059913635,
        "f1-score": 0.9910725951194763,
        "specificity": 0.9988147616386414
    },
    "accuracy": 0.8836386799812317,
    "macro avg": {
        "precision": 0.8841956257820129,
        "recall": 0.8834545016288757,
        "f1-score": 0.8837356567382812,
        "specificity": 0.9870700836181641
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9894194602966309,
        "Bleeding": 0.9963870644569397,
        "Erosion": 0.9644258618354797,
        "Erythema": 0.9848892688751221,
        "Foreign Body": 0.9975782632827759,
        "Lymphangiectasia": 0.9967366456985474,
        "Normal": 0.9873420000076294,
        "Polyp": 0.9871776103973389,
        "Ulcer": 0.9996434450149536,
        "Worms": 0.999910831451416
    },
    "average_precision_scores": {
        "Angioectasia": 0.9407129287719727,
        "Bleeding": 0.9731833338737488,
        "Erosion": 0.7998651266098022,
        "Erythema": 0.8865145444869995,
        "Foreign Body": 0.9840737581253052,
        "Lymphangiectasia": 0.9809539318084717,
        "Normal": 0.9357565641403198,
        "Polyp": 0.9089497327804565,
        "Ulcer": 0.997369647026062,
        "Worms": 0.9992151260375977
    },
    "mean_auc": 0.9903510212898254,
    "mean_average_precision": 0.9406595230102539
}
2024-10-15 04:11:16,970 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6897233128547668,
        "recall": 0.7022132873535156,
        "f1-score": 0.69591224193573,
        "specificity": 0.9899584054946899
    },
    "Bleeding": {
        "precision": 0.600382387638092,
        "recall": 0.8746517896652222,
        "f1-score": 0.7120181322097778,
        "specificity": 0.986749529838562
    },
    "Erosion": {
        "precision": 0.44373777508735657,
        "recall": 0.7852813601493835,
        "f1-score": 0.5670521855354309,
        "specificity": 0.9240835905075073
    },
    "Erythema": {
        "precision": 0.34137290716171265,
        "recall": 0.619528591632843,
        "f1-score": 0.440191388130188,
        "specificity": 0.9775813221931458
    },
    "Foreign Body": {
        "precision": 0.5787476301193237,
        "recall": 0.8970588445663452,
        "f1-score": 0.7035755515098572,
        "specificity": 0.9859422445297241
    },
    "Lymphangiectasia": {
        "precision": 0.7670454382896423,
        "recall": 0.7871720194816589,
        "f1-score": 0.7769784331321716,
        "specificity": 0.9948065280914307
    },
    "Normal": {
        "precision": 0.9908334016799927,
        "recall": 0.8621307015419006,
        "f1-score": 0.9220123887062073,
        "specificity": 0.9745123386383057
    },
    "Polyp": {
        "precision": 0.53047776222229,
        "recall": 0.6439999938011169,
        "f1-score": 0.5817524790763855,
        "specificity": 0.9817681908607483
    },
    "Ulcer": {
        "precision": 0.9599999785423279,
        "recall": 0.9230769276618958,
        "f1-score": 0.9411764740943909,
        "specificity": 0.9993058443069458
    },
    "Worms": {
        "precision": 0.970588207244873,
        "recall": 0.970588207244873,
        "f1-score": 0.970588207244873,
        "specificity": 0.9998754858970642
    },
    "accuracy": 0.8414331674575806,
    "macro avg": {
        "precision": 0.6872908473014832,
        "recall": 0.8065701723098755,
        "f1-score": 0.7311257719993591,
        "specificity": 0.981458306312561
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9553159475326538,
        "Bleeding": 0.9852877855300903,
        "Erosion": 0.9535343050956726,
        "Erythema": 0.9652391672134399,
        "Foreign Body": 0.981358528137207,
        "Lymphangiectasia": 0.9773294925689697,
        "Normal": 0.9822624921798706,
        "Polyp": 0.9762850403785706,
        "Ulcer": 0.9990977048873901,
        "Worms": 0.9999194145202637
    },
    "average_precision_scores": {
        "Angioectasia": 0.7680937051773071,
        "Bleeding": 0.8690557479858398,
        "Erosion": 0.6618634462356567,
        "Erythema": 0.5171862840652466,
        "Foreign Body": 0.8837723731994629,
        "Lymphangiectasia": 0.8439582586288452,
        "Normal": 0.9943865537643433,
        "Polyp": 0.6403522491455078,
        "Ulcer": 0.979650616645813,
        "Worms": 0.9907200336456299
    },
    "mean_auc": 0.9775630235671997,
    "mean_average_precision": 0.8149039149284363
}
2024-10-15 04:11:16,970 - BEiT - INFO - Epoch: 3 | train_loss: 0.1721 | train_acc: 0.8836 | test_loss: 0.2583 | test_acc: 0.8414
2024-10-15 04:11:16,972 - BEiT - INFO - No improvement for 1 consecutive epochs.
2024-10-15 04:25:04,953 - BEiT - INFO - Epoch: 4
2024-10-15 04:25:04,954 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8920881748199463,
        "recall": 0.8775197863578796,
        "f1-score": 0.8847440481185913,
        "specificity": 0.9876514077186584
    },
    "Bleeding": {
        "precision": 0.9131572246551514,
        "recall": 0.9299414157867432,
        "f1-score": 0.9214729070663452,
        "specificity": 0.9901928901672363
    },
    "Erosion": {
        "precision": 0.7547374367713928,
        "recall": 0.7482554912567139,
        "f1-score": 0.7514824867248535,
        "specificity": 0.9732593297958374
    },
    "Erythema": {
        "precision": 0.8389171957969666,
        "recall": 0.851237416267395,
        "f1-score": 0.8450323939323425,
        "specificity": 0.9822870492935181
    },
    "Foreign Body": {
        "precision": 0.945131778717041,
        "recall": 0.942091166973114,
        "f1-score": 0.9436089992523193,
        "specificity": 0.9939782023429871
    },
    "Lymphangiectasia": {
        "precision": 0.9473397135734558,
        "recall": 0.936859130859375,
        "f1-score": 0.9420702457427979,
        "specificity": 0.9943069815635681
    },
    "Normal": {
        "precision": 0.9004294276237488,
        "recall": 0.8796539306640625,
        "f1-score": 0.8899204134941101,
        "specificity": 0.9890214204788208
    },
    "Polyp": {
        "precision": 0.841690719127655,
        "recall": 0.8685992956161499,
        "f1-score": 0.8549333214759827,
        "specificity": 0.9822207689285278
    },
    "Ulcer": {
        "precision": 0.9850941300392151,
        "recall": 0.9840647578239441,
        "f1-score": 0.9845792055130005,
        "specificity": 0.9983125329017639
    },
    "Worms": {
        "precision": 0.9933546185493469,
        "recall": 0.9933546185493469,
        "f1-score": 0.9933546185493469,
        "specificity": 0.9992613196372986
    },
    "accuracy": 0.9014013409614563,
    "macro avg": {
        "precision": 0.9011940360069275,
        "recall": 0.901157796382904,
        "f1-score": 0.9011198878288269,
        "specificity": 0.9890491366386414
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9925099611282349,
        "Bleeding": 0.9973745942115784,
        "Erosion": 0.9729321599006653,
        "Erythema": 0.9902254343032837,
        "Foreign Body": 0.998345136642456,
        "Lymphangiectasia": 0.9978957176208496,
        "Normal": 0.9913566708564758,
        "Polyp": 0.9913257956504822,
        "Ulcer": 0.9998002052307129,
        "Worms": 0.999968409538269
    },
    "average_precision_scores": {
        "Angioectasia": 0.9561437964439392,
        "Bleeding": 0.9785776734352112,
        "Erosion": 0.8411523103713989,
        "Erythema": 0.9252580404281616,
        "Foreign Body": 0.9877052307128906,
        "Lymphangiectasia": 0.9857114553451538,
        "Normal": 0.9555906057357788,
        "Polyp": 0.935818076133728,
        "Ulcer": 0.9984598159790039,
        "Worms": 0.999758780002594
    },
    "mean_auc": 0.9931734204292297,
    "mean_average_precision": 0.9564175605773926
}
2024-10-15 04:25:04,955 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.5432432293891907,
        "recall": 0.8088530898094177,
        "f1-score": 0.6499595642089844,
        "specificity": 0.9783818125724792
    },
    "Bleeding": {
        "precision": 0.7742782235145569,
        "recall": 0.8217270374298096,
        "f1-score": 0.7972972989082336,
        "specificity": 0.9945476651191711
    },
    "Erosion": {
        "precision": 0.5819373726844788,
        "recall": 0.6917749047279358,
        "f1-score": 0.6321202516555786,
        "specificity": 0.9616745710372925
    },
    "Erythema": {
        "precision": 0.3297644555568695,
        "recall": 0.5185185074806213,
        "f1-score": 0.4031413495540619,
        "specificity": 0.9802336692810059
    },
    "Foreign Body": {
        "precision": 0.6007827520370483,
        "recall": 0.9029411673545837,
        "f1-score": 0.7215040922164917,
        "specificity": 0.9870820641517639
    },
    "Lymphangiectasia": {
        "precision": 0.43550625443458557,
        "recall": 0.9154518842697144,
        "f1-score": 0.5902255773544312,
        "specificity": 0.9742225408554077
    },
    "Normal": {
        "precision": 0.9932571649551392,
        "recall": 0.8631887435913086,
        "f1-score": 0.9236664772033691,
        "specificity": 0.9812743663787842
    },
    "Polyp": {
        "precision": 0.4349355101585388,
        "recall": 0.7419999837875366,
        "f1-score": 0.548410952091217,
        "specificity": 0.9691658020019531
    },
    "Ulcer": {
        "precision": 0.8870431780815125,
        "recall": 0.9335664510726929,
        "f1-score": 0.9097104072570801,
        "specificity": 0.9978543519973755
    },
    "Worms": {
        "precision": 0.6168224215507507,
        "recall": 0.970588207244873,
        "f1-score": 0.7542856931686401,
        "specificity": 0.9974477291107178
    },
    "accuracy": 0.8418670892715454,
    "macro avg": {
        "precision": 0.6197571158409119,
        "recall": 0.8168609738349915,
        "f1-score": 0.6930322051048279,
        "specificity": 0.9821884036064148
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9673111438751221,
        "Bleeding": 0.9897437691688538,
        "Erosion": 0.9524064660072327,
        "Erythema": 0.9463450312614441,
        "Foreign Body": 0.9870370030403137,
        "Lymphangiectasia": 0.9908900856971741,
        "Normal": 0.9843541383743286,
        "Polyp": 0.9739168882369995,
        "Ulcer": 0.9983690977096558,
        "Worms": 0.9998709559440613
    },
    "average_precision_scores": {
        "Angioectasia": 0.8084725737571716,
        "Bleeding": 0.8835518956184387,
        "Erosion": 0.7047090530395508,
        "Erythema": 0.436969518661499,
        "Foreign Body": 0.901557445526123,
        "Lymphangiectasia": 0.870093822479248,
        "Normal": 0.9950182437896729,
        "Polyp": 0.6448290348052979,
        "Ulcer": 0.9655882120132446,
        "Worms": 0.9806786179542542
    },
    "mean_auc": 0.9790245294570923,
    "mean_average_precision": 0.8191469311714172
}
2024-10-15 04:25:04,956 - BEiT - INFO - Epoch: 4 | train_loss: 0.1389 | train_acc: 0.9014 | test_loss: 0.2735 | test_acc: 0.8419
2024-10-15 04:25:04,957 - BEiT - INFO - No improvement for 2 consecutive epochs.
2024-10-15 04:38:53,529 - BEiT - INFO - Epoch: 5
2024-10-15 04:38:53,530 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9130434989929199,
        "recall": 0.8973870277404785,
        "f1-score": 0.9051475524902344,
        "specificity": 0.9907464981079102
    },
    "Bleeding": {
        "precision": 0.9299757480621338,
        "recall": 0.9403594732284546,
        "f1-score": 0.9351388216018677,
        "specificity": 0.9923382997512817
    },
    "Erosion": {
        "precision": 0.7881224155426025,
        "recall": 0.7883268594741821,
        "f1-score": 0.7882246375083923,
        "specificity": 0.9757940173149109
    },
    "Erythema": {
        "precision": 0.874805212020874,
        "recall": 0.8789144158363342,
        "f1-score": 0.8768549561500549,
        "specificity": 0.9857290983200073
    },
    "Foreign Body": {
        "precision": 0.953983724117279,
        "recall": 0.9537329077720642,
        "f1-score": 0.9538583159446716,
        "specificity": 0.9948229193687439
    },
    "Lymphangiectasia": {
        "precision": 0.9517405033111572,
        "recall": 0.9504872560501099,
        "f1-score": 0.9511134624481201,
        "specificity": 0.9945874214172363
    },
    "Normal": {
        "precision": 0.9117093086242676,
        "recall": 0.8894432783126831,
        "f1-score": 0.900438666343689,
        "specificity": 0.9902955889701843
    },
    "Polyp": {
        "precision": 0.8691709637641907,
        "recall": 0.8920499682426453,
        "f1-score": 0.8804618716239929,
        "specificity": 0.9850794672966003
    },
    "Ulcer": {
        "precision": 0.9847577810287476,
        "recall": 0.9855625033378601,
        "f1-score": 0.9851599931716919,
        "specificity": 0.9983498454093933
    },
    "Worms": {
        "precision": 0.9938387274742126,
        "recall": 0.9938387274742126,
        "f1-score": 0.9938387274742126,
        "specificity": 0.9993209838867188
    },
    "accuracy": 0.9164251089096069,
    "macro avg": {
        "precision": 0.9171148538589478,
        "recall": 0.9170103073120117,
        "f1-score": 0.9170236587524414,
        "specificity": 0.9907064437866211
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9949518442153931,
        "Bleeding": 0.9982336759567261,
        "Erosion": 0.9799075126647949,
        "Erythema": 0.9930520057678223,
        "Foreign Body": 0.9987841248512268,
        "Lymphangiectasia": 0.9982637166976929,
        "Normal": 0.9916053414344788,
        "Polyp": 0.9940521717071533,
        "Ulcer": 0.9998846054077148,
        "Worms": 0.9999510645866394
    },
    "average_precision_scores": {
        "Angioectasia": 0.9678782820701599,
        "Bleeding": 0.9846979975700378,
        "Erosion": 0.8757872581481934,
        "Erythema": 0.9437015056610107,
        "Foreign Body": 0.991267204284668,
        "Lymphangiectasia": 0.9880080819129944,
        "Normal": 0.9598300457000732,
        "Polyp": 0.9537724256515503,
        "Ulcer": 0.9989936351776123,
        "Worms": 0.9995993971824646
    },
    "mean_auc": 0.9948685765266418,
    "mean_average_precision": 0.9663535952568054
}
2024-10-15 04:38:53,532 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.5916905403137207,
        "recall": 0.8309859037399292,
        "f1-score": 0.6912133693695068,
        "specificity": 0.9817716479301453
    },
    "Bleeding": {
        "precision": 0.751842737197876,
        "recall": 0.8523676991462708,
        "f1-score": 0.7989556193351746,
        "specificity": 0.9935966730117798
    },
    "Erosion": {
        "precision": 0.6545454263687134,
        "recall": 0.6545454263687134,
        "f1-score": 0.6545454263687134,
        "specificity": 0.9733591675758362
    },
    "Erythema": {
        "precision": 0.37937742471694946,
        "recall": 0.6565656661987305,
        "f1-score": 0.4808878004550934,
        "specificity": 0.9798547625541687
    },
    "Foreign Body": {
        "precision": 0.5065146684646606,
        "recall": 0.9147058725357056,
        "f1-score": 0.651991605758667,
        "specificity": 0.9808130860328674
    },
    "Lymphangiectasia": {
        "precision": 0.2924613952636719,
        "recall": 0.9387755393981934,
        "f1-score": 0.4459833800792694,
        "specificity": 0.950661838054657
    },
    "Normal": {
        "precision": 0.9931014776229858,
        "recall": 0.8435745239257812,
        "f1-score": 0.912251353263855,
        "specificity": 0.9812743663787842
    },
    "Polyp": {
        "precision": 0.4478908181190491,
        "recall": 0.722000002861023,
        "f1-score": 0.552833080291748,
        "specificity": 0.9715327620506287
    },
    "Ulcer": {
        "precision": 0.8607594966888428,
        "recall": 0.9510489702224731,
        "f1-score": 0.9036544561386108,
        "specificity": 0.9972232580184937
    },
    "Worms": {
        "precision": 0.7976190447807312,
        "recall": 0.9852941036224365,
        "f1-score": 0.8815789222717285,
        "specificity": 0.9989417195320129
    },
    "accuracy": 0.8286635279655457,
    "macro avg": {
        "precision": 0.6275803446769714,
        "recall": 0.8349863290786743,
        "f1-score": 0.697389543056488,
        "specificity": 0.9809029698371887
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9756993055343628,
        "Bleeding": 0.9885887503623962,
        "Erosion": 0.9581393003463745,
        "Erythema": 0.9735153913497925,
        "Foreign Body": 0.9867462515830994,
        "Lymphangiectasia": 0.983771026134491,
        "Normal": 0.9846997261047363,
        "Polyp": 0.9738683700561523,
        "Ulcer": 0.9959454536437988,
        "Worms": 0.9999551177024841
    },
    "average_precision_scores": {
        "Angioectasia": 0.8383419513702393,
        "Bleeding": 0.8927998542785645,
        "Erosion": 0.7344571352005005,
        "Erythema": 0.5622789263725281,
        "Foreign Body": 0.8974628448486328,
        "Lymphangiectasia": 0.866227388381958,
        "Normal": 0.9951073527336121,
        "Polyp": 0.6496607065200806,
        "Ulcer": 0.9730167388916016,
        "Worms": 0.9927199482917786
    },
    "mean_auc": 0.9820928573608398,
    "mean_average_precision": 0.8402072787284851
}
2024-10-15 04:38:53,533 - BEiT - INFO - Epoch: 5 | train_loss: 0.1135 | train_acc: 0.9164 | test_loss: 0.2749 | test_acc: 0.8287
2024-10-15 04:38:54,218 - BEiT - INFO - Best model saved with mean AUC score: 0.9821 at epoch 5
2024-10-15 04:52:42,666 - BEiT - INFO - Epoch: 6
2024-10-15 04:52:42,667 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9208478927612305,
        "recall": 0.9125232696533203,
        "f1-score": 0.9166666865348816,
        "specificity": 0.9912840723991394
    },
    "Bleeding": {
        "precision": 0.9412698149681091,
        "recall": 0.9485470652580261,
        "f1-score": 0.9448944330215454,
        "specificity": 0.9934428334236145
    },
    "Erosion": {
        "precision": 0.8168224096298218,
        "recall": 0.8181331753730774,
        "f1-score": 0.817477285861969,
        "specificity": 0.9797449111938477
    },
    "Erythema": {
        "precision": 0.8935887217521667,
        "recall": 0.8964505195617676,
        "f1-score": 0.8950173258781433,
        "specificity": 0.9881866574287415
    },
    "Foreign Body": {
        "precision": 0.9616734385490417,
        "recall": 0.9621928334236145,
        "f1-score": 0.9619330167770386,
        "specificity": 0.9958117008209229
    },
    "Lymphangiectasia": {
        "precision": 0.956084668636322,
        "recall": 0.9538136720657349,
        "f1-score": 0.954947829246521,
        "specificity": 0.9950913786888123
    },
    "Normal": {
        "precision": 0.9257221221923828,
        "recall": 0.9072526097297668,
        "f1-score": 0.9163943529129028,
        "specificity": 0.992034912109375
    },
    "Polyp": {
        "precision": 0.8905524015426636,
        "recall": 0.9076558947563171,
        "f1-score": 0.8990228176116943,
        "specificity": 0.9874578714370728
    },
    "Ulcer": {
        "precision": 0.9864757061004639,
        "recall": 0.9849086403846741,
        "f1-score": 0.9856915473937988,
        "specificity": 0.9984924793243408
    },
    "Worms": {
        "precision": 0.9924301505088806,
        "recall": 0.992689311504364,
        "f1-score": 0.9925597310066223,
        "specificity": 0.9991414546966553
    },
    "accuracy": 0.9286037087440491,
    "macro avg": {
        "precision": 0.9285467267036438,
        "recall": 0.9284167289733887,
        "f1-score": 0.9284605383872986,
        "specificity": 0.992068886756897
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9965342879295349,
        "Bleeding": 0.9983720779418945,
        "Erosion": 0.9840735197067261,
        "Erythema": 0.9951202273368835,
        "Foreign Body": 0.9991004467010498,
        "Lymphangiectasia": 0.9987643957138062,
        "Normal": 0.992904543876648,
        "Polyp": 0.9951083064079285,
        "Ulcer": 0.9998447299003601,
        "Worms": 0.9999712109565735
    },
    "average_precision_scores": {
        "Angioectasia": 0.9762210845947266,
        "Bleeding": 0.987393856048584,
        "Erosion": 0.9023803472518921,
        "Erythema": 0.9585033655166626,
        "Foreign Body": 0.9935812950134277,
        "Lymphangiectasia": 0.9916509389877319,
        "Normal": 0.966556191444397,
        "Polyp": 0.9590721130371094,
        "Ulcer": 0.9987724423408508,
        "Worms": 0.9997476935386658
    },
    "mean_auc": 0.9959793090820312,
    "mean_average_precision": 0.9733878970146179
}
2024-10-15 04:52:42,669 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.45828819274902344,
        "recall": 0.8511066436767578,
        "f1-score": 0.5957746505737305,
        "specificity": 0.9680204391479492
    },
    "Bleeding": {
        "precision": 0.6832579374313354,
        "recall": 0.8412256240844727,
        "f1-score": 0.7540574073791504,
        "specificity": 0.9911240935325623
    },
    "Erosion": {
        "precision": 0.5688202381134033,
        "recall": 0.701298713684082,
        "f1-score": 0.628150463104248,
        "specificity": 0.9590038061141968
    },
    "Erythema": {
        "precision": 0.5111111402511597,
        "recall": 0.619528591632843,
        "f1-score": 0.5601217746734619,
        "specificity": 0.9888854026794434
    },
    "Foreign Body": {
        "precision": 0.5944334268569946,
        "recall": 0.8794117569923401,
        "f1-score": 0.7093712687492371,
        "specificity": 0.9870820641517639
    },
    "Lymphangiectasia": {
        "precision": 0.6523604989051819,
        "recall": 0.8862974047660828,
        "f1-score": 0.7515451312065125,
        "specificity": 0.989739716053009
    },
    "Normal": {
        "precision": 0.9913864135742188,
        "recall": 0.8805241584777832,
        "f1-score": 0.9326724410057068,
        "specificity": 0.9755526781082153
    },
    "Polyp": {
        "precision": 0.5213414430618286,
        "recall": 0.6840000152587891,
        "f1-score": 0.5916954874992371,
        "specificity": 0.9799129962921143
    },
    "Ulcer": {
        "precision": 0.7411444187164307,
        "recall": 0.9510489702224731,
        "f1-score": 0.8330780863761902,
        "specificity": 0.9940047860145569
    },
    "Worms": {
        "precision": 0.8461538553237915,
        "recall": 0.970588207244873,
        "f1-score": 0.9041095972061157,
        "specificity": 0.99925297498703
    },
    "accuracy": 0.8567443490028381,
    "macro avg": {
        "precision": 0.6568297743797302,
        "recall": 0.8265029788017273,
        "f1-score": 0.7260577082633972,
        "specificity": 0.9832578897476196
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9750974774360657,
        "Bleeding": 0.9876012802124023,
        "Erosion": 0.9440246224403381,
        "Erythema": 0.9744875431060791,
        "Foreign Body": 0.9796944856643677,
        "Lymphangiectasia": 0.9858415126800537,
        "Normal": 0.9860094785690308,
        "Polyp": 0.9739853143692017,
        "Ulcer": 0.9978878498077393,
        "Worms": 0.999908447265625
    },
    "average_precision_scores": {
        "Angioectasia": 0.7981816530227661,
        "Bleeding": 0.8645259141921997,
        "Erosion": 0.7139970064163208,
        "Erythema": 0.579138457775116,
        "Foreign Body": 0.8788726329803467,
        "Lymphangiectasia": 0.873430609703064,
        "Normal": 0.9955747723579407,
        "Polyp": 0.6589597463607788,
        "Ulcer": 0.9618494510650635,
        "Worms": 0.9798787832260132
    },
    "mean_auc": 0.9804539084434509,
    "mean_average_precision": 0.8304409384727478
}
2024-10-15 04:52:42,670 - BEiT - INFO - Epoch: 6 | train_loss: 0.0966 | train_acc: 0.9286 | test_loss: 0.2371 | test_acc: 0.8567
2024-10-15 04:52:42,671 - BEiT - INFO - No improvement for 1 consecutive epochs.
2024-10-15 05:06:30,590 - BEiT - INFO - Epoch: 7
2024-10-15 05:06:30,591 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9287564754486084,
        "recall": 0.9265960454940796,
        "f1-score": 0.9276750087738037,
        "specificity": 0.9918489456176758
    },
    "Bleeding": {
        "precision": 0.9466248154640198,
        "recall": 0.955878496170044,
        "f1-score": 0.9512291550636292,
        "specificity": 0.9939684271812439
    },
    "Erosion": {
        "precision": 0.8356794714927673,
        "recall": 0.8300618529319763,
        "f1-score": 0.8328611850738525,
        "specificity": 0.982088029384613
    },
    "Erythema": {
        "precision": 0.9069518446922302,
        "recall": 0.9106040000915527,
        "f1-score": 0.9087742567062378,
        "specificity": 0.9897290468215942
    },
    "Foreign Body": {
        "precision": 0.9601699709892273,
        "recall": 0.9642666578292847,
        "f1-score": 0.962213933467865,
        "specificity": 0.9955695867538452
    },
    "Lymphangiectasia": {
        "precision": 0.9646865725517273,
        "recall": 0.9607415199279785,
        "f1-score": 0.9627100229263306,
        "specificity": 0.9961990714073181
    },
    "Normal": {
        "precision": 0.930232584476471,
        "recall": 0.9076175093650818,
        "f1-score": 0.9187858700752258,
        "specificity": 0.9925674796104431
    },
    "Polyp": {
        "precision": 0.909183919429779,
        "recall": 0.9291503429412842,
        "f1-score": 0.9190586805343628,
        "specificity": 0.9894914627075195
    },
    "Ulcer": {
        "precision": 0.9928401112556458,
        "recall": 0.9902142286300659,
        "f1-score": 0.991525411605835,
        "specificity": 0.999201774597168
    },
    "Worms": {
        "precision": 0.9936507940292358,
        "recall": 0.9928628206253052,
        "f1-score": 0.9932566285133362,
        "specificity": 0.9992904663085938
    },
    "accuracy": 0.9369532465934753,
    "macro avg": {
        "precision": 0.9368776679039001,
        "recall": 0.9367993474006653,
        "f1-score": 0.9368090033531189,
        "specificity": 0.9929954409599304
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9971673488616943,
        "Bleeding": 0.9989224672317505,
        "Erosion": 0.9880540370941162,
        "Erythema": 0.9964790344238281,
        "Foreign Body": 0.9993491172790527,
        "Lymphangiectasia": 0.998943567276001,
        "Normal": 0.9942235350608826,
        "Polyp": 0.9969420433044434,
        "Ulcer": 0.9999516010284424,
        "Worms": 0.9999760389328003
    },
    "average_precision_scores": {
        "Angioectasia": 0.9810618162155151,
        "Bleeding": 0.9901604652404785,
        "Erosion": 0.919234037399292,
        "Erythema": 0.9708203673362732,
        "Foreign Body": 0.9948483109474182,
        "Lymphangiectasia": 0.9927316904067993,
        "Normal": 0.97173672914505,
        "Polyp": 0.9747068285942078,
        "Ulcer": 0.9995825886726379,
        "Worms": 0.9997904300689697
    },
    "mean_auc": 0.9970008730888367,
    "mean_average_precision": 0.9794673919677734
}
2024-10-15 05:06:30,593 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7302504777908325,
        "recall": 0.7625754475593567,
        "f1-score": 0.7460629940032959,
        "specificity": 0.9910457134246826
    },
    "Bleeding": {
        "precision": 0.6611570119857788,
        "recall": 0.8913649320602417,
        "f1-score": 0.7591933608055115,
        "specificity": 0.9896025061607361
    },
    "Erosion": {
        "precision": 0.6020408272743225,
        "recall": 0.6640692353248596,
        "f1-score": 0.6315355896949768,
        "specificity": 0.9661480784416199
    },
    "Erythema": {
        "precision": 0.30367231369018555,
        "recall": 0.7239057421684265,
        "f1-score": 0.42786070704460144,
        "specificity": 0.9688664078712463
    },
    "Foreign Body": {
        "precision": 0.7444168925285339,
        "recall": 0.8823529481887817,
        "f1-score": 0.8075370192527771,
        "specificity": 0.9934777021408081
    },
    "Lymphangiectasia": {
        "precision": 0.6260162591934204,
        "recall": 0.8979591727256775,
        "f1-score": 0.7377245426177979,
        "specificity": 0.9883463382720947
    },
    "Normal": {
        "precision": 0.9911938309669495,
        "recall": 0.8885814547538757,
        "f1-score": 0.9370869398117065,
        "specificity": 0.9747724533081055
    },
    "Polyp": {
        "precision": 0.44624999165534973,
        "recall": 0.7139999866485596,
        "f1-score": 0.5492307543754578,
        "specificity": 0.9716606736183167
    },
    "Ulcer": {
        "precision": 0.8217522501945496,
        "recall": 0.9510489702224731,
        "f1-score": 0.8816855549812317,
        "specificity": 0.9962766766548157
    },
    "Worms": {
        "precision": 0.6415094137191772,
        "recall": 1.0,
        "f1-score": 0.7816091775894165,
        "specificity": 0.9976344704627991
    },
    "accuracy": 0.8618894219398499,
    "macro avg": {
        "precision": 0.6568259596824646,
        "recall": 0.8375858664512634,
        "f1-score": 0.7259526252746582,
        "specificity": 0.9837830662727356
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9756039381027222,
        "Bleeding": 0.9906401634216309,
        "Erosion": 0.9368457794189453,
        "Erythema": 0.9691545963287354,
        "Foreign Body": 0.9890910387039185,
        "Lymphangiectasia": 0.9862077236175537,
        "Normal": 0.9861623048782349,
        "Polyp": 0.9728659391403198,
        "Ulcer": 0.9989210367202759,
        "Worms": 0.999902069568634
    },
    "average_precision_scores": {
        "Angioectasia": 0.8403942584991455,
        "Bleeding": 0.8784606456756592,
        "Erosion": 0.6947693228721619,
        "Erythema": 0.5485398769378662,
        "Foreign Body": 0.9115405678749084,
        "Lymphangiectasia": 0.8917853832244873,
        "Normal": 0.9957643747329712,
        "Polyp": 0.6025089025497437,
        "Ulcer": 0.9679697751998901,
        "Worms": 0.9808908104896545
    },
    "mean_auc": 0.9805395007133484,
    "mean_average_precision": 0.8312624096870422
}
2024-10-15 05:06:30,593 - BEiT - INFO - Epoch: 7 | train_loss: 0.0810 | train_acc: 0.9370 | test_loss: 0.2467 | test_acc: 0.8619
2024-10-15 05:06:30,594 - BEiT - INFO - No improvement for 2 consecutive epochs.
2024-10-15 05:20:19,067 - BEiT - INFO - Epoch: 8
2024-10-15 05:20:19,069 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.935072124004364,
        "recall": 0.9270976781845093,
        "f1-score": 0.9310678243637085,
        "specificity": 0.9931119680404663
    },
    "Bleeding": {
        "precision": 0.9498680830001831,
        "recall": 0.9592326283454895,
        "f1-score": 0.9545273780822754,
        "specificity": 0.994387686252594
    },
    "Erosion": {
        "precision": 0.8526831865310669,
        "recall": 0.8493960499763489,
        "f1-score": 0.8510364294052124,
        "specificity": 0.9830644130706787
    },
    "Erythema": {
        "precision": 0.913131833076477,
        "recall": 0.9227412939071655,
        "f1-score": 0.9179114103317261,
        "specificity": 0.9898549318313599
    },
    "Foreign Body": {
        "precision": 0.962824285030365,
        "recall": 0.9654062986373901,
        "f1-score": 0.9641135334968567,
        "specificity": 0.9958970546722412
    },
    "Lymphangiectasia": {
        "precision": 0.9705804586410522,
        "recall": 0.9654626846313477,
        "f1-score": 0.9680147767066956,
        "specificity": 0.9967173337936401
    },
    "Normal": {
        "precision": 0.9384487867355347,
        "recall": 0.9196646213531494,
        "f1-score": 0.9289617538452148,
        "specificity": 0.9934237599372864
    },
    "Polyp": {
        "precision": 0.9159641861915588,
        "recall": 0.9294306039810181,
        "f1-score": 0.9226482510566711,
        "specificity": 0.9905804991722107
    },
    "Ulcer": {
        "precision": 0.9892847537994385,
        "recall": 0.9882258772850037,
        "f1-score": 0.9887550473213196,
        "specificity": 0.9988189935684204
    },
    "Worms": {
        "precision": 0.9965203404426575,
        "recall": 0.9967871308326721,
        "f1-score": 0.9966537356376648,
        "specificity": 0.9996162056922913
    },
    "accuracy": 0.9419788718223572,
    "macro avg": {
        "precision": 0.9424378275871277,
        "recall": 0.9423444867134094,
        "f1-score": 0.9423689842224121,
        "specificity": 0.993547260761261
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9975433349609375,
        "Bleeding": 0.9990787506103516,
        "Erosion": 0.9891712665557861,
        "Erythema": 0.9967401623725891,
        "Foreign Body": 0.9994345903396606,
        "Lymphangiectasia": 0.9992247819900513,
        "Normal": 0.9954013228416443,
        "Polyp": 0.9971476793289185,
        "Ulcer": 0.9999409914016724,
        "Worms": 0.9999940395355225
    },
    "average_precision_scores": {
        "Angioectasia": 0.9824345707893372,
        "Bleeding": 0.9918978214263916,
        "Erosion": 0.9323418736457825,
        "Erythema": 0.9740188717842102,
        "Foreign Body": 0.9950377345085144,
        "Lymphangiectasia": 0.9942028522491455,
        "Normal": 0.9756948351860046,
        "Polyp": 0.9776544570922852,
        "Ulcer": 0.999477207660675,
        "Worms": 0.999945878982544
    },
    "mean_auc": 0.9973676800727844,
    "mean_average_precision": 0.9822706580162048
}
2024-10-15 05:20:19,070 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7180451154708862,
        "recall": 0.7686116695404053,
        "f1-score": 0.7424684166908264,
        "specificity": 0.9904061555862427
    },
    "Bleeding": {
        "precision": 0.7469287514686584,
        "recall": 0.8467966318130493,
        "f1-score": 0.7937336564064026,
        "specificity": 0.9934698343276978
    },
    "Erosion": {
        "precision": 0.6412451267242432,
        "recall": 0.7134199142456055,
        "f1-score": 0.6754098534584045,
        "specificity": 0.969219446182251
    },
    "Erythema": {
        "precision": 0.41986456513404846,
        "recall": 0.6262626051902771,
        "f1-score": 0.5027027130126953,
        "specificity": 0.9837701320648193
    },
    "Foreign Body": {
        "precision": 0.7824933528900146,
        "recall": 0.8676470518112183,
        "f1-score": 0.822873055934906,
        "specificity": 0.9948074817657471
    },
    "Lymphangiectasia": {
        "precision": 0.5976788997650146,
        "recall": 0.9008746147155762,
        "f1-score": 0.7186046242713928,
        "specificity": 0.9868263006210327
    },
    "Normal": {
        "precision": 0.9886502623558044,
        "recall": 0.921624481678009,
        "f1-score": 0.9539614915847778,
        "specificity": 0.9661898612976074
    },
    "Polyp": {
        "precision": 0.5371178984642029,
        "recall": 0.7379999756813049,
        "f1-score": 0.6217354536056519,
        "specificity": 0.9796571135520935
    },
    "Ulcer": {
        "precision": 0.9285714030265808,
        "recall": 0.9545454382896423,
        "f1-score": 0.9413793087005615,
        "specificity": 0.998674750328064
    },
    "Worms": {
        "precision": 0.5,
        "recall": 1.0,
        "f1-score": 0.6666666865348816,
        "specificity": 0.9957669377326965
    },
    "accuracy": 0.888544499874115,
    "macro avg": {
        "precision": 0.6860595345497131,
        "recall": 0.8337783217430115,
        "f1-score": 0.74395352602005,
        "specificity": 0.9858787655830383
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9700884819030762,
        "Bleeding": 0.9936431050300598,
        "Erosion": 0.9598302841186523,
        "Erythema": 0.9692187309265137,
        "Foreign Body": 0.9808434247970581,
        "Lymphangiectasia": 0.986632764339447,
        "Normal": 0.9881517887115479,
        "Polyp": 0.9757831692695618,
        "Ulcer": 0.9987235069274902,
        "Worms": 0.9998810291290283
    },
    "average_precision_scores": {
        "Angioectasia": 0.8351515531539917,
        "Bleeding": 0.8929532766342163,
        "Erosion": 0.7515881061553955,
        "Erythema": 0.5479075908660889,
        "Foreign Body": 0.8876612186431885,
        "Lymphangiectasia": 0.8820517063140869,
        "Normal": 0.9962573647499084,
        "Polyp": 0.7077792882919312,
        "Ulcer": 0.9795454740524292,
        "Worms": 0.9808329343795776
    },
    "mean_auc": 0.9822795987129211,
    "mean_average_precision": 0.8461729288101196
}
2024-10-15 05:20:19,071 - BEiT - INFO - Epoch: 8 | train_loss: 0.0742 | train_acc: 0.9420 | test_loss: 0.1965 | test_acc: 0.8885
2024-10-15 05:20:19,753 - BEiT - INFO - Best model saved with mean AUC score: 0.9823 at epoch 8
2024-10-15 05:34:08,033 - BEiT - INFO - Epoch: 9
2024-10-15 05:34:08,034 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9556978940963745,
        "recall": 0.9521403908729553,
        "f1-score": 0.9539158344268799,
        "specificity": 0.995095431804657
    },
    "Bleeding": {
        "precision": 0.9510912299156189,
        "recall": 0.9578919410705566,
        "f1-score": 0.954479455947876,
        "specificity": 0.994502067565918
    },
    "Erosion": {
        "precision": 0.8766791820526123,
        "recall": 0.8715277910232544,
        "f1-score": 0.8740959167480469,
        "specificity": 0.9864453673362732
    },
    "Erythema": {
        "precision": 0.9229342937469482,
        "recall": 0.9295812249183655,
        "f1-score": 0.9262458682060242,
        "specificity": 0.9914053082466125
    },
    "Foreign Body": {
        "precision": 0.9683270454406738,
        "recall": 0.9672796130180359,
        "f1-score": 0.9678030014038086,
        "specificity": 0.9965496063232422
    },
    "Lymphangiectasia": {
        "precision": 0.9721136093139648,
        "recall": 0.9738903641700745,
        "f1-score": 0.9730011820793152,
        "specificity": 0.9968321919441223
    },
    "Normal": {
        "precision": 0.9443249106407166,
        "recall": 0.9280993938446045,
        "f1-score": 0.936141848564148,
        "specificity": 0.9938800930976868
    },
    "Polyp": {
        "precision": 0.9264126420021057,
        "recall": 0.9372507333755493,
        "f1-score": 0.9318001866340637,
        "specificity": 0.9917272329330444
    },
    "Ulcer": {
        "precision": 0.9957481026649475,
        "recall": 0.9949548840522766,
        "f1-score": 0.9953513145446777,
        "specificity": 0.9995272159576416
    },
    "Worms": {
        "precision": 0.9959914684295654,
        "recall": 0.9967905879020691,
        "f1-score": 0.9963908791542053,
        "specificity": 0.9995570778846741
    },
    "accuracy": 0.9509665966033936,
    "macro avg": {
        "precision": 0.9509320259094238,
        "recall": 0.950940728187561,
        "f1-score": 0.9509226083755493,
        "specificity": 0.9945522546768188
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9985179901123047,
        "Bleeding": 0.9991832971572876,
        "Erosion": 0.9923043251037598,
        "Erythema": 0.9976435899734497,
        "Foreign Body": 0.9993208646774292,
        "Lymphangiectasia": 0.9994614124298096,
        "Normal": 0.9961919784545898,
        "Polyp": 0.9979846477508545,
        "Ulcer": 0.999981164932251,
        "Worms": 0.999995231628418
    },
    "average_precision_scores": {
        "Angioectasia": 0.9900418519973755,
        "Bleeding": 0.9927653074264526,
        "Erosion": 0.9493906497955322,
        "Erythema": 0.9799082279205322,
        "Foreign Body": 0.9955195188522339,
        "Lymphangiectasia": 0.995850682258606,
        "Normal": 0.979780912399292,
        "Polyp": 0.9829045534133911,
        "Ulcer": 0.9998360276222229,
        "Worms": 0.9999567866325378
    },
    "mean_auc": 0.9980584979057312,
    "mean_average_precision": 0.9865954518318176
}
2024-10-15 05:34:08,036 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7214022278785706,
        "recall": 0.786720335483551,
        "f1-score": 0.752646803855896,
        "specificity": 0.9903421998023987
    },
    "Bleeding": {
        "precision": 0.741706132888794,
        "recall": 0.8718662858009338,
        "f1-score": 0.801536500453949,
        "specificity": 0.9930894374847412
    },
    "Erosion": {
        "precision": 0.6048632264137268,
        "recall": 0.6891775131225586,
        "f1-score": 0.644273579120636,
        "specificity": 0.9652801156044006
    },
    "Erythema": {
        "precision": 0.41883766651153564,
        "recall": 0.7037037014961243,
        "f1-score": 0.5251256227493286,
        "specificity": 0.9816861152648926
    },
    "Foreign Body": {
        "precision": 0.7307692170143127,
        "recall": 0.8941176533699036,
        "f1-score": 0.8042327761650085,
        "specificity": 0.9929078221321106
    },
    "Lymphangiectasia": {
        "precision": 0.5360281467437744,
        "recall": 0.8892128467559814,
        "f1-score": 0.6688596606254578,
        "specificity": 0.9832795262336731
    },
    "Normal": {
        "precision": 0.9883036017417908,
        "recall": 0.9146252274513245,
        "f1-score": 0.9500380158424377,
        "specificity": 0.9654096364974976
    },
    "Polyp": {
        "precision": 0.5702341198921204,
        "recall": 0.6819999814033508,
        "f1-score": 0.6211293339729309,
        "specificity": 0.9835593700408936
    },
    "Ulcer": {
        "precision": 0.8823529481887817,
        "recall": 0.9440559148788452,
        "f1-score": 0.912162184715271,
        "specificity": 0.9977281093597412
    },
    "Worms": {
        "precision": 0.7096773982048035,
        "recall": 0.970588207244873,
        "f1-score": 0.8198757767677307,
        "specificity": 0.9983192086219788
    },
    "accuracy": 0.8822836875915527,
    "macro avg": {
        "precision": 0.690417468547821,
        "recall": 0.8346067667007446,
        "f1-score": 0.7499880790710449,
        "specificity": 0.9851601719856262
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9702411890029907,
        "Bleeding": 0.9874915480613708,
        "Erosion": 0.9566678404808044,
        "Erythema": 0.9772668480873108,
        "Foreign Body": 0.985805332660675,
        "Lymphangiectasia": 0.9862998723983765,
        "Normal": 0.9881424903869629,
        "Polyp": 0.9697178602218628,
        "Ulcer": 0.9976028203964233,
        "Worms": 0.9999039173126221
    },
    "average_precision_scores": {
        "Angioectasia": 0.8475078344345093,
        "Bleeding": 0.9034255743026733,
        "Erosion": 0.7367808818817139,
        "Erythema": 0.6151694059371948,
        "Foreign Body": 0.9092727899551392,
        "Lymphangiectasia": 0.8731499910354614,
        "Normal": 0.9962373971939087,
        "Polyp": 0.6607407927513123,
        "Ulcer": 0.966705858707428,
        "Worms": 0.9825171828269958
    },
    "mean_auc": 0.9819139838218689,
    "mean_average_precision": 0.8491507768630981
}
2024-10-15 05:34:08,037 - BEiT - INFO - Epoch: 9 | train_loss: 0.0614 | train_acc: 0.9510 | test_loss: 0.1983 | test_acc: 0.8823
2024-10-15 05:34:08,038 - BEiT - INFO - No improvement for 1 consecutive epochs.
2024-10-15 05:47:56,429 - BEiT - INFO - Epoch: 10
2024-10-15 05:47:56,430 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9576248526573181,
        "recall": 0.9550471305847168,
        "f1-score": 0.9563342332839966,
        "specificity": 0.9953676462173462
    },
    "Bleeding": {
        "precision": 0.9578157067298889,
        "recall": 0.966066300868988,
        "f1-score": 0.9619233012199402,
        "specificity": 0.9951741099357605
    },
    "Erosion": {
        "precision": 0.8929939866065979,
        "recall": 0.8807017803192139,
        "f1-score": 0.8868052959442139,
        "specificity": 0.988466739654541
    },
    "Erythema": {
        "precision": 0.9274042248725891,
        "recall": 0.9397394061088562,
        "f1-score": 0.9335311055183411,
        "specificity": 0.992011308670044
    },
    "Foreign Body": {
        "precision": 0.9713147282600403,
        "recall": 0.9746801853179932,
        "f1-score": 0.9729945659637451,
        "specificity": 0.9968098998069763
    },
    "Lymphangiectasia": {
        "precision": 0.9718050360679626,
        "recall": 0.9748876690864563,
        "f1-score": 0.9733439087867737,
        "specificity": 0.9968365430831909
    },
    "Normal": {
        "precision": 0.9556558728218079,
        "recall": 0.9394413828849792,
        "f1-score": 0.947479248046875,
        "specificity": 0.9950556755065918
    },
    "Polyp": {
        "precision": 0.9389683604240417,
        "recall": 0.9440308213233948,
        "f1-score": 0.9414927959442139,
        "specificity": 0.9929105639457703
    },
    "Ulcer": {
        "precision": 0.9940572381019592,
        "recall": 0.9935204982757568,
        "f1-score": 0.9937888383865356,
        "specificity": 0.9993510842323303
    },
    "Worms": {
        "precision": 0.9973024129867554,
        "recall": 0.9973024129867554,
        "f1-score": 0.9973024129867554,
        "specificity": 0.9997050166130066
    },
    "accuracy": 0.9565240740776062,
    "macro avg": {
        "precision": 0.9564942717552185,
        "recall": 0.9565417170524597,
        "f1-score": 0.9564995169639587,
        "specificity": 0.9951688647270203
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9989540576934814,
        "Bleeding": 0.9994344711303711,
        "Erosion": 0.9937292337417603,
        "Erythema": 0.9980483651161194,
        "Foreign Body": 0.9996134638786316,
        "Lymphangiectasia": 0.9995976686477661,
        "Normal": 0.9968115091323853,
        "Polyp": 0.9984409213066101,
        "Ulcer": 0.9999802708625793,
        "Worms": 0.9999954700469971
    },
    "average_precision_scores": {
        "Angioectasia": 0.9921326041221619,
        "Bleeding": 0.9950862526893616,
        "Erosion": 0.9565709829330444,
        "Erythema": 0.982221245765686,
        "Foreign Body": 0.9968262314796448,
        "Lymphangiectasia": 0.9968621134757996,
        "Normal": 0.9841678738594055,
        "Polyp": 0.9874396920204163,
        "Ulcer": 0.9998219013214111,
        "Worms": 0.9999575614929199
    },
    "mean_auc": 0.998460590839386,
    "mean_average_precision": 0.989108681678772
}
2024-10-15 05:47:56,432 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7051509618759155,
        "recall": 0.7987927794456482,
        "f1-score": 0.7490565776824951,
        "specificity": 0.989382803440094
    },
    "Bleeding": {
        "precision": 0.7553957104682922,
        "recall": 0.8774373531341553,
        "f1-score": 0.811855673789978,
        "specificity": 0.9935332536697388
    },
    "Erosion": {
        "precision": 0.6698564887046814,
        "recall": 0.7272727489471436,
        "f1-score": 0.6973848342895508,
        "specificity": 0.9723576307296753
    },
    "Erythema": {
        "precision": 0.5529801249504089,
        "recall": 0.5622895359992981,
        "f1-score": 0.55759596824646,
        "specificity": 0.9914745688438416
    },
    "Foreign Body": {
        "precision": 0.8351648449897766,
        "recall": 0.8941176533699036,
        "f1-score": 0.8636363744735718,
        "specificity": 0.9962006211280823
    },
    "Lymphangiectasia": {
        "precision": 0.8142856955528259,
        "recall": 0.8309037685394287,
        "f1-score": 0.822510838508606,
        "specificity": 0.9958832263946533
    },
    "Normal": {
        "precision": 0.982993483543396,
        "recall": 0.9455522298812866,
        "f1-score": 0.963909387588501,
        "specificity": 0.9477243423461914
    },
    "Polyp": {
        "precision": 0.5732283592224121,
        "recall": 0.7279999852180481,
        "f1-score": 0.641409695148468,
        "specificity": 0.9826637506484985
    },
    "Ulcer": {
        "precision": 0.9515570998191833,
        "recall": 0.9615384340286255,
        "f1-score": 0.95652174949646,
        "specificity": 0.9991164803504944
    },
    "Worms": {
        "precision": 0.4892086386680603,
        "recall": 1.0,
        "f1-score": 0.6570048332214355,
        "specificity": 0.9955801963806152
    },
    "accuracy": 0.9070791006088257,
    "macro avg": {
        "precision": 0.7329820990562439,
        "recall": 0.8325905203819275,
        "f1-score": 0.7720885872840881,
        "specificity": 0.9863916635513306
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9647568464279175,
        "Bleeding": 0.9892903566360474,
        "Erosion": 0.9653743505477905,
        "Erythema": 0.9667143821716309,
        "Foreign Body": 0.9928560256958008,
        "Lymphangiectasia": 0.9919353723526001,
        "Normal": 0.9899115562438965,
        "Polyp": 0.9794443845748901,
        "Ulcer": 0.998909056186676,
        "Worms": 0.9999825954437256
    },
    "average_precision_scores": {
        "Angioectasia": 0.8281657099723816,
        "Bleeding": 0.9004690051078796,
        "Erosion": 0.7776995897293091,
        "Erythema": 0.5878746509552002,
        "Foreign Body": 0.9337540864944458,
        "Lymphangiectasia": 0.8998802900314331,
        "Normal": 0.9968039393424988,
        "Polyp": 0.7086765766143799,
        "Ulcer": 0.9769617319107056,
        "Worms": 0.9965686798095703
    },
    "mean_auc": 0.9839175343513489,
    "mean_average_precision": 0.8606854677200317
}
2024-10-15 05:47:56,433 - BEiT - INFO - Epoch: 10 | train_loss: 0.0523 | train_acc: 0.9565 | test_loss: 0.1656 | test_acc: 0.9071
2024-10-15 05:47:57,115 - BEiT - INFO - Best model saved with mean AUC score: 0.9839 at epoch 10
2024-10-15 06:01:45,487 - BEiT - INFO - Epoch: 11
2024-10-15 06:01:45,488 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9555262923240662,
        "recall": 0.9537693858146667,
        "f1-score": 0.9546470642089844,
        "specificity": 0.9950000047683716
    },
    "Bleeding": {
        "precision": 0.9564304351806641,
        "recall": 0.9655537605285645,
        "f1-score": 0.9609704613685608,
        "specificity": 0.9950935244560242
    },
    "Erosion": {
        "precision": 0.8958389759063721,
        "recall": 0.8840579986572266,
        "f1-score": 0.8899095058441162,
        "specificity": 0.9886957406997681
    },
    "Erythema": {
        "precision": 0.9347996711730957,
        "recall": 0.9422011375427246,
        "f1-score": 0.9384858012199402,
        "specificity": 0.992637038230896
    },
    "Foreign Body": {
        "precision": 0.9689119458198547,
        "recall": 0.9718271493911743,
        "f1-score": 0.9703673124313354,
        "specificity": 0.9966422319412231
    },
    "Lymphangiectasia": {
        "precision": 0.9783741235733032,
        "recall": 0.9740596413612366,
        "f1-score": 0.9762121438980103,
        "specificity": 0.9975408911705017
    },
    "Normal": {
        "precision": 0.9532052874565125,
        "recall": 0.9414907693862915,
        "f1-score": 0.9473118185997009,
        "specificity": 0.994891345500946
    },
    "Polyp": {
        "precision": 0.945184051990509,
        "recall": 0.9546533226966858,
        "f1-score": 0.9498950839042664,
        "specificity": 0.993789553642273
    },
    "Ulcer": {
        "precision": 0.9951087236404419,
        "recall": 0.9951087236404419,
        "f1-score": 0.9951087236404419,
        "specificity": 0.9994694590568542
    },
    "Worms": {
        "precision": 0.9963040947914124,
        "recall": 0.9973573088645935,
        "f1-score": 0.996830403804779,
        "specificity": 0.9995861053466797
    },
    "accuracy": 0.958013117313385,
    "macro avg": {
        "precision": 0.9579683542251587,
        "recall": 0.9580079913139343,
        "f1-score": 0.9579738974571228,
        "specificity": 0.9953346252441406
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9990888833999634,
        "Bleeding": 0.9994455575942993,
        "Erosion": 0.9941182732582092,
        "Erythema": 0.9985714554786682,
        "Foreign Body": 0.9996604919433594,
        "Lymphangiectasia": 0.999630331993103,
        "Normal": 0.9976862072944641,
        "Polyp": 0.9988318681716919,
        "Ulcer": 0.9999793767929077,
        "Worms": 0.9999964237213135
    },
    "average_precision_scores": {
        "Angioectasia": 0.9927897453308105,
        "Bleeding": 0.995194673538208,
        "Erosion": 0.959686279296875,
        "Erythema": 0.9870963096618652,
        "Foreign Body": 0.9970695376396179,
        "Lymphangiectasia": 0.997283399105072,
        "Normal": 0.9859205484390259,
        "Polyp": 0.9901947975158691,
        "Ulcer": 0.9998041391372681,
        "Worms": 0.9999682903289795
    },
    "mean_auc": 0.9987009167671204,
    "mean_average_precision": 0.9905007481575012
}
2024-10-15 06:01:45,490 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7181817889213562,
        "recall": 0.7947686314582825,
        "f1-score": 0.7545367479324341,
        "specificity": 0.9900863170623779
    },
    "Bleeding": {
        "precision": 0.7535211443901062,
        "recall": 0.89415043592453,
        "f1-score": 0.8178343772888184,
        "specificity": 0.9933430552482605
    },
    "Erosion": {
        "precision": 0.643227219581604,
        "recall": 0.7523809671401978,
        "f1-score": 0.6935355067253113,
        "specificity": 0.9678173065185547
    },
    "Erythema": {
        "precision": 0.4976303279399872,
        "recall": 0.7070707082748413,
        "f1-score": 0.584144651889801,
        "specificity": 0.9866119623184204
    },
    "Foreign Body": {
        "precision": 0.8717201352119446,
        "recall": 0.8794117569923401,
        "f1-score": 0.8755490779876709,
        "specificity": 0.9972137808799744
    },
    "Lymphangiectasia": {
        "precision": 0.860534131526947,
        "recall": 0.8454810380935669,
        "f1-score": 0.8529411554336548,
        "specificity": 0.9970232248306274
    },
    "Normal": {
        "precision": 0.988538920879364,
        "recall": 0.9476682543754578,
        "f1-score": 0.9676722288131714,
        "specificity": 0.9648894667625427
    },
    "Polyp": {
        "precision": 0.6433961987495422,
        "recall": 0.6819999814033508,
        "f1-score": 0.662135899066925,
        "specificity": 0.9879094362258911
    },
    "Ulcer": {
        "precision": 0.8971061110496521,
        "recall": 0.9755244851112366,
        "f1-score": 0.9346733689308167,
        "specificity": 0.997980535030365
    },
    "Worms": {
        "precision": 0.8072289228439331,
        "recall": 0.9852941036224365,
        "f1-score": 0.887417197227478,
        "specificity": 0.9990040063858032
    },
    "accuracy": 0.912162184715271,
    "macro avg": {
        "precision": 0.7681084871292114,
        "recall": 0.8463751077651978,
        "f1-score": 0.8030440211296082,
        "specificity": 0.9881879091262817
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9775083065032959,
        "Bleeding": 0.9925340414047241,
        "Erosion": 0.9667485952377319,
        "Erythema": 0.9822491407394409,
        "Foreign Body": 0.9887775182723999,
        "Lymphangiectasia": 0.9892555475234985,
        "Normal": 0.9911439418792725,
        "Polyp": 0.9782689213752747,
        "Ulcer": 0.9993261098861694,
        "Worms": 0.9999807476997375
    },
    "average_precision_scores": {
        "Angioectasia": 0.8485615253448486,
        "Bleeding": 0.924595296382904,
        "Erosion": 0.7767892479896545,
        "Erythema": 0.6385093331336975,
        "Foreign Body": 0.9394025206565857,
        "Lymphangiectasia": 0.9111003875732422,
        "Normal": 0.99725741147995,
        "Polyp": 0.7262119054794312,
        "Ulcer": 0.9861680269241333,
        "Worms": 0.9958527684211731
    },
    "mean_auc": 0.9865793585777283,
    "mean_average_precision": 0.8744447827339172
}
2024-10-15 06:01:45,491 - BEiT - INFO - Epoch: 11 | train_loss: 0.0479 | train_acc: 0.9580 | test_loss: 0.1629 | test_acc: 0.9122
2024-10-15 06:01:46,191 - BEiT - INFO - Best model saved with mean AUC score: 0.9866 at epoch 11
2024-10-15 06:15:34,501 - BEiT - INFO - Epoch: 12
2024-10-15 06:15:34,502 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9655540585517883,
        "recall": 0.9645238518714905,
        "f1-score": 0.9650387167930603,
        "specificity": 0.9961899518966675
    },
    "Bleeding": {
        "precision": 0.9627394676208496,
        "recall": 0.9688407778739929,
        "f1-score": 0.96578049659729,
        "specificity": 0.9958013296127319
    },
    "Erosion": {
        "precision": 0.9080614447593689,
        "recall": 0.8936057090759277,
        "f1-score": 0.9007756114006042,
        "specificity": 0.9899225831031799
    },
    "Erythema": {
        "precision": 0.9353910684585571,
        "recall": 0.9515699744224548,
        "f1-score": 0.9434111714363098,
        "specificity": 0.9927029013633728
    },
    "Foreign Body": {
        "precision": 0.9722222089767456,
        "recall": 0.973738968372345,
        "f1-score": 0.9729800224304199,
        "specificity": 0.9968306422233582
    },
    "Lymphangiectasia": {
        "precision": 0.9750000238418579,
        "recall": 0.9731882214546204,
        "f1-score": 0.9740932583808899,
        "specificity": 0.9972222447395325
    },
    "Normal": {
        "precision": 0.9603906869888306,
        "recall": 0.9498255848884583,
        "f1-score": 0.9550788998603821,
        "specificity": 0.995690643787384
    },
    "Polyp": {
        "precision": 0.9472983479499817,
        "recall": 0.9526231288909912,
        "f1-score": 0.9499533176422119,
        "specificity": 0.9941542744636536
    },
    "Ulcer": {
        "precision": 0.9989434480667114,
        "recall": 0.9978891611099243,
        "f1-score": 0.9984160661697388,
        "specificity": 0.9998817443847656
    },
    "Worms": {
        "precision": 0.9989124536514282,
        "recall": 0.9989124536514282,
        "f1-score": 0.9989124536514282,
        "specificity": 0.9998821020126343
    },
    "accuracy": 0.9624537825584412,
    "macro avg": {
        "precision": 0.9624513983726501,
        "recall": 0.9624717831611633,
        "f1-score": 0.962444007396698,
        "specificity": 0.995827853679657
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9993877410888672,
        "Bleeding": 0.9995565414428711,
        "Erosion": 0.9956237077713013,
        "Erythema": 0.998645007610321,
        "Foreign Body": 0.9996768832206726,
        "Lymphangiectasia": 0.9996895790100098,
        "Normal": 0.998381495475769,
        "Polyp": 0.998790979385376,
        "Ulcer": 0.9999943375587463,
        "Worms": 0.9999995231628418
    },
    "average_precision_scores": {
        "Angioectasia": 0.9953716993331909,
        "Bleeding": 0.9961545467376709,
        "Erosion": 0.9694281220436096,
        "Erythema": 0.9878314733505249,
        "Foreign Body": 0.9974857568740845,
        "Lymphangiectasia": 0.9975367188453674,
        "Normal": 0.9898379445075989,
        "Polyp": 0.9897476434707642,
        "Ulcer": 0.9999521374702454,
        "Worms": 0.9999955892562866
    },
    "mean_auc": 0.998974621295929,
    "mean_average_precision": 0.9923341870307922
}
2024-10-15 06:15:34,505 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.8244444727897644,
        "recall": 0.7464788556098938,
        "f1-score": 0.7835268974304199,
        "specificity": 0.9949472546577454
    },
    "Bleeding": {
        "precision": 0.7075892686843872,
        "recall": 0.8830083608627319,
        "f1-score": 0.7856257557868958,
        "specificity": 0.9916946887969971
    },
    "Erosion": {
        "precision": 0.6901172399520874,
        "recall": 0.7134199142456055,
        "f1-score": 0.7015751600265503,
        "specificity": 0.9752954244613647
    },
    "Erythema": {
        "precision": 0.5710227489471436,
        "recall": 0.6767676472663879,
        "f1-score": 0.6194145083427429,
        "specificity": 0.9904641509056091
    },
    "Foreign Body": {
        "precision": 0.8333333134651184,
        "recall": 0.8823529481887817,
        "f1-score": 0.8571428656578064,
        "specificity": 0.9962006211280823
    },
    "Lymphangiectasia": {
        "precision": 0.537800669670105,
        "recall": 0.9125364422798157,
        "f1-score": 0.676756739616394,
        "specificity": 0.9829628467559814
    },
    "Normal": {
        "precision": 0.9827147722244263,
        "recall": 0.9439244866371155,
        "f1-score": 0.9629291296005249,
        "specificity": 0.9469440579414368
    },
    "Polyp": {
        "precision": 0.6026936173439026,
        "recall": 0.7160000205039978,
        "f1-score": 0.6544789671897888,
        "specificity": 0.9849027395248413
    },
    "Ulcer": {
        "precision": 0.971731424331665,
        "recall": 0.9615384340286255,
        "f1-score": 0.9666081070899963,
        "specificity": 0.9994951486587524
    },
    "Worms": {
        "precision": 0.9701492786407471,
        "recall": 0.9558823704719543,
        "f1-score": 0.9629629850387573,
        "specificity": 0.9998754858970642
    },
    "accuracy": 0.9063972234725952,
    "macro avg": {
        "precision": 0.769159734249115,
        "recall": 0.8391909599304199,
        "f1-score": 0.797102153301239,
        "specificity": 0.986278235912323
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9700940847396851,
        "Bleeding": 0.9907888770103455,
        "Erosion": 0.974026083946228,
        "Erythema": 0.9797674417495728,
        "Foreign Body": 0.9913509488105774,
        "Lymphangiectasia": 0.9880279302597046,
        "Normal": 0.9888814091682434,
        "Polyp": 0.9789727330207825,
        "Ulcer": 0.9994088411331177,
        "Worms": 0.9999871253967285
    },
    "average_precision_scores": {
        "Angioectasia": 0.8431814908981323,
        "Bleeding": 0.9149185419082642,
        "Erosion": 0.7877591848373413,
        "Erythema": 0.630725622177124,
        "Foreign Body": 0.9319010972976685,
        "Lymphangiectasia": 0.9020571708679199,
        "Normal": 0.9965271949768066,
        "Polyp": 0.7141069173812866,
        "Ulcer": 0.9885551333427429,
        "Worms": 0.9971992373466492
    },
    "mean_auc": 0.9861305356025696,
    "mean_average_precision": 0.8706932067871094
}
2024-10-15 06:15:34,505 - BEiT - INFO - Epoch: 12 | train_loss: 0.0419 | train_acc: 0.9625 | test_loss: 0.1719 | test_acc: 0.9064
2024-10-15 06:15:34,506 - BEiT - INFO - No improvement for 1 consecutive epochs.
2024-10-15 06:29:22,442 - BEiT - INFO - Epoch: 13
2024-10-15 06:29:22,444 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9706120491027832,
        "recall": 0.9672219157218933,
        "f1-score": 0.9689140319824219,
        "specificity": 0.9967832565307617
    },
    "Bleeding": {
        "precision": 0.964036226272583,
        "recall": 0.9751374125480652,
        "f1-score": 0.9695550203323364,
        "specificity": 0.9958858489990234
    },
    "Erosion": {
        "precision": 0.9228502511978149,
        "recall": 0.9130665063858032,
        "f1-score": 0.9179323315620422,
        "specificity": 0.9914878606796265
    },
    "Erythema": {
        "precision": 0.9414865374565125,
        "recall": 0.9540598392486572,
        "f1-score": 0.9477314949035645,
        "specificity": 0.9934441447257996
    },
    "Foreign Body": {
        "precision": 0.9735134840011597,
        "recall": 0.9764163494110107,
        "f1-score": 0.9749627709388733,
        "specificity": 0.9971106648445129
    },
    "Lymphangiectasia": {
        "precision": 0.9785004258155823,
        "recall": 0.9769251346588135,
        "f1-score": 0.9777121543884277,
        "specificity": 0.9976387023925781
    },
    "Normal": {
        "precision": 0.9706588387489319,
        "recall": 0.9576315879821777,
        "f1-score": 0.9641011953353882,
        "specificity": 0.9967462420463562
    },
    "Polyp": {
        "precision": 0.9574524164199829,
        "recall": 0.9594809412956238,
        "f1-score": 0.9584656357765198,
        "specificity": 0.9952410459518433
    },
    "Ulcer": {
        "precision": 0.9986723065376282,
        "recall": 0.997612714767456,
        "f1-score": 0.9981422424316406,
        "specificity": 0.9998522400856018
    },
    "Worms": {
        "precision": 0.9986793398857117,
        "recall": 0.9989432096481323,
        "f1-score": 0.9988112449645996,
        "specificity": 0.999852180480957
    },
    "accuracy": 0.9676390290260315,
    "macro avg": {
        "precision": 0.9676462411880493,
        "recall": 0.9676495790481567,
        "f1-score": 0.9676328897476196,
        "specificity": 0.9964041709899902
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9994665384292603,
        "Bleeding": 0.9996121525764465,
        "Erosion": 0.9965736269950867,
        "Erythema": 0.9988983869552612,
        "Foreign Body": 0.9997736215591431,
        "Lymphangiectasia": 0.9997625350952148,
        "Normal": 0.9985572099685669,
        "Polyp": 0.9993279576301575,
        "Ulcer": 0.9999942183494568,
        "Worms": 0.9999992251396179
    },
    "average_precision_scores": {
        "Angioectasia": 0.9959093332290649,
        "Bleeding": 0.9966118335723877,
        "Erosion": 0.9753222465515137,
        "Erythema": 0.9899609684944153,
        "Foreign Body": 0.9980179071426392,
        "Lymphangiectasia": 0.9980398416519165,
        "Normal": 0.9919009208679199,
        "Polyp": 0.9943814277648926,
        "Ulcer": 0.9999498724937439,
        "Worms": 0.9999927878379822
    },
    "mean_auc": 0.9991965293884277,
    "mean_average_precision": 0.9940087199211121
}
2024-10-15 06:29:22,445 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.779296875,
        "recall": 0.8028169274330139,
        "f1-score": 0.7908820509910583,
        "specificity": 0.99277263879776
    },
    "Bleeding": {
        "precision": 0.8365650773048401,
        "recall": 0.8412256240844727,
        "f1-score": 0.8388888835906982,
        "specificity": 0.9962594509124756
    },
    "Erosion": {
        "precision": 0.6766467094421387,
        "recall": 0.7826839685440063,
        "f1-score": 0.7258129119873047,
        "specificity": 0.9711557626724243
    },
    "Erythema": {
        "precision": 0.6019417643547058,
        "recall": 0.6262626051902771,
        "f1-score": 0.6138613820075989,
        "specificity": 0.9922323822975159
    },
    "Foreign Body": {
        "precision": 0.8373983502388,
        "recall": 0.908823549747467,
        "f1-score": 0.871650218963623,
        "specificity": 0.9962006211280823
    },
    "Lymphangiectasia": {
        "precision": 0.8135135173797607,
        "recall": 0.8775510191917419,
        "f1-score": 0.844319760799408,
        "specificity": 0.9956298470497131
    },
    "Normal": {
        "precision": 0.9875497817993164,
        "recall": 0.9489704370498657,
        "f1-score": 0.9678758382797241,
        "specificity": 0.9617685079574585
    },
    "Polyp": {
        "precision": 0.5450704097747803,
        "recall": 0.7739999890327454,
        "f1-score": 0.6396694183349609,
        "specificity": 0.9793372750282288
    },
    "Ulcer": {
        "precision": 0.9551724195480347,
        "recall": 0.9685314893722534,
        "f1-score": 0.9618055820465088,
        "specificity": 0.9991796016693115
    },
    "Worms": {
        "precision": 0.9558823704719543,
        "recall": 0.9558823704719543,
        "f1-score": 0.9558823704719543,
        "specificity": 0.9998132586479187
    },
    "accuracy": 0.9168112874031067,
    "macro avg": {
        "precision": 0.79890376329422,
        "recall": 0.8486747741699219,
        "f1-score": 0.8210648894309998,
        "specificity": 0.9884349703788757
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9735783338546753,
        "Bleeding": 0.9925147891044617,
        "Erosion": 0.9722457528114319,
        "Erythema": 0.9799414873123169,
        "Foreign Body": 0.9910188913345337,
        "Lymphangiectasia": 0.9892970323562622,
        "Normal": 0.9924143552780151,
        "Polyp": 0.9787026643753052,
        "Ulcer": 0.9994413256645203,
        "Worms": 0.9999889731407166
    },
    "average_precision_scores": {
        "Angioectasia": 0.8601056337356567,
        "Bleeding": 0.921718180179596,
        "Erosion": 0.809989869594574,
        "Erythema": 0.62680983543396,
        "Foreign Body": 0.938947319984436,
        "Lymphangiectasia": 0.9071540236473083,
        "Normal": 0.9976373314857483,
        "Polyp": 0.7323473691940308,
        "Ulcer": 0.9875237941741943,
        "Worms": 0.9974923133850098
    },
    "mean_auc": 0.986914336681366,
    "mean_average_precision": 0.8779726028442383
}
2024-10-15 06:29:22,446 - BEiT - INFO - Epoch: 13 | train_loss: 0.0354 | train_acc: 0.9676 | test_loss: 0.1512 | test_acc: 0.9168
2024-10-15 06:29:23,139 - BEiT - INFO - Best model saved with mean AUC score: 0.9869 at epoch 13
2024-10-15 06:43:11,020 - BEiT - INFO - Epoch: 14
2024-10-15 06:43:11,022 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9713006615638733,
        "recall": 0.9690044522285461,
        "f1-score": 0.9701512455940247,
        "specificity": 0.9967751502990723
    },
    "Bleeding": {
        "precision": 0.9601107835769653,
        "recall": 0.9708683490753174,
        "f1-score": 0.9654595851898193,
        "specificity": 0.9957693219184875
    },
    "Erosion": {
        "precision": 0.9342140555381775,
        "recall": 0.9188544154167175,
        "f1-score": 0.9264705777168274,
        "specificity": 0.9927887320518494
    },
    "Erythema": {
        "precision": 0.9433198571205139,
        "recall": 0.9609568119049072,
        "f1-score": 0.9520566463470459,
        "specificity": 0.9938181042671204
    },
    "Foreign Body": {
        "precision": 0.9784858226776123,
        "recall": 0.9784858226776123,
        "f1-score": 0.9784858226776123,
        "specificity": 0.9976720213890076
    },
    "Lymphangiectasia": {
        "precision": 0.9813746213912964,
        "recall": 0.9806028604507446,
        "f1-score": 0.980988621711731,
        "specificity": 0.9978989362716675
    },
    "Normal": {
        "precision": 0.9751520156860352,
        "recall": 0.9626826643943787,
        "f1-score": 0.9688771963119507,
        "specificity": 0.9972168803215027
    },
    "Polyp": {
        "precision": 0.9594736695289612,
        "recall": 0.9630216360092163,
        "f1-score": 0.9612444043159485,
        "specificity": 0.9954466223716736
    },
    "Ulcer": {
        "precision": 0.9987123608589172,
        "recall": 0.9984552264213562,
        "f1-score": 0.9985837340354919,
        "specificity": 0.9998517036437988
    },
    "Worms": {
        "precision": 0.9989569783210754,
        "recall": 0.9994782209396362,
        "f1-score": 0.9992175102233887,
        "specificity": 0.9998815655708313
    },
    "accuracy": 0.9703778624534607,
    "macro avg": {
        "precision": 0.9701101183891296,
        "recall": 0.9702410101890564,
        "f1-score": 0.9701535105705261,
        "specificity": 0.9967119097709656
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9995163679122925,
        "Bleeding": 0.9996185302734375,
        "Erosion": 0.997269868850708,
        "Erythema": 0.999121904373169,
        "Foreign Body": 0.9998140335083008,
        "Lymphangiectasia": 0.9998418092727661,
        "Normal": 0.9986311793327332,
        "Polyp": 0.9994043111801147,
        "Ulcer": 0.9999988675117493,
        "Worms": 0.9999997615814209
    },
    "average_precision_scores": {
        "Angioectasia": 0.9965030550956726,
        "Bleeding": 0.9964770078659058,
        "Erosion": 0.9799461364746094,
        "Erythema": 0.9920070767402649,
        "Foreign Body": 0.9983696341514587,
        "Lymphangiectasia": 0.9987577199935913,
        "Normal": 0.9930500984191895,
        "Polyp": 0.9949468374252319,
        "Ulcer": 0.9999899864196777,
        "Worms": 0.999998152256012
    },
    "mean_auc": 0.9993216395378113,
    "mean_average_precision": 0.9950045943260193
}
2024-10-15 06:43:11,023 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7392120361328125,
        "recall": 0.7927565574645996,
        "f1-score": 0.7650485634803772,
        "specificity": 0.9911096692085266
    },
    "Bleeding": {
        "precision": 0.8403361439704895,
        "recall": 0.835654616355896,
        "f1-score": 0.8379888534545898,
        "specificity": 0.9963862299919128
    },
    "Erosion": {
        "precision": 0.6255172491073608,
        "recall": 0.7852813601493835,
        "f1-score": 0.6963531374931335,
        "specificity": 0.9637444019317627
    },
    "Erythema": {
        "precision": 0.5755627155303955,
        "recall": 0.6026936173439026,
        "f1-score": 0.5888158082962036,
        "specificity": 0.9916640520095825
    },
    "Foreign Body": {
        "precision": 0.8141361474990845,
        "recall": 0.9147058725357056,
        "f1-score": 0.861495852470398,
        "specificity": 0.9955040812492371
    },
    "Lymphangiectasia": {
        "precision": 0.7090069055557251,
        "recall": 0.8950437307357788,
        "f1-score": 0.7912371158599854,
        "specificity": 0.992019772529602
    },
    "Normal": {
        "precision": 0.988986611366272,
        "recall": 0.9427850842475891,
        "f1-score": 0.9653333425521851,
        "specificity": 0.9664499163627625
    },
    "Polyp": {
        "precision": 0.6372881531715393,
        "recall": 0.7519999742507935,
        "f1-score": 0.6899082660675049,
        "specificity": 0.9863101243972778
    },
    "Ulcer": {
        "precision": 0.9751772880554199,
        "recall": 0.9615384340286255,
        "f1-score": 0.9683098793029785,
        "specificity": 0.9995582699775696
    },
    "Worms": {
        "precision": 0.8395061492919922,
        "recall": 1.0,
        "f1-score": 0.9127516746520996,
        "specificity": 0.9991907477378845
    },
    "accuracy": 0.9112943410873413,
    "macro avg": {
        "precision": 0.7744729518890381,
        "recall": 0.8482459187507629,
        "f1-score": 0.8077242970466614,
        "specificity": 0.988193690776825
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9682705402374268,
        "Bleeding": 0.9889204502105713,
        "Erosion": 0.9659392833709717,
        "Erythema": 0.97071373462677,
        "Foreign Body": 0.9891298413276672,
        "Lymphangiectasia": 0.9892420768737793,
        "Normal": 0.9917776584625244,
        "Polyp": 0.9817489981651306,
        "Ulcer": 0.999279797077179,
        "Worms": 0.999983549118042
    },
    "average_precision_scores": {
        "Angioectasia": 0.8372958898544312,
        "Bleeding": 0.9097388982772827,
        "Erosion": 0.795602023601532,
        "Erythema": 0.6100236177444458,
        "Foreign Body": 0.9368229508399963,
        "Lymphangiectasia": 0.9087162017822266,
        "Normal": 0.9974213242530823,
        "Polyp": 0.747388482093811,
        "Ulcer": 0.9909213781356812,
        "Worms": 0.9963412284851074
    },
    "mean_auc": 0.9845005869865417,
    "mean_average_precision": 0.8730272650718689
}
2024-10-15 06:43:11,024 - BEiT - INFO - Epoch: 14 | train_loss: 0.0320 | train_acc: 0.9704 | test_loss: 0.1633 | test_acc: 0.9113
2024-10-15 06:43:11,025 - BEiT - INFO - No improvement for 1 consecutive epochs.
2024-10-15 06:56:59,380 - BEiT - INFO - Epoch: 15
2024-10-15 06:56:59,382 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9733086824417114,
        "recall": 0.9748544096946716,
        "f1-score": 0.9740809202194214,
        "specificity": 0.9970144033432007
    },
    "Bleeding": {
        "precision": 0.9650879502296448,
        "recall": 0.9756497740745544,
        "f1-score": 0.9703401327133179,
        "specificity": 0.9962005019187927
    },
    "Erosion": {
        "precision": 0.9442657828330994,
        "recall": 0.9198642373085022,
        "f1-score": 0.9319053292274475,
        "specificity": 0.9938417673110962
    },
    "Erythema": {
        "precision": 0.9506365060806274,
        "recall": 0.9623882174491882,
        "f1-score": 0.9564762711524963,
        "specificity": 0.9943795204162598
    },
    "Foreign Body": {
        "precision": 0.9746367335319519,
        "recall": 0.9816391468048096,
        "f1-score": 0.9781253933906555,
        "specificity": 0.9971638917922974
    },
    "Lymphangiectasia": {
        "precision": 0.9838067293167114,
        "recall": 0.9812020063400269,
        "f1-score": 0.9825026392936707,
        "specificity": 0.9981968402862549
    },
    "Normal": {
        "precision": 0.9782140851020813,
        "recall": 0.97142094373703,
        "f1-score": 0.9748056530952454,
        "specificity": 0.9976080060005188
    },
    "Polyp": {
        "precision": 0.9658730030059814,
        "recall": 0.9697211384773254,
        "f1-score": 0.9677932262420654,
        "specificity": 0.9961881637573242
    },
    "Ulcer": {
        "precision": 0.9983978867530823,
        "recall": 0.9983978867530823,
        "f1-score": 0.9983978867530823,
        "specificity": 0.9998227953910828
    },
    "Worms": {
        "precision": 0.9992004036903381,
        "recall": 0.9992004036903381,
        "f1-score": 0.9992004036903381,
        "specificity": 0.999911367893219
    },
    "accuracy": 0.9733028411865234,
    "macro avg": {
        "precision": 0.9733428359031677,
        "recall": 0.973433792591095,
        "f1-score": 0.9733627438545227,
        "specificity": 0.9970327615737915
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9997719526290894,
        "Bleeding": 0.9997111558914185,
        "Erosion": 0.9976917505264282,
        "Erythema": 0.9992890357971191,
        "Foreign Body": 0.9998279213905334,
        "Lymphangiectasia": 0.9998720288276672,
        "Normal": 0.999192476272583,
        "Polyp": 0.9995495080947876,
        "Ulcer": 0.9999974966049194,
        "Worms": 0.9999994039535522
    },
    "average_precision_scores": {
        "Angioectasia": 0.9980781078338623,
        "Bleeding": 0.9973109364509583,
        "Erosion": 0.9835854172706604,
        "Erythema": 0.9937490224838257,
        "Foreign Body": 0.9985555410385132,
        "Lymphangiectasia": 0.9989550113677979,
        "Normal": 0.9952150583267212,
        "Polyp": 0.9965553879737854,
        "Ulcer": 0.9999777674674988,
        "Worms": 0.999995231628418
    },
    "mean_auc": 0.9994902610778809,
    "mean_average_precision": 0.9961977005004883
}
2024-10-15 06:56:59,382 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.764595091342926,
        "recall": 0.8169013857841492,
        "f1-score": 0.7898832559585571,
        "specificity": 0.9920051097869873
    },
    "Bleeding": {
        "precision": 0.7969151735305786,
        "recall": 0.8635097742080688,
        "f1-score": 0.8288770318031311,
        "specificity": 0.9949914216995239
    },
    "Erosion": {
        "precision": 0.7284263968467712,
        "recall": 0.7454545497894287,
        "f1-score": 0.7368420958518982,
        "specificity": 0.9785671234130859
    },
    "Erythema": {
        "precision": 0.6000000238418579,
        "recall": 0.6161616444587708,
        "f1-score": 0.6079733967781067,
        "specificity": 0.9922955632209778
    },
    "Foreign Body": {
        "precision": 0.8714285492897034,
        "recall": 0.8970588445663452,
        "f1-score": 0.8840579986572266,
        "specificity": 0.9971504807472229
    },
    "Lymphangiectasia": {
        "precision": 0.7957559823989868,
        "recall": 0.8746355772018433,
        "f1-score": 0.8333333134651184,
        "specificity": 0.9951232075691223
    },
    "Normal": {
        "precision": 0.9794808626174927,
        "recall": 0.9673638939857483,
        "f1-score": 0.9733846783638,
        "specificity": 0.9352405667304993
    },
    "Polyp": {
        "precision": 0.7058823704719543,
        "recall": 0.7200000286102295,
        "f1-score": 0.7128713130950928,
        "specificity": 0.9904043078422546
    },
    "Ulcer": {
        "precision": 0.9612675905227661,
        "recall": 0.9545454382896423,
        "f1-score": 0.9578947424888611,
        "specificity": 0.9993058443069458
    },
    "Worms": {
        "precision": 0.9855072498321533,
        "recall": 1.0,
        "f1-score": 0.9927007555961609,
        "specificity": 0.9999377727508545
    },
    "accuracy": 0.9268534779548645,
    "macro avg": {
        "precision": 0.8189259767532349,
        "recall": 0.8455631136894226,
        "f1-score": 0.8317818641662598,
        "specificity": 0.9875020980834961
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9754006862640381,
        "Bleeding": 0.9933532476425171,
        "Erosion": 0.9712367653846741,
        "Erythema": 0.9795496463775635,
        "Foreign Body": 0.9881272315979004,
        "Lymphangiectasia": 0.9898855686187744,
        "Normal": 0.991916835308075,
        "Polyp": 0.9797492027282715,
        "Ulcer": 0.9985153675079346,
        "Worms": 0.9999890327453613
    },
    "average_precision_scores": {
        "Angioectasia": 0.8649771809577942,
        "Bleeding": 0.9136257171630859,
        "Erosion": 0.8132355213165283,
        "Erythema": 0.6240288615226746,
        "Foreign Body": 0.9397375583648682,
        "Lymphangiectasia": 0.9151430130004883,
        "Normal": 0.9974486827850342,
        "Polyp": 0.7633630633354187,
        "Ulcer": 0.9834590554237366,
        "Worms": 0.9972126483917236
    },
    "mean_auc": 0.986772358417511,
    "mean_average_precision": 0.8812231421470642
}
2024-10-15 06:56:59,383 - BEiT - INFO - Epoch: 15 | train_loss: 0.0260 | train_acc: 0.9733 | test_loss: 0.1460 | test_acc: 0.9269
2024-10-15 06:56:59,384 - BEiT - INFO - No improvement for 2 consecutive epochs.
2024-10-15 07:10:47,312 - BEiT - INFO - Epoch: 16
2024-10-15 07:10:47,314 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.972865104675293,
        "recall": 0.9746801853179932,
        "f1-score": 0.9737718105316162,
        "specificity": 0.9969871640205383
    },
    "Bleeding": {
        "precision": 0.9721354246139526,
        "recall": 0.9785059094429016,
        "f1-score": 0.9753102660179138,
        "specificity": 0.9968335628509521
    },
    "Erosion": {
        "precision": 0.9491803050041199,
        "recall": 0.9209968447685242,
        "f1-score": 0.9348762035369873,
        "specificity": 0.9945027232170105
    },
    "Erythema": {
        "precision": 0.9369856119155884,
        "recall": 0.9589365720748901,
        "f1-score": 0.9478340148925781,
        "specificity": 0.9927532076835632
    },
    "Foreign Body": {
        "precision": 0.9798675775527954,
        "recall": 0.9822092652320862,
        "f1-score": 0.9810370206832886,
        "specificity": 0.9977542161941528
    },
    "Lymphangiectasia": {
        "precision": 0.9807846546173096,
        "recall": 0.9823576807975769,
        "f1-score": 0.9815705418586731,
        "specificity": 0.9978739619255066
    },
    "Normal": {
        "precision": 0.9813210368156433,
        "recall": 0.9721105098724365,
        "f1-score": 0.9766940474510193,
        "specificity": 0.9979633092880249
    },
    "Polyp": {
        "precision": 0.9628432989120483,
        "recall": 0.9644013047218323,
        "f1-score": 0.9636216759681702,
        "specificity": 0.9959290623664856
    },
    "Ulcer": {
        "precision": 0.9984076619148254,
        "recall": 0.9994686245918274,
        "f1-score": 0.9989378452301025,
        "specificity": 0.999822735786438
    },
    "Worms": {
        "precision": 0.9994683861732483,
        "recall": 0.999734103679657,
        "f1-score": 0.9996012449264526,
        "specificity": 0.9999409317970276
    },
    "accuracy": 0.9733294248580933,
    "macro avg": {
        "precision": 0.9733859300613403,
        "recall": 0.9733400344848633,
        "f1-score": 0.9733254313468933,
        "specificity": 0.9970360994338989
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9997484683990479,
        "Bleeding": 0.9997653961181641,
        "Erosion": 0.9980047941207886,
        "Erythema": 0.9991594552993774,
        "Foreign Body": 0.9998511672019958,
        "Lymphangiectasia": 0.9998782277107239,
        "Normal": 0.9990513324737549,
        "Polyp": 0.9995366334915161,
        "Ulcer": 0.9999996423721313,
        "Worms": 0.9999999403953552
    },
    "average_precision_scores": {
        "Angioectasia": 0.9978857636451721,
        "Bleeding": 0.9979286789894104,
        "Erosion": 0.984969973564148,
        "Erythema": 0.9925559759140015,
        "Foreign Body": 0.9987597465515137,
        "Lymphangiectasia": 0.9989491701126099,
        "Normal": 0.9957370758056641,
        "Polyp": 0.9958890676498413,
        "Ulcer": 0.999996542930603,
        "Worms": 0.9999991655349731
    },
    "mean_auc": 0.999499499797821,
    "mean_average_precision": 0.9962671399116516
}
2024-10-15 07:10:47,315 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6851851940155029,
        "recall": 0.818913459777832,
        "f1-score": 0.7461044788360596,
        "specificity": 0.9880396723747253
    },
    "Bleeding": {
        "precision": 0.7908163070678711,
        "recall": 0.8635097742080688,
        "f1-score": 0.8255659341812134,
        "specificity": 0.9948012232780457
    },
    "Erosion": {
        "precision": 0.6850699782371521,
        "recall": 0.7627705335617065,
        "f1-score": 0.7218353152275085,
        "specificity": 0.9729585647583008
    },
    "Erythema": {
        "precision": 0.6666666865348816,
        "recall": 0.5925925970077515,
        "f1-score": 0.6274510025978088,
        "specificity": 0.9944427013397217
    },
    "Foreign Body": {
        "precision": 0.8328840732574463,
        "recall": 0.908823549747467,
        "f1-score": 0.8691983222961426,
        "specificity": 0.9960739612579346
    },
    "Lymphangiectasia": {
        "precision": 0.8403361439704895,
        "recall": 0.8746355772018433,
        "f1-score": 0.8571428656578064,
        "specificity": 0.9963898658752441
    },
    "Normal": {
        "precision": 0.98386150598526,
        "recall": 0.9575974345207214,
        "f1-score": 0.9705518484115601,
        "specificity": 0.949804961681366
    },
    "Polyp": {
        "precision": 0.6394315958023071,
        "recall": 0.7200000286102295,
        "f1-score": 0.6773282885551453,
        "specificity": 0.9870138168334961
    },
    "Ulcer": {
        "precision": 0.9821428656578064,
        "recall": 0.9615384340286255,
        "f1-score": 0.971731424331665,
        "specificity": 0.9996844530105591
    },
    "Worms": {
        "precision": 0.9848484992980957,
        "recall": 0.9558823704719543,
        "f1-score": 0.9701492786407471,
        "specificity": 0.9999377727508545
    },
    "accuracy": 0.9204686284065247,
    "macro avg": {
        "precision": 0.8091242909431458,
        "recall": 0.8416263461112976,
        "f1-score": 0.8237058520317078,
        "specificity": 0.9879146814346313
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9756247997283936,
        "Bleeding": 0.9937114119529724,
        "Erosion": 0.9685089588165283,
        "Erythema": 0.979094386100769,
        "Foreign Body": 0.9904955625534058,
        "Lymphangiectasia": 0.9901283979415894,
        "Normal": 0.9922608137130737,
        "Polyp": 0.9795411825180054,
        "Ulcer": 0.9995372891426086,
        "Worms": 0.9999926686286926
    },
    "average_precision_scores": {
        "Angioectasia": 0.8508995771408081,
        "Bleeding": 0.9197873473167419,
        "Erosion": 0.7984281778335571,
        "Erythema": 0.6392199993133545,
        "Foreign Body": 0.9390747547149658,
        "Lymphangiectasia": 0.9055399894714355,
        "Normal": 0.9975781440734863,
        "Polyp": 0.7579259872436523,
        "Ulcer": 0.9872916340827942,
        "Worms": 0.9983158111572266
    },
    "mean_auc": 0.9868895411491394,
    "mean_average_precision": 0.8794061541557312
}
2024-10-15 07:10:47,316 - BEiT - INFO - Epoch: 16 | train_loss: 0.0249 | train_acc: 0.9733 | test_loss: 0.1565 | test_acc: 0.9205
2024-10-15 07:10:47,317 - BEiT - INFO - No improvement for 3 consecutive epochs.
2024-10-15 07:24:35,548 - BEiT - INFO - Epoch: 17
2024-10-15 07:24:35,549 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9795060157775879,
        "recall": 0.976427435874939,
        "f1-score": 0.9779643416404724,
        "specificity": 0.9976915717124939
    },
    "Bleeding": {
        "precision": 0.9687983393669128,
        "recall": 0.9804279804229736,
        "f1-score": 0.9745784401893616,
        "specificity": 0.9964174628257751
    },
    "Erosion": {
        "precision": 0.9554756879806519,
        "recall": 0.9285138249397278,
        "f1-score": 0.9418018460273743,
        "specificity": 0.9952487945556641
    },
    "Erythema": {
        "precision": 0.9537060856819153,
        "recall": 0.9713907241821289,
        "f1-score": 0.9624671936035156,
        "specificity": 0.9947386980056763
    },
    "Foreign Body": {
        "precision": 0.9741746783256531,
        "recall": 0.986785352230072,
        "f1-score": 0.9804394245147705,
        "specificity": 0.9971385598182678
    },
    "Lymphangiectasia": {
        "precision": 0.9827491641044617,
        "recall": 0.9827491641044617,
        "f1-score": 0.9827491641044617,
        "specificity": 0.9981446266174316
    },
    "Normal": {
        "precision": 0.9886842370033264,
        "recall": 0.975844144821167,
        "f1-score": 0.9822221994400024,
        "specificity": 0.9987261891365051
    },
    "Polyp": {
        "precision": 0.9702267050743103,
        "recall": 0.9710224270820618,
        "f1-score": 0.9706243872642517,
        "specificity": 0.996789276599884
    },
    "Ulcer": {
        "precision": 0.9997369647026062,
        "recall": 0.9997369647026062,
        "f1-score": 0.9997369647026062,
        "specificity": 0.9999704360961914
    },
    "Worms": {
        "precision": 0.9992086291313171,
        "recall": 0.9992086291313171,
        "f1-score": 0.9992086291313171,
        "specificity": 0.9999113082885742
    },
    "accuracy": 0.977291464805603,
    "macro avg": {
        "precision": 0.9772266745567322,
        "recall": 0.9772106409072876,
        "f1-score": 0.9771793484687805,
        "specificity": 0.9974777102470398
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9997667670249939,
        "Bleeding": 0.9997697472572327,
        "Erosion": 0.9984080791473389,
        "Erythema": 0.9995278120040894,
        "Foreign Body": 0.9998602867126465,
        "Lymphangiectasia": 0.9999040961265564,
        "Normal": 0.9993706345558167,
        "Polyp": 0.9996588826179504,
        "Ulcer": 1.0,
        "Worms": 0.9999992847442627
    },
    "average_precision_scores": {
        "Angioectasia": 0.9981067180633545,
        "Bleeding": 0.9979915618896484,
        "Erosion": 0.9874845743179321,
        "Erythema": 0.9957761764526367,
        "Foreign Body": 0.9987277984619141,
        "Lymphangiectasia": 0.9991395473480225,
        "Normal": 0.9965989589691162,
        "Polyp": 0.9969716668128967,
        "Ulcer": 0.9999998211860657,
        "Worms": 0.9999933242797852
    },
    "mean_auc": 0.9996265769004822,
    "mean_average_precision": 0.9970790147781372
}
2024-10-15 07:24:35,551 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.8155737519264221,
        "recall": 0.800804853439331,
        "f1-score": 0.8081218004226685,
        "specificity": 0.9942436814308167
    },
    "Bleeding": {
        "precision": 0.851123571395874,
        "recall": 0.844011127948761,
        "f1-score": 0.8475524187088013,
        "specificity": 0.9966398477554321
    },
    "Erosion": {
        "precision": 0.7443609237670898,
        "recall": 0.7714285850524902,
        "f1-score": 0.7576530575752258,
        "specificity": 0.9795686602592468
    },
    "Erythema": {
        "precision": 0.6406779885292053,
        "recall": 0.6363636255264282,
        "f1-score": 0.6385135054588318,
        "specificity": 0.9933059811592102
    },
    "Foreign Body": {
        "precision": 0.9020771384239197,
        "recall": 0.8941176533699036,
        "f1-score": 0.8980797529220581,
        "specificity": 0.9979103207588196
    },
    "Lymphangiectasia": {
        "precision": 0.9082278609275818,
        "recall": 0.8367347121238708,
        "f1-score": 0.8710166811943054,
        "specificity": 0.9981632828712463
    },
    "Normal": {
        "precision": 0.9775280952453613,
        "recall": 0.9771302938461304,
        "f1-score": 0.9773291349411011,
        "specificity": 0.9282184839248657
    },
    "Polyp": {
        "precision": 0.6867704391479492,
        "recall": 0.7059999704360962,
        "f1-score": 0.6962524652481079,
        "specificity": 0.9897006154060364
    },
    "Ulcer": {
        "precision": 0.9751772880554199,
        "recall": 0.9615384340286255,
        "f1-score": 0.9683098793029785,
        "specificity": 0.9995582699775696
    },
    "Worms": {
        "precision": 1.0,
        "recall": 0.9558823704719543,
        "f1-score": 0.9774436354637146,
        "specificity": 1.0
    },
    "accuracy": 0.9342300891876221,
    "macro avg": {
        "precision": 0.8501517176628113,
        "recall": 0.8384011387825012,
        "f1-score": 0.8440271615982056,
        "specificity": 0.9877309799194336
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9779056906700134,
        "Bleeding": 0.9915240406990051,
        "Erosion": 0.9756718873977661,
        "Erythema": 0.9821975231170654,
        "Foreign Body": 0.9919028282165527,
        "Lymphangiectasia": 0.9914238452911377,
        "Normal": 0.9934539794921875,
        "Polyp": 0.9802571535110474,
        "Ulcer": 0.9993100166320801,
        "Worms": 1.0
    },
    "average_precision_scores": {
        "Angioectasia": 0.8706257343292236,
        "Bleeding": 0.9069846868515015,
        "Erosion": 0.8209203481674194,
        "Erythema": 0.6392454504966736,
        "Foreign Body": 0.945137619972229,
        "Lymphangiectasia": 0.9252591729164124,
        "Normal": 0.9979530572891235,
        "Polyp": 0.7572712302207947,
        "Ulcer": 0.9866504669189453,
        "Worms": 1.0
    },
    "mean_auc": 0.9883646965026855,
    "mean_average_precision": 0.8850046992301941
}
2024-10-15 07:24:35,552 - BEiT - INFO - Epoch: 17 | train_loss: 0.0211 | train_acc: 0.9773 | test_loss: 0.1404 | test_acc: 0.9342
2024-10-15 07:24:36,263 - BEiT - INFO - Best model saved with mean AUC score: 0.9884 at epoch 17
2024-10-15 07:38:24,838 - BEiT - INFO - Epoch: 18
2024-10-15 07:38:24,840 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9798164963722229,
        "recall": 0.9772549271583557,
        "f1-score": 0.9785340428352356,
        "specificity": 0.9977206587791443
    },
    "Bleeding": {
        "precision": 0.9743040800094604,
        "recall": 0.9835179448127747,
        "f1-score": 0.9788893461227417,
        "specificity": 0.9971686601638794
    },
    "Erosion": {
        "precision": 0.961090624332428,
        "recall": 0.9220708608627319,
        "f1-score": 0.9411764740943909,
        "specificity": 0.9959630966186523
    },
    "Erythema": {
        "precision": 0.9412070512771606,
        "recall": 0.9694533944129944,
        "f1-score": 0.9551214575767517,
        "specificity": 0.9933283925056458
    },
    "Foreign Body": {
        "precision": 0.9728471636772156,
        "recall": 0.9817327857017517,
        "f1-score": 0.9772697687149048,
        "specificity": 0.99689120054245
    },
    "Lymphangiectasia": {
        "precision": 0.9834268689155579,
        "recall": 0.9836898446083069,
        "f1-score": 0.9835583567619324,
        "specificity": 0.9981693029403687
    },
    "Normal": {
        "precision": 0.9854799509048462,
        "recall": 0.9817841053009033,
        "f1-score": 0.9836285710334778,
        "specificity": 0.9984058737754822
    },
    "Polyp": {
        "precision": 0.9711823463439941,
        "recall": 0.9688339829444885,
        "f1-score": 0.9700067043304443,
        "specificity": 0.9968422651290894
    },
    "Ulcer": {
        "precision": 0.9994828104972839,
        "recall": 0.9997413158416748,
        "f1-score": 0.999612033367157,
        "specificity": 0.9999407529830933
    },
    "Worms": {
        "precision": 1.0,
        "recall": 0.9994717240333557,
        "f1-score": 0.9997357726097107,
        "specificity": 1.0
    },
    "accuracy": 0.9769724011421204,
    "macro avg": {
        "precision": 0.9768837094306946,
        "recall": 0.9767550826072693,
        "f1-score": 0.9767532348632812,
        "specificity": 0.9974430203437805
    },
    "auc_roc_scores": {
        "Angioectasia": 0.999838650226593,
        "Bleeding": 0.9998258352279663,
        "Erosion": 0.9983557462692261,
        "Erythema": 0.9993720650672913,
        "Foreign Body": 0.9998345375061035,
        "Lymphangiectasia": 0.999904453754425,
        "Normal": 0.99949049949646,
        "Polyp": 0.999725341796875,
        "Ulcer": 0.9999998807907104,
        "Worms": 0.9999998807907104
    },
    "average_precision_scores": {
        "Angioectasia": 0.9985564947128296,
        "Bleeding": 0.9984133243560791,
        "Erosion": 0.9873455762863159,
        "Erythema": 0.9943405389785767,
        "Foreign Body": 0.9985712766647339,
        "Lymphangiectasia": 0.9991648197174072,
        "Normal": 0.9974376559257507,
        "Polyp": 0.9976112246513367,
        "Ulcer": 0.9999990463256836,
        "Worms": 0.9999996423721313
    },
    "mean_auc": 0.9996347427368164,
    "mean_average_precision": 0.9971439242362976
}
2024-10-15 07:38:24,842 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7933070659637451,
        "recall": 0.8108651638031006,
        "f1-score": 0.8019900321960449,
        "specificity": 0.993284285068512
    },
    "Bleeding": {
        "precision": 0.8374655842781067,
        "recall": 0.8467966318130493,
        "f1-score": 0.8421052694320679,
        "specificity": 0.9962594509124756
    },
    "Erosion": {
        "precision": 0.738386332988739,
        "recall": 0.784415602684021,
        "f1-score": 0.760705292224884,
        "specificity": 0.9785671234130859
    },
    "Erythema": {
        "precision": 0.6206896305084229,
        "recall": 0.6060606241226196,
        "f1-score": 0.6132879257202148,
        "specificity": 0.9930533766746521
    },
    "Foreign Body": {
        "precision": 0.8801169395446777,
        "recall": 0.8852941393852234,
        "f1-score": 0.8826979398727417,
        "specificity": 0.9974037408828735
    },
    "Lymphangiectasia": {
        "precision": 0.8430232405662537,
        "recall": 0.8454810380935669,
        "f1-score": 0.8442503809928894,
        "specificity": 0.9965798854827881
    },
    "Normal": {
        "precision": 0.9787982702255249,
        "recall": 0.9731423258781433,
        "f1-score": 0.9759621024131775,
        "specificity": 0.9326397776603699
    },
    "Polyp": {
        "precision": 0.7093495726585388,
        "recall": 0.6980000138282776,
        "f1-score": 0.7036290168762207,
        "specificity": 0.9908521175384521
    },
    "Ulcer": {
        "precision": 0.9751772880554199,
        "recall": 0.9615384340286255,
        "f1-score": 0.9683098793029785,
        "specificity": 0.9995582699775696
    },
    "Worms": {
        "precision": 0.970588207244873,
        "recall": 0.970588207244873,
        "f1-score": 0.970588207244873,
        "specificity": 0.9998754858970642
    },
    "accuracy": 0.9317505359649658,
    "macro avg": {
        "precision": 0.8346902132034302,
        "recall": 0.8382182121276855,
        "f1-score": 0.836352527141571,
        "specificity": 0.9878073930740356
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9759957790374756,
        "Bleeding": 0.9925283789634705,
        "Erosion": 0.9738587141036987,
        "Erythema": 0.9791309833526611,
        "Foreign Body": 0.988365650177002,
        "Lymphangiectasia": 0.9887263178825378,
        "Normal": 0.9933736324310303,
        "Polyp": 0.9807253479957581,
        "Ulcer": 0.9998161792755127,
        "Worms": 0.9999853372573853
    },
    "average_precision_scores": {
        "Angioectasia": 0.8644581437110901,
        "Bleeding": 0.9156113862991333,
        "Erosion": 0.8155055642127991,
        "Erythema": 0.6461913585662842,
        "Foreign Body": 0.9401542544364929,
        "Lymphangiectasia": 0.9020872116088867,
        "Normal": 0.9979268312454224,
        "Polyp": 0.7713744640350342,
        "Ulcer": 0.9919427633285522,
        "Worms": 0.997126042842865
    },
    "mean_auc": 0.9872506260871887,
    "mean_average_precision": 0.8842377662658691
}
2024-10-15 07:38:24,843 - BEiT - INFO - Epoch: 18 | train_loss: 0.0196 | train_acc: 0.9770 | test_loss: 0.1430 | test_acc: 0.9318
2024-10-15 07:38:24,845 - BEiT - INFO - No improvement for 1 consecutive epochs.
2024-10-15 07:52:13,101 - BEiT - INFO - Epoch: 19
2024-10-15 07:52:13,102 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9782030582427979,
        "recall": 0.9826435446739197,
        "f1-score": 0.9804182648658752,
        "specificity": 0.9975783824920654
    },
    "Bleeding": {
        "precision": 0.9772668480873108,
        "recall": 0.9861835241317749,
        "f1-score": 0.9817049503326416,
        "specificity": 0.9973942041397095
    },
    "Erosion": {
        "precision": 0.9686495065689087,
        "recall": 0.9392049908638,
        "f1-score": 0.953700065612793,
        "specificity": 0.9965341687202454
    },
    "Erythema": {
        "precision": 0.9514789581298828,
        "recall": 0.9731953144073486,
        "f1-score": 0.9622146487236023,
        "specificity": 0.9944738149642944
    },
    "Foreign Body": {
        "precision": 0.9765625,
        "recall": 0.9842519760131836,
        "f1-score": 0.9803921580314636,
        "specificity": 0.997435450553894
    },
    "Lymphangiectasia": {
        "precision": 0.988477349281311,
        "recall": 0.9849644899368286,
        "f1-score": 0.9867177605628967,
        "specificity": 0.998762845993042
    },
    "Normal": {
        "precision": 0.9888178706169128,
        "recall": 0.981241762638092,
        "f1-score": 0.9850152730941772,
        "specificity": 0.9987581968307495
    },
    "Polyp": {
        "precision": 0.9752887487411499,
        "recall": 0.972936749458313,
        "f1-score": 0.9741113185882568,
        "specificity": 0.9972841143608093
    },
    "Ulcer": {
        "precision": 0.9992138147354126,
        "recall": 0.9989520311355591,
        "f1-score": 0.9990829229354858,
        "specificity": 0.9999111890792847
    },
    "Worms": {
        "precision": 0.9991970062255859,
        "recall": 0.9997321963310242,
        "f1-score": 0.9994645118713379,
        "specificity": 0.9999114274978638
    },
    "accuracy": 0.9802430272102356,
    "macro avg": {
        "precision": 0.980315625667572,
        "recall": 0.9803306460380554,
        "f1-score": 0.9802822470664978,
        "specificity": 0.9978044629096985
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9998809695243835,
        "Bleeding": 0.9998514652252197,
        "Erosion": 0.9988117814064026,
        "Erythema": 0.9994915127754211,
        "Foreign Body": 0.9998840689659119,
        "Lymphangiectasia": 0.9999316334724426,
        "Normal": 0.9995790719985962,
        "Polyp": 0.9997838139533997,
        "Ulcer": 0.9999993443489075,
        "Worms": 0.9999999403953552
    },
    "average_precision_scores": {
        "Angioectasia": 0.9989540576934814,
        "Bleeding": 0.9986874461174011,
        "Erosion": 0.9907122850418091,
        "Erythema": 0.9955927133560181,
        "Foreign Body": 0.9989436864852905,
        "Lymphangiectasia": 0.9993829727172852,
        "Normal": 0.9974448680877686,
        "Polyp": 0.9981305003166199,
        "Ulcer": 0.9999940991401672,
        "Worms": 0.999999463558197
    },
    "mean_auc": 0.999721348285675,
    "mean_average_precision": 0.9977842569351196
}
2024-10-15 07:52:13,104 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.8040000200271606,
        "recall": 0.8088530898094177,
        "f1-score": 0.8064192533493042,
        "specificity": 0.9937320351600647
    },
    "Bleeding": {
        "precision": 0.8442623019218445,
        "recall": 0.8607242107391357,
        "f1-score": 0.8524137735366821,
        "specificity": 0.9963862299919128
    },
    "Erosion": {
        "precision": 0.736589252948761,
        "recall": 0.7965368032455444,
        "f1-score": 0.7653909921646118,
        "specificity": 0.9780330061912537
    },
    "Erythema": {
        "precision": 0.658703088760376,
        "recall": 0.6498316526412964,
        "f1-score": 0.6542372703552246,
        "specificity": 0.9936848878860474
    },
    "Foreign Body": {
        "precision": 0.8828571438789368,
        "recall": 0.908823549747467,
        "f1-score": 0.895652174949646,
        "specificity": 0.9974037408828735
    },
    "Lymphangiectasia": {
        "precision": 0.8300835490226746,
        "recall": 0.8688046932220459,
        "f1-score": 0.8490028381347656,
        "specificity": 0.9961365461349487
    },
    "Normal": {
        "precision": 0.9816732406616211,
        "recall": 0.9721657037734985,
        "f1-score": 0.976896345615387,
        "specificity": 0.9420025944709778
    },
    "Polyp": {
        "precision": 0.7139917612075806,
        "recall": 0.6940000057220459,
        "f1-score": 0.703853964805603,
        "specificity": 0.9911080002784729
    },
    "Ulcer": {
        "precision": 0.9587628841400146,
        "recall": 0.9755244851112366,
        "f1-score": 0.9670710563659668,
        "specificity": 0.9992427229881287
    },
    "Worms": {
        "precision": 0.9714285731315613,
        "recall": 1.0,
        "f1-score": 0.9855072498321533,
        "specificity": 0.9998754858970642
    },
    "accuracy": 0.9341681003570557,
    "macro avg": {
        "precision": 0.8382351994514465,
        "recall": 0.8535264134407043,
        "f1-score": 0.8456445932388306,
        "specificity": 0.9887605905532837
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9755350947380066,
        "Bleeding": 0.9913197159767151,
        "Erosion": 0.9748081564903259,
        "Erythema": 0.9828526377677917,
        "Foreign Body": 0.9900894165039062,
        "Lymphangiectasia": 0.9904029369354248,
        "Normal": 0.9938263893127441,
        "Polyp": 0.9828571081161499,
        "Ulcer": 0.9998435378074646,
        "Worms": 0.9999991059303284
    },
    "average_precision_scores": {
        "Angioectasia": 0.8714203834533691,
        "Bleeding": 0.9111579656600952,
        "Erosion": 0.8298090696334839,
        "Erythema": 0.6546528339385986,
        "Foreign Body": 0.9482815265655518,
        "Lymphangiectasia": 0.9210293292999268,
        "Normal": 0.9980504512786865,
        "Polyp": 0.7728773951530457,
        "Ulcer": 0.99335116147995,
        "Worms": 0.9997868537902832
    },
    "mean_auc": 0.9881534576416016,
    "mean_average_precision": 0.8900417685508728
}
2024-10-15 07:52:13,105 - BEiT - INFO - Epoch: 19 | train_loss: 0.0174 | train_acc: 0.9802 | test_loss: 0.1397 | test_acc: 0.9342
2024-10-15 07:52:13,106 - BEiT - INFO - No improvement for 2 consecutive epochs.
2024-10-15 08:06:01,544 - BEiT - INFO - Epoch: 20
2024-10-15 08:06:01,547 - BEiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9790304899215698,
        "recall": 0.9776992201805115,
        "f1-score": 0.9783644080162048,
        "specificity": 0.9977306127548218
    },
    "Bleeding": {
        "precision": 0.9673684239387512,
        "recall": 0.9831506013870239,
        "f1-score": 0.9751956462860107,
        "specificity": 0.9963387250900269
    },
    "Erosion": {
        "precision": 0.9695860147476196,
        "recall": 0.9325568675994873,
        "f1-score": 0.9507110118865967,
        "specificity": 0.99681556224823
    },
    "Erythema": {
        "precision": 0.9483903646469116,
        "recall": 0.9750459790229797,
        "f1-score": 0.9615334868431091,
        "specificity": 0.9940236806869507
    },
    "Foreign Body": {
        "precision": 0.9769290089607239,
        "recall": 0.9867944121360779,
        "f1-score": 0.9818369150161743,
        "specificity": 0.9973329305648804
    },
    "Lymphangiectasia": {
        "precision": 0.9879743456840515,
        "recall": 0.9850786328315735,
        "f1-score": 0.9865243434906006,
        "specificity": 0.998670756816864
    },
    "Normal": {
        "precision": 0.9877005219459534,
        "recall": 0.9829696416854858,
        "f1-score": 0.9853294491767883,
        "specificity": 0.9986410140991211
    },
    "Polyp": {
        "precision": 0.9772048592567444,
        "recall": 0.9680107235908508,
        "f1-score": 0.9725860953330994,
        "specificity": 0.997521162033081
    },
    "Ulcer": {
        "precision": 0.999198317527771,
        "recall": 1.0,
        "f1-score": 0.9995989799499512,
        "specificity": 0.9999114274978638
    },
    "Worms": {
        "precision": 1.0,
        "recall": 1.0,
        "f1-score": 1.0,
        "specificity": 1.0
    },
    "accuracy": 0.9792857766151428,
    "macro avg": {
        "precision": 0.9793382883071899,
        "recall": 0.9791305661201477,
        "f1-score": 0.9791680574417114,
        "specificity": 0.9976986050605774
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9998435378074646,
        "Bleeding": 0.9998024702072144,
        "Erosion": 0.9986717700958252,
        "Erythema": 0.9995077848434448,
        "Foreign Body": 0.9998904466629028,
        "Lymphangiectasia": 0.9999282360076904,
        "Normal": 0.9996293187141418,
        "Polyp": 0.9997565746307373,
        "Ulcer": 0.9999983310699463,
        "Worms": 1.0
    },
    "average_precision_scores": {
        "Angioectasia": 0.9986550211906433,
        "Bleeding": 0.9982188940048218,
        "Erosion": 0.9897575974464417,
        "Erythema": 0.995509684085846,
        "Foreign Body": 0.9990448951721191,
        "Lymphangiectasia": 0.9994289875030518,
        "Normal": 0.9980599880218506,
        "Polyp": 0.9978630542755127,
        "Ulcer": 0.9999837875366211,
        "Worms": 1.0
    },
    "mean_auc": 0.9997028708457947,
    "mean_average_precision": 0.9976521730422974
}
2024-10-15 08:06:01,551 - BEiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7926356792449951,
        "recall": 0.8229376077651978,
        "f1-score": 0.8075024485588074,
        "specificity": 0.993156373500824
    },
    "Bleeding": {
        "precision": 0.8519552946090698,
        "recall": 0.8495821952819824,
        "f1-score": 0.8507670760154724,
        "specificity": 0.9966398477554321
    },
    "Erosion": {
        "precision": 0.7167721390724182,
        "recall": 0.784415602684021,
        "f1-score": 0.74906986951828,
        "specificity": 0.9760966897010803
    },
    "Erythema": {
        "precision": 0.6514084339141846,
        "recall": 0.6228955984115601,
        "f1-score": 0.6368330717086792,
        "specificity": 0.9937480092048645
    },
    "Foreign Body": {
        "precision": 0.875,
        "recall": 0.9058823585510254,
        "f1-score": 0.8901734352111816,
        "specificity": 0.9972137808799744
    },
    "Lymphangiectasia": {
        "precision": 0.8283378481864929,
        "recall": 0.8862974047660828,
        "f1-score": 0.8563380241394043,
        "specificity": 0.996009886264801
    },
    "Normal": {
        "precision": 0.9814723134040833,
        "recall": 0.9700496196746826,
        "f1-score": 0.9757275581359863,
        "specificity": 0.941482424736023
    },
    "Polyp": {
        "precision": 0.7313131093978882,
        "recall": 0.7239999771118164,
        "f1-score": 0.7276381850242615,
        "specificity": 0.9914917945861816
    },
    "Ulcer": {
        "precision": 0.9892473220825195,
        "recall": 0.9650349617004395,
        "f1-score": 0.9769911766052246,
        "specificity": 0.9998106956481934
    },
    "Worms": {
        "precision": 0.9178082346916199,
        "recall": 0.9852941036224365,
        "f1-score": 0.9503546357154846,
        "specificity": 0.9996265172958374
    },
    "accuracy": 0.9323704242706299,
    "macro avg": {
        "precision": 0.8335950970649719,
        "recall": 0.8516389727592468,
        "f1-score": 0.8421396613121033,
        "specificity": 0.9885277152061462
    },
    "auc_roc_scores": {
        "Angioectasia": 0.9756120443344116,
        "Bleeding": 0.9909262657165527,
        "Erosion": 0.9731833934783936,
        "Erythema": 0.9787918329238892,
        "Foreign Body": 0.9910145998001099,
        "Lymphangiectasia": 0.9907069206237793,
        "Normal": 0.9934056401252747,
        "Polyp": 0.9818568229675293,
        "Ulcer": 0.9998620748519897,
        "Worms": 0.9999935626983643
    },
    "average_precision_scores": {
        "Angioectasia": 0.8761281371116638,
        "Bleeding": 0.9150953888893127,
        "Erosion": 0.8161472082138062,
        "Erythema": 0.6635914444923401,
        "Foreign Body": 0.9427111148834229,
        "Lymphangiectasia": 0.9155251979827881,
        "Normal": 0.997886598110199,
        "Polyp": 0.775727391242981,
        "Ulcer": 0.9936341643333435,
        "Worms": 0.9986274242401123
    },
    "mean_auc": 0.987535297870636,
    "mean_average_precision": 0.8895074129104614
}
2024-10-15 08:06:01,555 - BEiT - INFO - Epoch: 20 | train_loss: 0.0174 | train_acc: 0.9793 | test_loss: 0.1434 | test_acc: 0.9324
2024-10-15 08:06:01,560 - BEiT - INFO - No improvement for 3 consecutive epochs.
2024-10-15 08:06:01,571 - BEiT - INFO - Training completed for model: BEiT. Best model at epoch 17 with mean AUC: 0.9884
