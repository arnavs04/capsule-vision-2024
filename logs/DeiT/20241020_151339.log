2024-10-20 15:13:39,591 - DeiT - INFO - Training started for model: DeiT
2024-10-20 15:13:39,592 - DeiT - INFO - Epoch 1/20
2024-10-20 15:27:00,918 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.7816455960273743,
        "recall": 0.7297878265380859,
        "f1-score": 0.754827082157135,
        "specificity": 0.9776000380516052
    },
    "Bleeding": {
        "precision": 0.840587317943573,
        "recall": 0.8377318978309631,
        "f1-score": 0.8391571640968323,
        "specificity": 0.9820011854171753
    },
    "Erosion": {
        "precision": 0.5409965515136719,
        "recall": 0.5580636262893677,
        "f1-score": 0.5493975877761841,
        "specificity": 0.9486884474754333
    },
    "Erythema": {
        "precision": 0.6490384340286255,
        "recall": 0.6523489952087402,
        "f1-score": 0.6506895422935486,
        "specificity": 0.9612183570861816
    },
    "Foreign Body": {
        "precision": 0.8829962015151978,
        "recall": 0.8576739430427551,
        "f1-score": 0.8701508641242981,
        "specificity": 0.9873526096343994
    },
    "Lymphangiectasia": {
        "precision": 0.8705440759658813,
        "recall": 0.8495945334434509,
        "f1-score": 0.8599417805671692,
        "specificity": 0.9857032895088196
    },
    "Normal": {
        "precision": 0.790365993976593,
        "recall": 0.7850841879844666,
        "f1-score": 0.787716269493103,
        "specificity": 0.9769975543022156
    },
    "Polyp": {
        "precision": 0.6483973860740662,
        "recall": 0.7098848223686218,
        "f1-score": 0.6777493357658386,
        "specificity": 0.9575780630111694
    },
    "Ulcer": {
        "precision": 0.9354322552680969,
        "recall": 0.9236037731170654,
        "f1-score": 0.9294803738594055,
        "specificity": 0.9928425550460815
    },
    "Worms": {
        "precision": 0.9528645873069763,
        "recall": 0.963909387588501,
        "f1-score": 0.958355188369751,
        "specificity": 0.9946467280387878
    },
    "macro avg": {
        "precision": 0.7892868518829346,
        "recall": 0.7867683172225952,
        "f1-score": 0.7877464890480042,
        "specificity": 0.9764629602432251
    },
    "accuracy": 0.7880181670188904,
    "auc_roc_scores": {
        "Angioectasia": 0.9632911682128906,
        "Bleeding": 0.9847056269645691,
        "Erosion": 0.9130717515945435,
        "Erythema": 0.9520923495292664,
        "Foreign Body": 0.988145649433136,
        "Lymphangiectasia": 0.9846124649047852,
        "Normal": 0.9709211587905884,
        "Polyp": 0.9603195190429688,
        "Ulcer": 0.9959736466407776,
        "Worms": 0.9991123676300049
    },
    "mean_auc": 0.9712246060371399,
    "average_precision_scores": {
        "Angioectasia": 0.8486447334289551,
        "Bleeding": 0.9170624613761902,
        "Erosion": 0.5935391187667847,
        "Erythema": 0.7262545824050903,
        "Foreign Body": 0.9418858289718628,
        "Lymphangiectasia": 0.9305928349494934,
        "Normal": 0.8661677837371826,
        "Polyp": 0.7611318826675415,
        "Ulcer": 0.975601315498352,
        "Worms": 0.9936686754226685
    },
    "mean_average_precision": 0.8554549217224121,
    "mean_f1_score": 0.7877464890480042,
    "mean_specificity": 0.9764629602432251,
    "mean_sensitivity": 0.7867683172225952,
    "balanced_accuracy": 0.7867683172225952
}
2024-10-20 15:27:00,919 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.5480226278305054,
        "recall": 0.7806841135025024,
        "f1-score": 0.6439834237098694,
        "specificity": 0.9795330762863159
    },
    "Bleeding": {
        "precision": 0.6885964870452881,
        "recall": 0.8746517896652222,
        "f1-score": 0.7705521583557129,
        "specificity": 0.9909972548484802
    },
    "Erosion": {
        "precision": 0.5582298040390015,
        "recall": 0.6225108504295349,
        "f1-score": 0.5886205434799194,
        "specificity": 0.9620084166526794
    },
    "Erythema": {
        "precision": 0.34315425157546997,
        "recall": 0.6666666865348816,
        "f1-score": 0.45308923721313477,
        "specificity": 0.9760656952857971
    },
    "Foreign Body": {
        "precision": 0.5632184147834778,
        "recall": 0.8647058606147766,
        "f1-score": 0.6821345686912537,
        "specificity": 0.9855623245239258
    },
    "Lymphangiectasia": {
        "precision": 0.723809540271759,
        "recall": 0.8862974047660828,
        "f1-score": 0.7968544960021973,
        "specificity": 0.9926531314849854
    },
    "Normal": {
        "precision": 0.9879305362701416,
        "recall": 0.8660372495651245,
        "f1-score": 0.9229768514633179,
        "specificity": 0.9661898612976074
    },
    "Polyp": {
        "precision": 0.39441341161727905,
        "recall": 0.7059999704360962,
        "f1-score": 0.5060932040214539,
        "specificity": 0.9653275609016418
    },
    "Ulcer": {
        "precision": 0.721485435962677,
        "recall": 0.9510489702224731,
        "f1-score": 0.8205128312110901,
        "specificity": 0.9933737516403198
    },
    "Worms": {
        "precision": 0.5593220591545105,
        "recall": 0.970588207244873,
        "f1-score": 0.7096773982048035,
        "specificity": 0.9967629313468933
    },
    "macro avg": {
        "precision": 0.6088182926177979,
        "recall": 0.8189191222190857,
        "f1-score": 0.6894494891166687,
        "specificity": 0.9808473587036133
    },
    "accuracy": 0.8398834466934204,
    "auc_roc_scores": {
        "Angioectasia": 0.9748957753181458,
        "Bleeding": 0.9924201369285583,
        "Erosion": 0.9525741338729858,
        "Erythema": 0.968941330909729,
        "Foreign Body": 0.9826244711875916,
        "Lymphangiectasia": 0.9934204816818237,
        "Normal": 0.9777698516845703,
        "Polyp": 0.9724429249763489,
        "Ulcer": 0.9960170984268188,
        "Worms": 0.999741792678833
    },
    "mean_auc": 0.9810848236083984,
    "average_precision_scores": {
        "Angioectasia": 0.7969857454299927,
        "Bleeding": 0.8792890310287476,
        "Erosion": 0.6723670959472656,
        "Erythema": 0.5223183631896973,
        "Foreign Body": 0.84812992811203,
        "Lymphangiectasia": 0.8973825573921204,
        "Normal": 0.9928576350212097,
        "Polyp": 0.5915431976318359,
        "Ulcer": 0.9486825466156006,
        "Worms": 0.9759465456008911
    },
    "mean_average_precision": 0.8125502467155457,
    "mean_f1_score": 0.6894494891166687,
    "mean_specificity": 0.9808473587036133,
    "mean_sensitivity": 0.8189191222190857,
    "balanced_accuracy": 0.8189191222190857
}
2024-10-20 15:27:00,920 - DeiT - INFO - train_loss: 0.3777 | train_acc: 0.7880 | test_loss: 0.2915 | test_acc: 0.8399
2024-10-20 15:27:01,378 - DeiT - INFO - Best model saved with combined score: 0.9000 (Mean AUC: 0.9811, Balanced Accuracy: 0.8189)
2024-10-20 15:27:01,380 - DeiT - INFO - Epoch 2/20
2024-10-20 15:40:21,228 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8700873255729675,
        "recall": 0.8438327312469482,
        "f1-score": 0.8567589521408081,
        "specificity": 0.9859292507171631
    },
    "Bleeding": {
        "precision": 0.9024776220321655,
        "recall": 0.9128232598304749,
        "f1-score": 0.9076209664344788,
        "specificity": 0.9890713691711426
    },
    "Erosion": {
        "precision": 0.6993154287338257,
        "recall": 0.7015319466590881,
        "f1-score": 0.700421929359436,
        "specificity": 0.9662339687347412
    },
    "Erythema": {
        "precision": 0.7974914908409119,
        "recall": 0.8071938753128052,
        "f1-score": 0.8023133277893066,
        "specificity": 0.9770886301994324
    },
    "Foreign Body": {
        "precision": 0.933917224407196,
        "recall": 0.9326795935630798,
        "f1-score": 0.9332979917526245,
        "specificity": 0.9926405549049377
    },
    "Lymphangiectasia": {
        "precision": 0.9381133913993835,
        "recall": 0.925000011920929,
        "f1-score": 0.9315105676651001,
        "specificity": 0.993301272392273
    },
    "Normal": {
        "precision": 0.8881524205207825,
        "recall": 0.859663188457489,
        "f1-score": 0.8736756443977356,
        "specificity": 0.9880411028862
    },
    "Polyp": {
        "precision": 0.7967742085456848,
        "recall": 0.838162362575531,
        "f1-score": 0.816944420337677,
        "specificity": 0.9757519960403442
    },
    "Ulcer": {
        "precision": 0.9816689491271973,
        "recall": 0.9771241545677185,
        "f1-score": 0.9793912768363953,
        "specificity": 0.99802565574646
    },
    "Worms": {
        "precision": 0.9894235730171204,
        "recall": 0.9915209412574768,
        "f1-score": 0.9904711246490479,
        "specificity": 0.9988177418708801
    },
    "macro avg": {
        "precision": 0.8797421455383301,
        "recall": 0.8789531588554382,
        "f1-score": 0.8792406320571899,
        "specificity": 0.9864901900291443
    },
    "accuracy": 0.878480076789856,
    "auc_roc_scores": {
        "Angioectasia": 0.9884051084518433,
        "Bleeding": 0.9950541853904724,
        "Erosion": 0.9602392911911011,
        "Erythema": 0.984072208404541,
        "Foreign Body": 0.9974561929702759,
        "Lymphangiectasia": 0.9964014887809753,
        "Normal": 0.9883227348327637,
        "Polyp": 0.9861111640930176,
        "Ulcer": 0.9995449781417847,
        "Worms": 0.9997650384902954
    },
    "mean_auc": 0.989537239074707,
    "average_precision_scores": {
        "Angioectasia": 0.9366334676742554,
        "Bleeding": 0.9675809144973755,
        "Erosion": 0.7815041542053223,
        "Erythema": 0.8875699043273926,
        "Foreign Body": 0.9830904006958008,
        "Lymphangiectasia": 0.978811502456665,
        "Normal": 0.9406815767288208,
        "Polyp": 0.900757372379303,
        "Ulcer": 0.9962068796157837,
        "Worms": 0.999163031578064
    },
    "mean_average_precision": 0.9372000098228455,
    "mean_f1_score": 0.8792406320571899,
    "mean_specificity": 0.9864901900291443,
    "mean_sensitivity": 0.8789531588554382,
    "balanced_accuracy": 0.8789531588554382
}
2024-10-20 15:40:21,231 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.560178279876709,
        "recall": 0.758551299571991,
        "f1-score": 0.644444465637207,
        "specificity": 0.9810681343078613
    },
    "Bleeding": {
        "precision": 0.8305084705352783,
        "recall": 0.8189415335655212,
        "f1-score": 0.8246844410896301,
        "specificity": 0.9961960315704346
    },
    "Erosion": {
        "precision": 0.49623188376426697,
        "recall": 0.7411255240440369,
        "f1-score": 0.5944444537162781,
        "specificity": 0.9419776797294617
    },
    "Erythema": {
        "precision": 0.48520711064338684,
        "recall": 0.5521885752677917,
        "f1-score": 0.5165354609489441,
        "specificity": 0.9890117049217224
    },
    "Foreign Body": {
        "precision": 0.3754556477069855,
        "recall": 0.908823549747467,
        "f1-score": 0.5313843488693237,
        "specificity": 0.9674518704414368
    },
    "Lymphangiectasia": {
        "precision": 0.5295169949531555,
        "recall": 0.8629737496376038,
        "f1-score": 0.6563193202018738,
        "specificity": 0.9833428263664246
    },
    "Normal": {
        "precision": 0.9920604228973389,
        "recall": 0.8338894844055176,
        "f1-score": 0.9061242341995239,
        "specificity": 0.9786735773086548
    },
    "Polyp": {
        "precision": 0.4436781704425812,
        "recall": 0.7720000147819519,
        "f1-score": 0.563503623008728,
        "specificity": 0.9690378904342651
    },
    "Ulcer": {
        "precision": 0.7561643719673157,
        "recall": 0.9650349617004395,
        "f1-score": 0.8479262590408325,
        "specificity": 0.9943834543228149
    },
    "Worms": {
        "precision": 0.6701030731201172,
        "recall": 0.9558823704719543,
        "f1-score": 0.7878788113594055,
        "specificity": 0.9980079531669617
    },
    "macro avg": {
        "precision": 0.613910436630249,
        "recall": 0.8169410824775696,
        "f1-score": 0.6873245239257812,
        "specificity": 0.9799150824546814
    },
    "accuracy": 0.8225266337394714,
    "auc_roc_scores": {
        "Angioectasia": 0.9598910808563232,
        "Bleeding": 0.9808477163314819,
        "Erosion": 0.9491809010505676,
        "Erythema": 0.9647218585014343,
        "Foreign Body": 0.9793059825897217,
        "Lymphangiectasia": 0.9843661785125732,
        "Normal": 0.9808145761489868,
        "Polyp": 0.9734902381896973,
        "Ulcer": 0.9983048439025879,
        "Worms": 0.9951956868171692
    },
    "mean_auc": 0.9766119122505188,
    "average_precision_scores": {
        "Angioectasia": 0.7621113061904907,
        "Bleeding": 0.8834095597267151,
        "Erosion": 0.6933624148368835,
        "Erythema": 0.5463098883628845,
        "Foreign Body": 0.8496884107589722,
        "Lymphangiectasia": 0.8283816576004028,
        "Normal": 0.993883490562439,
        "Polyp": 0.689112663269043,
        "Ulcer": 0.9735196828842163,
        "Worms": 0.9632155299186707
    },
    "mean_average_precision": 0.8182994723320007,
    "mean_f1_score": 0.6873245239257812,
    "mean_specificity": 0.9799150824546814,
    "mean_sensitivity": 0.8169410824775696,
    "balanced_accuracy": 0.8169410824775696
}
2024-10-20 15:40:21,232 - DeiT - INFO - train_loss: 0.1841 | train_acc: 0.8785 | test_loss: 0.2899 | test_acc: 0.8225
2024-10-20 15:40:21,232 - DeiT - INFO - No improvement for 1 consecutive epochs.
2024-10-20 15:40:21,234 - DeiT - INFO - Epoch 3/20
2024-10-20 15:53:39,970 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.8978508710861206,
        "recall": 0.8837816715240479,
        "f1-score": 0.8907607197761536,
        "specificity": 0.9886020421981812
    },
    "Bleeding": {
        "precision": 0.9279771447181702,
        "recall": 0.9389634132385254,
        "f1-score": 0.9334379434585571,
        "specificity": 0.9918062090873718
    },
    "Erosion": {
        "precision": 0.7561174631118774,
        "recall": 0.7530462741851807,
        "f1-score": 0.7545787692070007,
        "specificity": 0.9735507369041443
    },
    "Erythema": {
        "precision": 0.8485981225967407,
        "recall": 0.8554508686065674,
        "f1-score": 0.8520107269287109,
        "specificity": 0.9832704067230225
    },
    "Foreign Body": {
        "precision": 0.9540016055107117,
        "recall": 0.9519766569137573,
        "f1-score": 0.9529880285263062,
        "specificity": 0.9948874115943909
    },
    "Lymphangiectasia": {
        "precision": 0.9475635886192322,
        "recall": 0.9396008253097534,
        "f1-score": 0.9435654282569885,
        "specificity": 0.9941418170928955
    },
    "Normal": {
        "precision": 0.9034276604652405,
        "recall": 0.8837147355079651,
        "f1-score": 0.8934624791145325,
        "specificity": 0.9895122647285461
    },
    "Polyp": {
        "precision": 0.8571428656578064,
        "recall": 0.8850882053375244,
        "f1-score": 0.8708913922309875,
        "specificity": 0.9836999773979187
    },
    "Ulcer": {
        "precision": 0.9863234162330627,
        "recall": 0.9850026965141296,
        "f1-score": 0.985662579536438,
        "specificity": 0.9984943866729736
    },
    "Worms": {
        "precision": 0.9904331564903259,
        "recall": 0.991750955581665,
        "f1-score": 0.9910916090011597,
        "specificity": 0.9989364743232727
    },
    "macro avg": {
        "precision": 0.9069435000419617,
        "recall": 0.9068376421928406,
        "f1-score": 0.9068449139595032,
        "specificity": 0.9896901249885559
    },
    "accuracy": 0.9071715474128723,
    "auc_roc_scores": {
        "Angioectasia": 0.992816686630249,
        "Bleeding": 0.997230052947998,
        "Erosion": 0.9730145931243896,
        "Erythema": 0.9910494089126587,
        "Foreign Body": 0.9989337921142578,
        "Lymphangiectasia": 0.9977986812591553,
        "Normal": 0.9906946420669556,
        "Polyp": 0.9923128485679626,
        "Ulcer": 0.9997286796569824,
        "Worms": 0.9999485611915588
    },
    "mean_auc": 0.9933528304100037,
    "average_precision_scores": {
        "Angioectasia": 0.9605461359024048,
        "Bleeding": 0.981529712677002,
        "Erosion": 0.8411980867385864,
        "Erythema": 0.924858033657074,
        "Foreign Body": 0.9912806153297424,
        "Lymphangiectasia": 0.9861630201339722,
        "Normal": 0.951970100402832,
        "Polyp": 0.941906750202179,
        "Ulcer": 0.9982845187187195,
        "Worms": 0.9995476007461548
    },
    "mean_average_precision": 0.9577285051345825,
    "mean_f1_score": 0.9068449139595032,
    "mean_specificity": 0.9896901249885559,
    "mean_sensitivity": 0.9068376421928406,
    "balanced_accuracy": 0.9068376421928406
}
2024-10-20 15:53:39,972 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.5554123520851135,
        "recall": 0.8672032356262207,
        "f1-score": 0.6771405935287476,
        "specificity": 0.9779341220855713
    },
    "Bleeding": {
        "precision": 0.7758620977401733,
        "recall": 0.8774373531341553,
        "f1-score": 0.8235294222831726,
        "specificity": 0.9942306280136108
    },
    "Erosion": {
        "precision": 0.6555653214454651,
        "recall": 0.6476190686225891,
        "f1-score": 0.6515679359436035,
        "specificity": 0.9737597703933716
    },
    "Erythema": {
        "precision": 0.46962615847587585,
        "recall": 0.6767676472663879,
        "f1-score": 0.5544827580451965,
        "specificity": 0.9856646656990051
    },
    "Foreign Body": {
        "precision": 0.6340425610542297,
        "recall": 0.8764705657958984,
        "f1-score": 0.7358024716377258,
        "specificity": 0.9891083836555481
    },
    "Lymphangiectasia": {
        "precision": 0.6770601272583008,
        "recall": 0.8862974047660828,
        "f1-score": 0.7676767706871033,
        "specificity": 0.9908164143562317
    },
    "Normal": {
        "precision": 0.9865290522575378,
        "recall": 0.9178807139396667,
        "f1-score": 0.95096755027771,
        "specificity": 0.9599480032920837
    },
    "Polyp": {
        "precision": 0.5276073813438416,
        "recall": 0.6880000233650208,
        "f1-score": 0.5972222089767456,
        "specificity": 0.9802968502044678
    },
    "Ulcer": {
        "precision": 0.8950819969177246,
        "recall": 0.9545454382896423,
        "f1-score": 0.9238578677177429,
        "specificity": 0.997980535030365
    },
    "Worms": {
        "precision": 0.9178082346916199,
        "recall": 0.9852941036224365,
        "f1-score": 0.9503546357154846,
        "specificity": 0.9996265172958374
    },
    "macro avg": {
        "precision": 0.7094594836235046,
        "recall": 0.837751567363739,
        "f1-score": 0.7632602453231812,
        "specificity": 0.9849366545677185
    },
    "accuracy": 0.8838953375816345,
    "auc_roc_scores": {
        "Angioectasia": 0.9853527545928955,
        "Bleeding": 0.9920655488967896,
        "Erosion": 0.9638364911079407,
        "Erythema": 0.9769183397293091,
        "Foreign Body": 0.9824008941650391,
        "Lymphangiectasia": 0.9913820028305054,
        "Normal": 0.9872973561286926,
        "Polyp": 0.9792081713676453,
        "Ulcer": 0.9967320561408997,
        "Worms": 0.9999844431877136
    },
    "mean_auc": 0.9855177998542786,
    "average_precision_scores": {
        "Angioectasia": 0.8614774942398071,
        "Bleeding": 0.9048154950141907,
        "Erosion": 0.7394720315933228,
        "Erythema": 0.6084706783294678,
        "Foreign Body": 0.8906298875808716,
        "Lymphangiectasia": 0.8902599215507507,
        "Normal": 0.9959251880645752,
        "Polyp": 0.6981403231620789,
        "Ulcer": 0.9785001873970032,
        "Worms": 0.9968112707138062
    },
    "mean_average_precision": 0.8564502596855164,
    "mean_f1_score": 0.7632602453231812,
    "mean_specificity": 0.9849366545677185,
    "mean_sensitivity": 0.837751567363739,
    "balanced_accuracy": 0.837751567363739
}
2024-10-20 15:53:39,973 - DeiT - INFO - train_loss: 0.1333 | train_acc: 0.9072 | test_loss: 0.1836 | test_acc: 0.8839
2024-10-20 15:53:40,687 - DeiT - INFO - Best model saved with combined score: 0.9116 (Mean AUC: 0.9855, Balanced Accuracy: 0.8378)
2024-10-20 15:53:40,690 - DeiT - INFO - Epoch 4/20
2024-10-20 16:07:00,400 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9154511094093323,
        "recall": 0.9022896885871887,
        "f1-score": 0.9088227152824402,
        "specificity": 0.9907535910606384
    },
    "Bleeding": {
        "precision": 0.9398416876792908,
        "recall": 0.9473404288291931,
        "f1-score": 0.9435761570930481,
        "specificity": 0.9932637810707092
    },
    "Erosion": {
        "precision": 0.7981283664703369,
        "recall": 0.7966372966766357,
        "f1-score": 0.797382116317749,
        "specificity": 0.9777023196220398
    },
    "Erythema": {
        "precision": 0.8743873834609985,
        "recall": 0.8867381811141968,
        "f1-score": 0.8805195093154907,
        "specificity": 0.9855849146842957
    },
    "Foreign Body": {
        "precision": 0.9568711519241333,
        "recall": 0.9573840498924255,
        "f1-score": 0.957127571105957,
        "specificity": 0.9952473640441895
    },
    "Lymphangiectasia": {
        "precision": 0.9595645666122437,
        "recall": 0.9580745100975037,
        "f1-score": 0.9588189721107483,
        "specificity": 0.9953768253326416
    },
    "Normal": {
        "precision": 0.9150760769844055,
        "recall": 0.8976933360099792,
        "f1-score": 0.9063013792037964,
        "specificity": 0.990949809551239
    },
    "Polyp": {
        "precision": 0.8805128335952759,
        "recall": 0.8956702947616577,
        "f1-score": 0.8880268931388855,
        "specificity": 0.9862020015716553
    },
    "Ulcer": {
        "precision": 0.9865591526031494,
        "recall": 0.9841780662536621,
        "f1-score": 0.9853671789169312,
        "specificity": 0.9985241293907166
    },
    "Worms": {
        "precision": 0.9953703880310059,
        "recall": 0.9937465786933899,
        "f1-score": 0.994557797908783,
        "specificity": 0.9994989633560181
    },
    "macro avg": {
        "precision": 0.9221763014793396,
        "recall": 0.9219752550125122,
        "f1-score": 0.9220499992370605,
        "specificity": 0.9913104176521301
    },
    "accuracy": 0.9218230843544006,
    "auc_roc_scores": {
        "Angioectasia": 0.9955189228057861,
        "Bleeding": 0.9984395503997803,
        "Erosion": 0.9809827208518982,
        "Erythema": 0.9936244487762451,
        "Foreign Body": 0.9988106489181519,
        "Lymphangiectasia": 0.9987771511077881,
        "Normal": 0.9940136671066284,
        "Polyp": 0.9944514036178589,
        "Ulcer": 0.9998542070388794,
        "Worms": 0.9998546242713928
    },
    "mean_auc": 0.9954326748847961,
    "average_precision_scores": {
        "Angioectasia": 0.9699622392654419,
        "Bleeding": 0.9877793788909912,
        "Erosion": 0.884581983089447,
        "Erythema": 0.9489519596099854,
        "Foreign Body": 0.9920066595077515,
        "Lymphangiectasia": 0.9918456077575684,
        "Normal": 0.964952290058136,
        "Polyp": 0.9606285095214844,
        "Ulcer": 0.9988205432891846,
        "Worms": 0.999487042427063
    },
    "mean_average_precision": 0.9699016809463501,
    "mean_f1_score": 0.9220499992370605,
    "mean_specificity": 0.9913104176521301,
    "mean_sensitivity": 0.9219752550125122,
    "balanced_accuracy": 0.9219752550125122
}
2024-10-20 16:07:00,401 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.690391480922699,
        "recall": 0.7806841135025024,
        "f1-score": 0.7327667474746704,
        "specificity": 0.9888710975646973
    },
    "Bleeding": {
        "precision": 0.791773796081543,
        "recall": 0.8579387068748474,
        "f1-score": 0.8235294222831726,
        "specificity": 0.9948646426200867
    },
    "Erosion": {
        "precision": 0.583264946937561,
        "recall": 0.6155844330787659,
        "f1-score": 0.5989890694618225,
        "specificity": 0.9660813212394714
    },
    "Erythema": {
        "precision": 0.3040103614330292,
        "recall": 0.7912458181381226,
        "f1-score": 0.4392523467540741,
        "specificity": 0.96602463722229
    },
    "Foreign Body": {
        "precision": 0.7815789580345154,
        "recall": 0.8735294342041016,
        "f1-score": 0.824999988079071,
        "specificity": 0.9947441816329956
    },
    "Lymphangiectasia": {
        "precision": 0.7339667677879333,
        "recall": 0.9008746147155762,
        "f1-score": 0.8089005351066589,
        "specificity": 0.9929064512252808
    },
    "Normal": {
        "precision": 0.9926410913467407,
        "recall": 0.900219738483429,
        "f1-score": 0.9441741108894348,
        "specificity": 0.9786735773086548
    },
    "Polyp": {
        "precision": 0.5026177763938904,
        "recall": 0.7680000066757202,
        "f1-score": 0.607594907283783,
        "specificity": 0.9756909012794495
    },
    "Ulcer": {
        "precision": 0.6804878115653992,
        "recall": 0.9755244851112366,
        "f1-score": 0.8017241358757019,
        "specificity": 0.9917329549789429
    },
    "Worms": {
        "precision": 0.9295774698257446,
        "recall": 0.970588207244873,
        "f1-score": 0.9496402740478516,
        "specificity": 0.9996887445449829
    },
    "macro avg": {
        "precision": 0.6990310549736023,
        "recall": 0.8434190154075623,
        "f1-score": 0.7531571388244629,
        "specificity": 0.9849278330802917
    },
    "accuracy": 0.8701958656311035,
    "auc_roc_scores": {
        "Angioectasia": 0.9797266721725464,
        "Bleeding": 0.9902511239051819,
        "Erosion": 0.9494331479072571,
        "Erythema": 0.9795568585395813,
        "Foreign Body": 0.9875670671463013,
        "Lymphangiectasia": 0.9913299083709717,
        "Normal": 0.9869263768196106,
        "Polyp": 0.9810971021652222,
        "Ulcer": 0.9982588291168213,
        "Worms": 0.9976847171783447
    },
    "mean_auc": 0.984183132648468,
    "average_precision_scores": {
        "Angioectasia": 0.8398946523666382,
        "Bleeding": 0.9025877714157104,
        "Erosion": 0.6916615962982178,
        "Erythema": 0.5809565782546997,
        "Foreign Body": 0.9181031584739685,
        "Lymphangiectasia": 0.8969593644142151,
        "Normal": 0.9960276484489441,
        "Polyp": 0.7143787145614624,
        "Ulcer": 0.9765040874481201,
        "Worms": 0.9813008308410645
    },
    "mean_average_precision": 0.8498374819755554,
    "mean_f1_score": 0.7531571388244629,
    "mean_specificity": 0.9849278330802917,
    "mean_sensitivity": 0.8434190154075623,
    "balanced_accuracy": 0.8434190154075623
}
2024-10-20 16:07:00,403 - DeiT - INFO - train_loss: 0.1071 | train_acc: 0.9218 | test_loss: 0.2349 | test_acc: 0.8702
2024-10-20 16:07:01,146 - DeiT - INFO - Best model saved with combined score: 0.9138 (Mean AUC: 0.9842, Balanced Accuracy: 0.8434)
2024-10-20 16:07:01,148 - DeiT - INFO - Epoch 5/20
2024-10-20 16:20:19,756 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9246537685394287,
        "recall": 0.918294370174408,
        "f1-score": 0.9214630722999573,
        "specificity": 0.9919934272766113
    },
    "Bleeding": {
        "precision": 0.946825385093689,
        "recall": 0.9538912773132324,
        "f1-score": 0.9503452181816101,
        "specificity": 0.9940629005432129
    },
    "Erosion": {
        "precision": 0.8236734867095947,
        "recall": 0.8134909868240356,
        "f1-score": 0.8185505867004395,
        "specificity": 0.9808770418167114
    },
    "Erythema": {
        "precision": 0.8956202268600464,
        "recall": 0.9099386930465698,
        "f1-score": 0.9027227163314819,
        "specificity": 0.9882436394691467
    },
    "Foreign Body": {
        "precision": 0.9656732082366943,
        "recall": 0.9656732082366943,
        "f1-score": 0.9656732082366943,
        "specificity": 0.9961889386177063
    },
    "Lymphangiectasia": {
        "precision": 0.9533954858779907,
        "recall": 0.955686092376709,
        "f1-score": 0.95453941822052,
        "specificity": 0.9948318004608154
    },
    "Normal": {
        "precision": 0.9311851263046265,
        "recall": 0.9122525453567505,
        "f1-score": 0.9216216206550598,
        "specificity": 0.992559552192688
    },
    "Polyp": {
        "precision": 0.9008476734161377,
        "recall": 0.911856472492218,
        "f1-score": 0.9063186645507812,
        "specificity": 0.9885666966438293
    },
    "Ulcer": {
        "precision": 0.9907967448234558,
        "recall": 0.9905362725257874,
        "f1-score": 0.9906665086746216,
        "specificity": 0.9989646077156067
    },
    "Worms": {
        "precision": 0.9950751662254333,
        "recall": 0.9961079359054565,
        "f1-score": 0.9955912828445435,
        "specificity": 0.9994370937347412
    },
    "macro avg": {
        "precision": 0.9327746629714966,
        "recall": 0.9327728152275085,
        "f1-score": 0.9327492117881775,
        "specificity": 0.9925726056098938
    },
    "accuracy": 0.9331241250038147,
    "auc_roc_scores": {
        "Angioectasia": 0.9968318939208984,
        "Bleeding": 0.9986546635627747,
        "Erosion": 0.9849306344985962,
        "Erythema": 0.995495080947876,
        "Foreign Body": 0.9990238547325134,
        "Lymphangiectasia": 0.998795747756958,
        "Normal": 0.9943847060203552,
        "Polyp": 0.9958045482635498,
        "Ulcer": 0.9997565150260925,
        "Worms": 0.9999820590019226
    },
    "mean_auc": 0.9963659644126892,
    "average_precision_scores": {
        "Angioectasia": 0.9776296019554138,
        "Bleeding": 0.9896731972694397,
        "Erosion": 0.9065330624580383,
        "Erythema": 0.9597434997558594,
        "Foreign Body": 0.9937371015548706,
        "Lymphangiectasia": 0.9905474185943604,
        "Normal": 0.9721081256866455,
        "Polyp": 0.9671878814697266,
        "Ulcer": 0.9991813898086548,
        "Worms": 0.9998466968536377
    },
    "mean_average_precision": 0.9756187796592712,
    "mean_f1_score": 0.9327492117881775,
    "mean_specificity": 0.9925726056098938,
    "mean_sensitivity": 0.9327728152275085,
    "balanced_accuracy": 0.9327728152275085
}
2024-10-20 16:20:19,758 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6128000020980835,
        "recall": 0.7706237435340881,
        "f1-score": 0.6827094554901123,
        "specificity": 0.9845219254493713
    },
    "Bleeding": {
        "precision": 0.8416422009468079,
        "recall": 0.7994428873062134,
        "f1-score": 0.8199999928474426,
        "specificity": 0.9965764284133911
    },
    "Erosion": {
        "precision": 0.5545454621315002,
        "recall": 0.739393949508667,
        "f1-score": 0.633766233921051,
        "specificity": 0.9541964530944824
    },
    "Erythema": {
        "precision": 0.4960629940032959,
        "recall": 0.6363636255264282,
        "f1-score": 0.5575221180915833,
        "specificity": 0.9878749847412109
    },
    "Foreign Body": {
        "precision": 0.8042895197868347,
        "recall": 0.8823529481887817,
        "f1-score": 0.8415147066116333,
        "specificity": 0.9953774213790894
    },
    "Lymphangiectasia": {
        "precision": 0.819242000579834,
        "recall": 0.819242000579834,
        "f1-score": 0.819242000579834,
        "specificity": 0.9960731863975525
    },
    "Normal": {
        "precision": 0.9872506260871887,
        "recall": 0.9264262914657593,
        "f1-score": 0.9558718800544739,
        "specificity": 0.9617685079574585
    },
    "Polyp": {
        "precision": 0.5583596229553223,
        "recall": 0.7080000042915344,
        "f1-score": 0.6243386268615723,
        "specificity": 0.982088029384613
    },
    "Ulcer": {
        "precision": 0.9256756901741028,
        "recall": 0.9580419659614563,
        "f1-score": 0.9415807723999023,
        "specificity": 0.9986116290092468
    },
    "Worms": {
        "precision": 0.9420289993286133,
        "recall": 0.9558823704719543,
        "f1-score": 0.9489051103591919,
        "specificity": 0.9997509717941284
    },
    "macro avg": {
        "precision": 0.754189670085907,
        "recall": 0.8195770382881165,
        "f1-score": 0.7825450897216797,
        "specificity": 0.9856840372085571
    },
    "accuracy": 0.8907760977745056,
    "auc_roc_scores": {
        "Angioectasia": 0.9773505926132202,
        "Bleeding": 0.9914379119873047,
        "Erosion": 0.9632326364517212,
        "Erythema": 0.9802751541137695,
        "Foreign Body": 0.9857351183891296,
        "Lymphangiectasia": 0.9894877076148987,
        "Normal": 0.9873226284980774,
        "Polyp": 0.979330837726593,
        "Ulcer": 0.9986234903335571,
        "Worms": 0.996085524559021
    },
    "mean_auc": 0.9848881959915161,
    "average_precision_scores": {
        "Angioectasia": 0.8107491731643677,
        "Bleeding": 0.8967310190200806,
        "Erosion": 0.741120457649231,
        "Erythema": 0.5974045991897583,
        "Foreign Body": 0.9196707010269165,
        "Lymphangiectasia": 0.8788657784461975,
        "Normal": 0.9959374070167542,
        "Polyp": 0.7219292521476746,
        "Ulcer": 0.9856152534484863,
        "Worms": 0.9759007692337036
    },
    "mean_average_precision": 0.8523924946784973,
    "mean_f1_score": 0.7825450897216797,
    "mean_specificity": 0.9856840372085571,
    "mean_sensitivity": 0.8195770382881165,
    "balanced_accuracy": 0.8195770382881165
}
2024-10-20 16:20:19,759 - DeiT - INFO - train_loss: 0.0901 | train_acc: 0.9331 | test_loss: 0.1833 | test_acc: 0.8908
2024-10-20 16:20:19,759 - DeiT - INFO - No improvement for 1 consecutive epochs.
2024-10-20 16:20:19,761 - DeiT - INFO - Epoch 6/20
2024-10-20 16:33:37,416 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9328582882881165,
        "recall": 0.9285324811935425,
        "f1-score": 0.930690348148346,
        "specificity": 0.9927815794944763
    },
    "Bleeding": {
        "precision": 0.94140625,
        "recall": 0.9523182511329651,
        "f1-score": 0.9468308091163635,
        "specificity": 0.9933453798294067
    },
    "Erosion": {
        "precision": 0.8484193682670593,
        "recall": 0.8353285193443298,
        "f1-score": 0.8418230414390564,
        "specificity": 0.9834259152412415
    },
    "Erythema": {
        "precision": 0.9047117829322815,
        "recall": 0.9140957593917847,
        "f1-score": 0.9093795418739319,
        "specificity": 0.9893048405647278
    },
    "Foreign Body": {
        "precision": 0.9663335084915161,
        "recall": 0.9670966267585754,
        "f1-score": 0.9667149186134338,
        "specificity": 0.9962139129638672
    },
    "Lymphangiectasia": {
        "precision": 0.9648553729057312,
        "recall": 0.9635528922080994,
        "f1-score": 0.9642037153244019,
        "specificity": 0.9961655139923096
    },
    "Normal": {
        "precision": 0.9404289126396179,
        "recall": 0.9264475703239441,
        "f1-score": 0.9333859086036682,
        "specificity": 0.993337869644165
    },
    "Polyp": {
        "precision": 0.913476288318634,
        "recall": 0.927202045917511,
        "f1-score": 0.9202879667282104,
        "specificity": 0.9899546504020691
    },
    "Ulcer": {
        "precision": 0.9934888482093811,
        "recall": 0.9910690188407898,
        "f1-score": 0.9922774434089661,
        "specificity": 0.9992923140525818
    },
    "Worms": {
        "precision": 0.9967880249023438,
        "recall": 0.9973219037055969,
        "f1-score": 0.9970548748970032,
        "specificity": 0.9996457099914551
    },
    "macro avg": {
        "precision": 0.9402767419815063,
        "recall": 0.940296471118927,
        "f1-score": 0.940264880657196,
        "specificity": 0.9933468103408813
    },
    "accuracy": 0.9401441216468811,
    "auc_roc_scores": {
        "Angioectasia": 0.9975494146347046,
        "Bleeding": 0.9988003969192505,
        "Erosion": 0.9883251190185547,
        "Erythema": 0.9962974190711975,
        "Foreign Body": 0.9992170929908752,
        "Lymphangiectasia": 0.9992800951004028,
        "Normal": 0.9958100318908691,
        "Polyp": 0.9966322779655457,
        "Ulcer": 0.9999504089355469,
        "Worms": 0.9999931454658508
    },
    "mean_auc": 0.9971855282783508,
    "average_precision_scores": {
        "Angioectasia": 0.982318639755249,
        "Bleeding": 0.9905539751052856,
        "Erosion": 0.9231733083724976,
        "Erythema": 0.9672713875770569,
        "Foreign Body": 0.9946150779724121,
        "Lymphangiectasia": 0.9942362308502197,
        "Normal": 0.9780768156051636,
        "Polyp": 0.976237952709198,
        "Ulcer": 0.9995772838592529,
        "Worms": 0.9999377727508545
    },
    "mean_average_precision": 0.9805998802185059,
    "mean_f1_score": 0.940264880657196,
    "mean_specificity": 0.9933468103408813,
    "mean_sensitivity": 0.940296471118927,
    "balanced_accuracy": 0.940296471118927
}
2024-10-20 16:33:37,418 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7983193397521973,
        "recall": 0.7645875215530396,
        "f1-score": 0.7810894250869751,
        "specificity": 0.9938599467277527
    },
    "Bleeding": {
        "precision": 0.686956524848938,
        "recall": 0.8802228569984436,
        "f1-score": 0.771672785282135,
        "specificity": 0.990870475769043
    },
    "Erosion": {
        "precision": 0.6639741659164429,
        "recall": 0.7116883397102356,
        "f1-score": 0.6870037317276001,
        "specificity": 0.9722240567207336
    },
    "Erythema": {
        "precision": 0.6305220723152161,
        "recall": 0.5286195278167725,
        "f1-score": 0.5750916004180908,
        "specificity": 0.9941900968551636
    },
    "Foreign Body": {
        "precision": 0.8097826242446899,
        "recall": 0.8764705657958984,
        "f1-score": 0.8418079018592834,
        "specificity": 0.9955673813819885
    },
    "Lymphangiectasia": {
        "precision": 0.7849740982055664,
        "recall": 0.8833819031715393,
        "f1-score": 0.8312757015228271,
        "specificity": 0.9947431683540344
    },
    "Normal": {
        "precision": 0.9817875027656555,
        "recall": 0.9476682543754578,
        "f1-score": 0.9644262194633484,
        "specificity": 0.9438231587409973
    },
    "Polyp": {
        "precision": 0.5414847135543823,
        "recall": 0.7440000176429749,
        "f1-score": 0.6267902255058289,
        "specificity": 0.9798490405082703
    },
    "Ulcer": {
        "precision": 0.9025974273681641,
        "recall": 0.9720279574394226,
        "f1-score": 0.936026930809021,
        "specificity": 0.9981067776679993
    },
    "Worms": {
        "precision": 0.6600000262260437,
        "recall": 0.970588207244873,
        "f1-score": 0.7857142686843872,
        "specificity": 0.9978834390640259
    },
    "macro avg": {
        "precision": 0.746039867401123,
        "recall": 0.8279255032539368,
        "f1-score": 0.7800898551940918,
        "specificity": 0.9861118197441101
    },
    "accuracy": 0.9072650671005249,
    "auc_roc_scores": {
        "Angioectasia": 0.9832390546798706,
        "Bleeding": 0.9867419004440308,
        "Erosion": 0.9708365201950073,
        "Erythema": 0.9733085036277771,
        "Foreign Body": 0.9918838143348694,
        "Lymphangiectasia": 0.9939168691635132,
        "Normal": 0.9892088174819946,
        "Polyp": 0.9782161712646484,
        "Ulcer": 0.9978388547897339,
        "Worms": 0.9998159408569336
    },
    "mean_auc": 0.9865005612373352,
    "average_precision_scores": {
        "Angioectasia": 0.846122145652771,
        "Bleeding": 0.8778814077377319,
        "Erosion": 0.7615581750869751,
        "Erythema": 0.6067992448806763,
        "Foreign Body": 0.9210806488990784,
        "Lymphangiectasia": 0.9222838282585144,
        "Normal": 0.9966588020324707,
        "Polyp": 0.6984725594520569,
        "Ulcer": 0.983870267868042,
        "Worms": 0.9734060764312744
    },
    "mean_average_precision": 0.8588132858276367,
    "mean_f1_score": 0.7800898551940918,
    "mean_specificity": 0.9861118197441101,
    "mean_sensitivity": 0.8279255032539368,
    "balanced_accuracy": 0.8279255032539368
}
2024-10-20 16:33:37,419 - DeiT - INFO - train_loss: 0.0766 | train_acc: 0.9401 | test_loss: 0.1586 | test_acc: 0.9073
2024-10-20 16:33:37,420 - DeiT - INFO - No improvement for 2 consecutive epochs.
2024-10-20 16:33:37,422 - DeiT - INFO - Epoch 7/20
2024-10-20 16:46:57,642 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9438817501068115,
        "recall": 0.9431072473526001,
        "f1-score": 0.9434943199157715,
        "specificity": 0.9939618706703186
    },
    "Bleeding": {
        "precision": 0.950810968875885,
        "recall": 0.9602577686309814,
        "f1-score": 0.9555110335350037,
        "specificity": 0.9945400357246399
    },
    "Erosion": {
        "precision": 0.8683709502220154,
        "recall": 0.8587950468063354,
        "f1-score": 0.863556444644928,
        "specificity": 0.9857180714607239
    },
    "Erythema": {
        "precision": 0.916558027267456,
        "recall": 0.9276853799819946,
        "f1-score": 0.9220881462097168,
        "specificity": 0.9905375838279724
    },
    "Foreign Body": {
        "precision": 0.9645463824272156,
        "recall": 0.9658052921295166,
        "f1-score": 0.965175449848175,
        "specificity": 0.9959734678268433
    },
    "Lymphangiectasia": {
        "precision": 0.9682539701461792,
        "recall": 0.965740978717804,
        "f1-score": 0.9669958353042603,
        "specificity": 0.9963856339454651
    },
    "Normal": {
        "precision": 0.9377937316894531,
        "recall": 0.9209883213043213,
        "f1-score": 0.9293150901794434,
        "specificity": 0.9933675527572632
    },
    "Polyp": {
        "precision": 0.9269310832023621,
        "recall": 0.9344909191131592,
        "f1-score": 0.930695652961731,
        "specificity": 0.9917174577713013
    },
    "Ulcer": {
        "precision": 0.9939201474189758,
        "recall": 0.9941829442977905,
        "f1-score": 0.9940515756607056,
        "specificity": 0.9993200302124023
    },
    "Worms": {
        "precision": 0.9981432557106018,
        "recall": 0.9981432557106018,
        "f1-score": 0.9981432557106018,
        "specificity": 0.9997931122779846
    },
    "macro avg": {
        "precision": 0.9469210505485535,
        "recall": 0.9469197392463684,
        "f1-score": 0.9469026923179626,
        "specificity": 0.9941315054893494
    },
    "accuracy": 0.9471641182899475,
    "auc_roc_scores": {
        "Angioectasia": 0.9981739521026611,
        "Bleeding": 0.9991731643676758,
        "Erosion": 0.9910417199134827,
        "Erythema": 0.996963620185852,
        "Foreign Body": 0.9994004964828491,
        "Lymphangiectasia": 0.9992751479148865,
        "Normal": 0.9967360496520996,
        "Polyp": 0.997545599937439,
        "Ulcer": 0.999967098236084,
        "Worms": 0.999930202960968
    },
    "mean_auc": 0.9978206753730774,
    "average_precision_scores": {
        "Angioectasia": 0.9869132041931152,
        "Bleeding": 0.9929420351982117,
        "Erosion": 0.9405156373977661,
        "Erythema": 0.975536584854126,
        "Foreign Body": 0.9955830574035645,
        "Lymphangiectasia": 0.9948657751083374,
        "Normal": 0.9794577360153198,
        "Polyp": 0.9820845127105713,
        "Ulcer": 0.9997093677520752,
        "Worms": 0.999798059463501
    },
    "mean_average_precision": 0.984740674495697,
    "mean_f1_score": 0.9469026923179626,
    "mean_specificity": 0.9941315054893494,
    "mean_sensitivity": 0.9469197392463684,
    "balanced_accuracy": 0.9469197392463684
}
2024-10-20 16:46:57,645 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7696850299835205,
        "recall": 0.786720335483551,
        "f1-score": 0.7781094312667847,
        "specificity": 0.992516815662384
    },
    "Bleeding": {
        "precision": 0.7393364906311035,
        "recall": 0.8690807819366455,
        "f1-score": 0.7989756464958191,
        "specificity": 0.993026077747345
    },
    "Erosion": {
        "precision": 0.6402438879013062,
        "recall": 0.7272727489471436,
        "f1-score": 0.6809890270233154,
        "specificity": 0.9684849977493286
    },
    "Erythema": {
        "precision": 0.45922747254371643,
        "recall": 0.7205387353897095,
        "f1-score": 0.5609436631202698,
        "specificity": 0.9840858578681946
    },
    "Foreign Body": {
        "precision": 0.6792035102844238,
        "recall": 0.9029411673545837,
        "f1-score": 0.7752525210380554,
        "specificity": 0.9908181428909302
    },
    "Lymphangiectasia": {
        "precision": 0.6784922480583191,
        "recall": 0.8921282887458801,
        "f1-score": 0.7707808613777161,
        "specificity": 0.9908164143562317
    },
    "Normal": {
        "precision": 0.9865366220474243,
        "recall": 0.9303328990936279,
        "f1-score": 0.9576107859611511,
        "specificity": 0.9594278335571289
    },
    "Polyp": {
        "precision": 0.5914742350578308,
        "recall": 0.6660000085830688,
        "f1-score": 0.6265286803245544,
        "specificity": 0.9852865934371948
    },
    "Ulcer": {
        "precision": 0.9240924119949341,
        "recall": 0.9790209531784058,
        "f1-score": 0.950764000415802,
        "specificity": 0.9985485076904297
    },
    "Worms": {
        "precision": 0.9852941036224365,
        "recall": 0.9852941036224365,
        "f1-score": 0.9852941036224365,
        "specificity": 0.9999377727508545
    },
    "macro avg": {
        "precision": 0.7453586459159851,
        "recall": 0.8459329605102539,
        "f1-score": 0.788524866104126,
        "specificity": 0.9862949252128601
    },
    "accuracy": 0.8976568579673767,
    "auc_roc_scores": {
        "Angioectasia": 0.980474591255188,
        "Bleeding": 0.9897115230560303,
        "Erosion": 0.9698896408081055,
        "Erythema": 0.9769308567047119,
        "Foreign Body": 0.990843653678894,
        "Lymphangiectasia": 0.9853764176368713,
        "Normal": 0.9890022873878479,
        "Polyp": 0.9743387699127197,
        "Ulcer": 0.9988869428634644,
        "Worms": 0.9999377727508545
    },
    "mean_auc": 0.9855392575263977,
    "average_precision_scores": {
        "Angioectasia": 0.8538376092910767,
        "Bleeding": 0.8892544507980347,
        "Erosion": 0.7721987366676331,
        "Erythema": 0.637235164642334,
        "Foreign Body": 0.9175896048545837,
        "Lymphangiectasia": 0.8942329287528992,
        "Normal": 0.9965324401855469,
        "Polyp": 0.6857248544692993,
        "Ulcer": 0.9881546497344971,
        "Worms": 0.9923210740089417
    },
    "mean_average_precision": 0.8627082109451294,
    "mean_f1_score": 0.788524866104126,
    "mean_specificity": 0.9862949252128601,
    "mean_sensitivity": 0.8459329605102539,
    "balanced_accuracy": 0.8459329605102539
}
2024-10-20 16:46:57,646 - DeiT - INFO - train_loss: 0.0669 | train_acc: 0.9472 | test_loss: 0.1741 | test_acc: 0.8977
2024-10-20 16:46:58,441 - DeiT - INFO - Best model saved with combined score: 0.9157 (Mean AUC: 0.9855, Balanced Accuracy: 0.8459)
2024-10-20 16:46:58,443 - DeiT - INFO - Epoch 8/20
2024-10-20 17:00:17,814 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9491570591926575,
        "recall": 0.945110559463501,
        "f1-score": 0.947129487991333,
        "specificity": 0.994387686252594
    },
    "Bleeding": {
        "precision": 0.953770637512207,
        "recall": 0.9634751081466675,
        "f1-score": 0.9585983157157898,
        "specificity": 0.9947000741958618
    },
    "Erosion": {
        "precision": 0.8836148977279663,
        "recall": 0.8700818419456482,
        "f1-score": 0.8767961859703064,
        "specificity": 0.9871673583984375
    },
    "Erythema": {
        "precision": 0.9261018633842468,
        "recall": 0.9339898824691772,
        "f1-score": 0.9300291538238525,
        "specificity": 0.9917281866073608
    },
    "Foreign Body": {
        "precision": 0.9696652889251709,
        "recall": 0.9739952683448792,
        "f1-score": 0.9718254208564758,
        "specificity": 0.9965680241584778
    },
    "Lymphangiectasia": {
        "precision": 0.9698113203048706,
        "recall": 0.9698113203048706,
        "f1-score": 0.9698113203048706,
        "specificity": 0.996695876121521
    },
    "Normal": {
        "precision": 0.947828471660614,
        "recall": 0.9343026280403137,
        "f1-score": 0.9410169720649719,
        "specificity": 0.9943646192550659
    },
    "Polyp": {
        "precision": 0.9341003894805908,
        "recall": 0.9439746141433716,
        "f1-score": 0.9390115737915039,
        "specificity": 0.9925494194030762
    },
    "Ulcer": {
        "precision": 0.9962736368179321,
        "recall": 0.99521404504776,
        "f1-score": 0.9957435727119446,
        "specificity": 0.9995863437652588
    },
    "Worms": {
        "precision": 0.9959503412246704,
        "recall": 0.9967576265335083,
        "f1-score": 0.996353805065155,
        "specificity": 0.999557614326477
    },
    "macro avg": {
        "precision": 0.9526273608207703,
        "recall": 0.952671229839325,
        "f1-score": 0.9526315927505493,
        "specificity": 0.9947305917739868
    },
    "accuracy": 0.9525886178016663,
    "auc_roc_scores": {
        "Angioectasia": 0.9982991218566895,
        "Bleeding": 0.9992770552635193,
        "Erosion": 0.9921662211418152,
        "Erythema": 0.997771143913269,
        "Foreign Body": 0.9995219111442566,
        "Lymphangiectasia": 0.9994276762008667,
        "Normal": 0.9965274333953857,
        "Polyp": 0.9982015490531921,
        "Ulcer": 0.999989926815033,
        "Worms": 0.9999922513961792
    },
    "mean_auc": 0.9981174468994141,
    "average_precision_scores": {
        "Angioectasia": 0.988304853439331,
        "Bleeding": 0.9938202500343323,
        "Erosion": 0.9481452703475952,
        "Erythema": 0.9798693656921387,
        "Foreign Body": 0.9965416193008423,
        "Lymphangiectasia": 0.9956459999084473,
        "Normal": 0.9820905327796936,
        "Polyp": 0.9846065044403076,
        "Ulcer": 0.9999105334281921,
        "Worms": 0.9999290108680725
    },
    "mean_average_precision": 0.9868864417076111,
    "mean_f1_score": 0.9526315927505493,
    "mean_specificity": 0.9947305917739868,
    "mean_sensitivity": 0.952671229839325,
    "balanced_accuracy": 0.952671229839325
}
2024-10-20 17:00:17,815 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6843065619468689,
        "recall": 0.7545271515846252,
        "f1-score": 0.7177033424377441,
        "specificity": 0.9889350533485413
    },
    "Bleeding": {
        "precision": 0.6015325784683228,
        "recall": 0.8746517896652222,
        "f1-score": 0.7128263115882874,
        "specificity": 0.9868128895759583
    },
    "Erosion": {
        "precision": 0.671665370464325,
        "recall": 0.7367965579032898,
        "f1-score": 0.7027249932289124,
        "specificity": 0.9722240567207336
    },
    "Erythema": {
        "precision": 0.530386745929718,
        "recall": 0.6464646458625793,
        "f1-score": 0.5827010869979858,
        "specificity": 0.9892643094062805
    },
    "Foreign Body": {
        "precision": 0.524429976940155,
        "recall": 0.9470587968826294,
        "f1-score": 0.6750524044036865,
        "specificity": 0.9815096259117126
    },
    "Lymphangiectasia": {
        "precision": 0.5335752964019775,
        "recall": 0.8571428656578064,
        "f1-score": 0.6577181220054626,
        "specificity": 0.9837228655815125
    },
    "Normal": {
        "precision": 0.9916125535964966,
        "recall": 0.8948482275009155,
        "f1-score": 0.9407486915588379,
        "specificity": 0.9758127331733704
    },
    "Polyp": {
        "precision": 0.47204160690307617,
        "recall": 0.7260000109672546,
        "f1-score": 0.5721040368080139,
        "specificity": 0.9740276336669922
    },
    "Ulcer": {
        "precision": 0.8303571343421936,
        "recall": 0.9755244851112366,
        "f1-score": 0.8971061110496521,
        "specificity": 0.9964028596878052
    },
    "Worms": {
        "precision": 0.8799999952316284,
        "recall": 0.970588207244873,
        "f1-score": 0.9230769276618958,
        "specificity": 0.9994397163391113
    },
    "macro avg": {
        "precision": 0.6719908118247986,
        "recall": 0.8383602499961853,
        "f1-score": 0.7381762862205505,
        "specificity": 0.984815239906311
    },
    "accuracy": 0.8710017204284668,
    "auc_roc_scores": {
        "Angioectasia": 0.9690148234367371,
        "Bleeding": 0.9817100763320923,
        "Erosion": 0.9725728631019592,
        "Erythema": 0.9673447012901306,
        "Foreign Body": 0.9922930002212524,
        "Lymphangiectasia": 0.9831139445304871,
        "Normal": 0.9880139231681824,
        "Polyp": 0.9717055559158325,
        "Ulcer": 0.9979186058044434,
        "Worms": 0.9999240636825562
    },
    "mean_auc": 0.9823611378669739,
    "average_precision_scores": {
        "Angioectasia": 0.8101608753204346,
        "Bleeding": 0.8744468688964844,
        "Erosion": 0.802503228187561,
        "Erythema": 0.6165062785148621,
        "Foreign Body": 0.9357560276985168,
        "Lymphangiectasia": 0.8286530375480652,
        "Normal": 0.9962693452835083,
        "Polyp": 0.6349582076072693,
        "Ulcer": 0.9777299165725708,
        "Worms": 0.9890538454055786
    },
    "mean_average_precision": 0.8466038107872009,
    "mean_f1_score": 0.7381762862205505,
    "mean_specificity": 0.984815239906311,
    "mean_sensitivity": 0.8383602499961853,
    "balanced_accuracy": 0.8383602499961853
}
2024-10-20 17:00:17,818 - DeiT - INFO - train_loss: 0.0594 | train_acc: 0.9526 | test_loss: 0.2201 | test_acc: 0.8710
2024-10-20 17:00:17,819 - DeiT - INFO - No improvement for 1 consecutive epochs.
2024-10-20 17:00:17,823 - DeiT - INFO - Epoch 9/20
2024-10-20 17:13:35,943 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9493025541305542,
        "recall": 0.9510884284973145,
        "f1-score": 0.9501946568489075,
        "specificity": 0.9944224953651428
    },
    "Bleeding": {
        "precision": 0.953825831413269,
        "recall": 0.9652870297431946,
        "f1-score": 0.9595222473144531,
        "specificity": 0.9948319792747498
    },
    "Erosion": {
        "precision": 0.887597918510437,
        "recall": 0.8713527917861938,
        "f1-score": 0.879400372505188,
        "specificity": 0.9877057671546936
    },
    "Erythema": {
        "precision": 0.9259159564971924,
        "recall": 0.9370229244232178,
        "f1-score": 0.93143630027771,
        "specificity": 0.9918972253799438
    },
    "Foreign Body": {
        "precision": 0.9685863852500916,
        "recall": 0.9744535088539124,
        "f1-score": 0.9715110659599304,
        "specificity": 0.9964507818222046
    },
    "Lymphangiectasia": {
        "precision": 0.9753944873809814,
        "recall": 0.9733119606971741,
        "f1-score": 0.9743521213531494,
        "specificity": 0.9972829222679138
    },
    "Normal": {
        "precision": 0.953809380531311,
        "recall": 0.9366527795791626,
        "f1-score": 0.9451532363891602,
        "specificity": 0.9948476552963257
    },
    "Polyp": {
        "precision": 0.9403921365737915,
        "recall": 0.9480758905410767,
        "f1-score": 0.9442183971405029,
        "specificity": 0.9932570457458496
    },
    "Ulcer": {
        "precision": 0.9958311915397644,
        "recall": 0.995312511920929,
        "f1-score": 0.9955717921257019,
        "specificity": 0.9995261430740356
    },
    "Worms": {
        "precision": 0.9972877502441406,
        "recall": 0.9967470765113831,
        "f1-score": 0.9970173239707947,
        "specificity": 0.9997051954269409
    },
    "macro avg": {
        "precision": 0.9547943472862244,
        "recall": 0.9549304842948914,
        "f1-score": 0.9548377990722656,
        "specificity": 0.994992733001709
    },
    "accuracy": 0.9549285769462585,
    "auc_roc_scores": {
        "Angioectasia": 0.9987126588821411,
        "Bleeding": 0.9993711709976196,
        "Erosion": 0.9932880401611328,
        "Erythema": 0.9979853630065918,
        "Foreign Body": 0.9995877742767334,
        "Lymphangiectasia": 0.9994958639144897,
        "Normal": 0.9973831176757812,
        "Polyp": 0.9983004927635193,
        "Ulcer": 0.9999676942825317,
        "Worms": 0.9999947547912598
    },
    "mean_auc": 0.9984087347984314,
    "average_precision_scores": {
        "Angioectasia": 0.9900897741317749,
        "Bleeding": 0.9945849180221558,
        "Erosion": 0.9546842575073242,
        "Erythema": 0.9821768403053284,
        "Foreign Body": 0.9968277215957642,
        "Lymphangiectasia": 0.9963919520378113,
        "Normal": 0.985140323638916,
        "Polyp": 0.9867024421691895,
        "Ulcer": 0.9997595548629761,
        "Worms": 0.9999522566795349
    },
    "mean_average_precision": 0.9886309504508972,
    "mean_f1_score": 0.9548377990722656,
    "mean_specificity": 0.994992733001709,
    "mean_sensitivity": 0.9549304842948914,
    "balanced_accuracy": 0.9549304842948914
}
2024-10-20 17:13:35,945 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6925734281539917,
        "recall": 0.8068410754203796,
        "f1-score": 0.7453531622886658,
        "specificity": 0.9886152744293213
    },
    "Bleeding": {
        "precision": 0.7788944840431213,
        "recall": 0.8635097742080688,
        "f1-score": 0.8190224766731262,
        "specificity": 0.9944208264350891
    },
    "Erosion": {
        "precision": 0.6031957268714905,
        "recall": 0.784415602684021,
        "f1-score": 0.6819721460342407,
        "specificity": 0.9602056741714478
    },
    "Erythema": {
        "precision": 0.5412843823432922,
        "recall": 0.5959596037864685,
        "f1-score": 0.567307710647583,
        "specificity": 0.990527331829071
    },
    "Foreign Body": {
        "precision": 0.7630922794342041,
        "recall": 0.8999999761581421,
        "f1-score": 0.8259109258651733,
        "specificity": 0.9939842820167542
    },
    "Lymphangiectasia": {
        "precision": 0.5733082890510559,
        "recall": 0.8892128467559814,
        "f1-score": 0.6971428394317627,
        "specificity": 0.9856228828430176
    },
    "Normal": {
        "precision": 0.9887436032295227,
        "recall": 0.9293562173843384,
        "f1-score": 0.9581305384635925,
        "specificity": 0.9661898612976074
    },
    "Polyp": {
        "precision": 0.6612903475761414,
        "recall": 0.656000018119812,
        "f1-score": 0.6586345434188843,
        "specificity": 0.9892528057098389
    },
    "Ulcer": {
        "precision": 0.9805447459220886,
        "recall": 0.881118893623352,
        "f1-score": 0.9281768202781677,
        "specificity": 0.9996844530105591
    },
    "Worms": {
        "precision": 0.7362637519836426,
        "recall": 0.9852941036224365,
        "f1-score": 0.8427672982215881,
        "specificity": 0.9985059499740601
    },
    "macro avg": {
        "precision": 0.7319191098213196,
        "recall": 0.829170823097229,
        "f1-score": 0.7724418044090271,
        "specificity": 0.9867009520530701
    },
    "accuracy": 0.8970369696617126,
    "auc_roc_scores": {
        "Angioectasia": 0.9829199314117432,
        "Bleeding": 0.9871616363525391,
        "Erosion": 0.9670026302337646,
        "Erythema": 0.9657448530197144,
        "Foreign Body": 0.9909301996231079,
        "Lymphangiectasia": 0.984380841255188,
        "Normal": 0.9902931451797485,
        "Polyp": 0.9765702486038208,
        "Ulcer": 0.9962563514709473,
        "Worms": 0.9997683763504028
    },
    "mean_auc": 0.9841028451919556,
    "average_precision_scores": {
        "Angioectasia": 0.8585198521614075,
        "Bleeding": 0.8981126546859741,
        "Erosion": 0.7712646126747131,
        "Erythema": 0.6001691222190857,
        "Foreign Body": 0.9244822859764099,
        "Lymphangiectasia": 0.8773567080497742,
        "Normal": 0.9969794750213623,
        "Polyp": 0.7327322959899902,
        "Ulcer": 0.9636207222938538,
        "Worms": 0.9779967069625854
    },
    "mean_average_precision": 0.8601234555244446,
    "mean_f1_score": 0.7724418044090271,
    "mean_specificity": 0.9867009520530701,
    "mean_sensitivity": 0.829170823097229,
    "balanced_accuracy": 0.829170823097229
}
2024-10-20 17:13:35,946 - DeiT - INFO - train_loss: 0.0549 | train_acc: 0.9549 | test_loss: 0.1768 | test_acc: 0.8970
2024-10-20 17:13:35,947 - DeiT - INFO - No improvement for 2 consecutive epochs.
2024-10-20 17:13:35,949 - DeiT - INFO - Epoch 10/20
2024-10-20 17:26:56,620 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9575226306915283,
        "recall": 0.9564741253852844,
        "f1-score": 0.9569981098175049,
        "specificity": 0.9954349994659424
    },
    "Bleeding": {
        "precision": 0.9626384973526001,
        "recall": 0.9708939790725708,
        "f1-score": 0.9667485952377319,
        "specificity": 0.9957048296928406
    },
    "Erosion": {
        "precision": 0.907046914100647,
        "recall": 0.8904441595077515,
        "f1-score": 0.8986688256263733,
        "specificity": 0.9899976253509521
    },
    "Erythema": {
        "precision": 0.9298902750015259,
        "recall": 0.9427563548088074,
        "f1-score": 0.9362791180610657,
        "specificity": 0.9922761917114258
    },
    "Foreign Body": {
        "precision": 0.9759565591812134,
        "recall": 0.9774728417396545,
        "f1-score": 0.9767140746116638,
        "specificity": 0.9972440600395203
    },
    "Lymphangiectasia": {
        "precision": 0.9802033305168152,
        "recall": 0.9765458703041077,
        "f1-score": 0.9783711433410645,
        "specificity": 0.9978141784667969
    },
    "Normal": {
        "precision": 0.9565807580947876,
        "recall": 0.9458009004592896,
        "f1-score": 0.9511602520942688,
        "specificity": 0.995277464389801
    },
    "Polyp": {
        "precision": 0.9455445408821106,
        "recall": 0.9552513957023621,
        "f1-score": 0.9503731727600098,
        "specificity": 0.9938180446624756
    },
    "Ulcer": {
        "precision": 0.9966057538986206,
        "recall": 0.9966057538986206,
        "f1-score": 0.9966057538986206,
        "specificity": 0.9996151328086853
    },
    "Worms": {
        "precision": 0.9991965889930725,
        "recall": 0.9989290237426758,
        "f1-score": 0.9990627765655518,
        "specificity": 0.9999114274978638
    },
    "macro avg": {
        "precision": 0.9611186385154724,
        "recall": 0.9611174464225769,
        "f1-score": 0.9610981941223145,
        "specificity": 0.9957094192504883
    },
    "accuracy": 0.9613635540008545,
    "auc_roc_scores": {
        "Angioectasia": 0.9991176128387451,
        "Bleeding": 0.9995662569999695,
        "Erosion": 0.9950351119041443,
        "Erythema": 0.9982494711875916,
        "Foreign Body": 0.9997724294662476,
        "Lymphangiectasia": 0.9996814131736755,
        "Normal": 0.9981176853179932,
        "Polyp": 0.998871386051178,
        "Ulcer": 0.9999929070472717,
        "Worms": 0.9999979734420776
    },
    "mean_auc": 0.9988401532173157,
    "average_precision_scores": {
        "Angioectasia": 0.9926776885986328,
        "Bleeding": 0.9961691498756409,
        "Erosion": 0.9664876461029053,
        "Erythema": 0.9843295812606812,
        "Foreign Body": 0.998011589050293,
        "Lymphangiectasia": 0.9978525638580322,
        "Normal": 0.9893140196800232,
        "Polyp": 0.9897282719612122,
        "Ulcer": 0.9999395608901978,
        "Worms": 0.9999816417694092
    },
    "mean_average_precision": 0.9914491772651672,
    "mean_f1_score": 0.9610981941223145,
    "mean_specificity": 0.9957094192504883,
    "mean_sensitivity": 0.9611174464225769,
    "balanced_accuracy": 0.9611174464225769
}
2024-10-20 17:26:56,622 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.6416275501251221,
        "recall": 0.8249496817588806,
        "f1-score": 0.7218309640884399,
        "specificity": 0.9853533506393433
    },
    "Bleeding": {
        "precision": 0.6889848709106445,
        "recall": 0.8885793685913086,
        "f1-score": 0.7761557102203369,
        "specificity": 0.990870475769043
    },
    "Erosion": {
        "precision": 0.6960203051567078,
        "recall": 0.7116883397102356,
        "f1-score": 0.7037671208381653,
        "specificity": 0.9760299324989319
    },
    "Erythema": {
        "precision": 0.4964539110660553,
        "recall": 0.7070707082748413,
        "f1-score": 0.5833333134651184,
        "specificity": 0.9865487813949585
    },
    "Foreign Body": {
        "precision": 0.5288135409355164,
        "recall": 0.9176470637321472,
        "f1-score": 0.6709677577018738,
        "specificity": 0.982396125793457
    },
    "Lymphangiectasia": {
        "precision": 0.621564507484436,
        "recall": 0.8571428656578064,
        "f1-score": 0.720588207244873,
        "specificity": 0.9886630177497864
    },
    "Normal": {
        "precision": 0.9886084794998169,
        "recall": 0.9182062149047852,
        "f1-score": 0.9521076679229736,
        "specificity": 0.9661898612976074
    },
    "Polyp": {
        "precision": 0.5880398750305176,
        "recall": 0.7080000042915344,
        "f1-score": 0.6424682140350342,
        "specificity": 0.984135091304779
    },
    "Ulcer": {
        "precision": 0.9604316353797913,
        "recall": 0.9335664510726929,
        "f1-score": 0.9468085169792175,
        "specificity": 0.9993058443069458
    },
    "Worms": {
        "precision": 0.9436619877815247,
        "recall": 0.9852941036224365,
        "f1-score": 0.9640287756919861,
        "specificity": 0.9997509717941284
    },
    "macro avg": {
        "precision": 0.715420663356781,
        "recall": 0.8452144861221313,
        "f1-score": 0.7682056427001953,
        "specificity": 0.9859243631362915
    },
    "accuracy": 0.8887304663658142,
    "auc_roc_scores": {
        "Angioectasia": 0.9790018200874329,
        "Bleeding": 0.9877463579177856,
        "Erosion": 0.9694645404815674,
        "Erythema": 0.976933479309082,
        "Foreign Body": 0.9872206449508667,
        "Lymphangiectasia": 0.9878501892089844,
        "Normal": 0.9898395538330078,
        "Polyp": 0.9758419990539551,
        "Ulcer": 0.9952771067619324,
        "Worms": 0.9999798536300659
    },
    "mean_auc": 0.984915554523468,
    "average_precision_scores": {
        "Angioectasia": 0.8451787829399109,
        "Bleeding": 0.8965681195259094,
        "Erosion": 0.7856221199035645,
        "Erythema": 0.6196966171264648,
        "Foreign Body": 0.9104517102241516,
        "Lymphangiectasia": 0.860736072063446,
        "Normal": 0.9967759251594543,
        "Polyp": 0.7083961963653564,
        "Ulcer": 0.9710357189178467,
        "Worms": 0.9964052438735962
    },
    "mean_average_precision": 0.8590866327285767,
    "mean_f1_score": 0.7682056427001953,
    "mean_specificity": 0.9859243631362915,
    "mean_sensitivity": 0.8452144861221313,
    "balanced_accuracy": 0.8452144861221313
}
2024-10-20 17:26:56,623 - DeiT - INFO - train_loss: 0.0432 | train_acc: 0.9614 | test_loss: 0.1847 | test_acc: 0.8887
2024-10-20 17:26:56,624 - DeiT - INFO - No improvement for 3 consecutive epochs.
2024-10-20 17:26:56,626 - DeiT - INFO - Epoch 11/20
2024-10-20 17:40:16,338 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9651923775672913,
        "recall": 0.9654450416564941,
        "f1-score": 0.9653186798095703,
        "specificity": 0.9960635900497437
    },
    "Bleeding": {
        "precision": 0.9676401019096375,
        "recall": 0.9737887382507324,
        "f1-score": 0.9707046747207642,
        "specificity": 0.996364176273346
    },
    "Erosion": {
        "precision": 0.9140560030937195,
        "recall": 0.8976313471794128,
        "f1-score": 0.9057692289352417,
        "specificity": 0.990864634513855
    },
    "Erythema": {
        "precision": 0.934241533279419,
        "recall": 0.9476481676101685,
        "f1-score": 0.9408971071243286,
        "specificity": 0.9925836324691772
    },
    "Foreign Body": {
        "precision": 0.9739845991134644,
        "recall": 0.9783999919891357,
        "f1-score": 0.9761872887611389,
        "specificity": 0.9971054792404175
    },
    "Lymphangiectasia": {
        "precision": 0.975832462310791,
        "recall": 0.9781965017318726,
        "f1-score": 0.9770130515098572,
        "specificity": 0.9973444938659668
    },
    "Normal": {
        "precision": 0.9636460542678833,
        "recall": 0.9514383673667908,
        "f1-score": 0.9575033187866211,
        "specificity": 0.9959784746170044
    },
    "Polyp": {
        "precision": 0.9510489702224731,
        "recall": 0.9528428912162781,
        "f1-score": 0.9519450664520264,
        "specificity": 0.9946306347846985
    },
    "Ulcer": {
        "precision": 0.9968253970146179,
        "recall": 0.997089147567749,
        "f1-score": 0.9969572424888611,
        "specificity": 0.9996452927589417
    },
    "Worms": {
        "precision": 0.9989559054374695,
        "recall": 0.9992167353630066,
        "f1-score": 0.9990862607955933,
        "specificity": 0.9998815655708313
    },
    "macro avg": {
        "precision": 0.9641423225402832,
        "recall": 0.9641696810722351,
        "f1-score": 0.9641382098197937,
        "specificity": 0.996046245098114
    },
    "accuracy": 0.9643949270248413,
    "auc_roc_scores": {
        "Angioectasia": 0.9994193315505981,
        "Bleeding": 0.9996163845062256,
        "Erosion": 0.9960256814956665,
        "Erythema": 0.998691201210022,
        "Foreign Body": 0.9996957778930664,
        "Lymphangiectasia": 0.9997323751449585,
        "Normal": 0.9982945919036865,
        "Polyp": 0.9990979433059692,
        "Ulcer": 0.9999872446060181,
        "Worms": 0.9999993443489075
    },
    "mean_auc": 0.9990559816360474,
    "average_precision_scores": {
        "Angioectasia": 0.9952850341796875,
        "Bleeding": 0.9967962503433228,
        "Erosion": 0.9705895185470581,
        "Erythema": 0.9879145622253418,
        "Foreign Body": 0.9977561235427856,
        "Lymphangiectasia": 0.9978148937225342,
        "Normal": 0.9901360869407654,
        "Polyp": 0.9922648668289185,
        "Ulcer": 0.999904990196228,
        "Worms": 0.9999947547912598
    },
    "mean_average_precision": 0.9928457140922546,
    "mean_f1_score": 0.9641382098197937,
    "mean_specificity": 0.996046245098114,
    "mean_sensitivity": 0.9641696810722351,
    "balanced_accuracy": 0.9641696810722351
}
2024-10-20 17:40:16,339 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.759036123752594,
        "recall": 0.7605633735656738,
        "f1-score": 0.7597990036010742,
        "specificity": 0.9923248887062073
    },
    "Bleeding": {
        "precision": 0.6458752751350403,
        "recall": 0.89415043592453,
        "f1-score": 0.75,
        "specificity": 0.988841712474823
    },
    "Erosion": {
        "precision": 0.6140231490135193,
        "recall": 0.7809523940086365,
        "f1-score": 0.6875,
        "specificity": 0.9621419310569763
    },
    "Erythema": {
        "precision": 0.4922737181186676,
        "recall": 0.7508417367935181,
        "f1-score": 0.5946666598320007,
        "specificity": 0.9854752421379089
    },
    "Foreign Body": {
        "precision": 0.8931750655174255,
        "recall": 0.8852941393852234,
        "f1-score": 0.8892171382904053,
        "specificity": 0.9977203607559204
    },
    "Lymphangiectasia": {
        "precision": 0.8194444179534912,
        "recall": 0.8600583076477051,
        "f1-score": 0.8392603397369385,
        "specificity": 0.9958832263946533
    },
    "Normal": {
        "precision": 0.9920297861099243,
        "recall": 0.9319605827331543,
        "f1-score": 0.9610574841499329,
        "specificity": 0.9760728478431702
    },
    "Polyp": {
        "precision": 0.5679611563682556,
        "recall": 0.7020000219345093,
        "f1-score": 0.6279069781303406,
        "specificity": 0.9829196333885193
    },
    "Ulcer": {
        "precision": 0.9551724195480347,
        "recall": 0.9685314893722534,
        "f1-score": 0.9618055820465088,
        "specificity": 0.9991796016693115
    },
    "Worms": {
        "precision": 0.9850746393203735,
        "recall": 0.970588207244873,
        "f1-score": 0.9777777791023254,
        "specificity": 0.9999377727508545
    },
    "macro avg": {
        "precision": 0.7724065780639648,
        "recall": 0.8504940271377563,
        "f1-score": 0.8048991560935974,
        "specificity": 0.9880496859550476
    },
    "accuracy": 0.9028638601303101,
    "auc_roc_scores": {
        "Angioectasia": 0.9756444692611694,
        "Bleeding": 0.9903203248977661,
        "Erosion": 0.971619725227356,
        "Erythema": 0.9772019386291504,
        "Foreign Body": 0.991050660610199,
        "Lymphangiectasia": 0.9921442270278931,
        "Normal": 0.9918414354324341,
        "Polyp": 0.9761139750480652,
        "Ulcer": 0.99909508228302,
        "Worms": 0.9999945163726807
    },
    "mean_auc": 0.9865026473999023,
    "average_precision_scores": {
        "Angioectasia": 0.8260139226913452,
        "Bleeding": 0.9021012783050537,
        "Erosion": 0.7899621725082397,
        "Erythema": 0.6108487844467163,
        "Foreign Body": 0.9377756118774414,
        "Lymphangiectasia": 0.9099944829940796,
        "Normal": 0.997472882270813,
        "Polyp": 0.7069861888885498,
        "Ulcer": 0.9885118007659912,
        "Worms": 0.9987472295761108
    },
    "mean_average_precision": 0.8668414354324341,
    "mean_f1_score": 0.8048991560935974,
    "mean_specificity": 0.9880496859550476,
    "mean_sensitivity": 0.8504940271377563,
    "balanced_accuracy": 0.8504940271377563
}
2024-10-20 17:40:16,340 - DeiT - INFO - train_loss: 0.0392 | train_acc: 0.9644 | test_loss: 0.1732 | test_acc: 0.9029
2024-10-20 17:40:17,098 - DeiT - INFO - Best model saved with combined score: 0.9185 (Mean AUC: 0.9865, Balanced Accuracy: 0.8505)
2024-10-20 17:40:17,100 - DeiT - INFO - Epoch 12/20
2024-10-20 17:53:34,614 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9668874144554138,
        "recall": 0.9702286124229431,
        "f1-score": 0.9685551524162292,
        "specificity": 0.9963067173957825
    },
    "Bleeding": {
        "precision": 0.9623135328292847,
        "recall": 0.9719799160957336,
        "f1-score": 0.9671225547790527,
        "specificity": 0.995742678642273
    },
    "Erosion": {
        "precision": 0.9339103102684021,
        "recall": 0.9201550483703613,
        "f1-score": 0.9269816279411316,
        "specificity": 0.9925304651260376
    },
    "Erythema": {
        "precision": 0.9435654282569885,
        "recall": 0.9559177160263062,
        "f1-score": 0.9497013688087463,
        "specificity": 0.9936805963516235
    },
    "Foreign Body": {
        "precision": 0.9746901988983154,
        "recall": 0.9757192134857178,
        "f1-score": 0.9752044081687927,
        "specificity": 0.9971612691879272
    },
    "Lymphangiectasia": {
        "precision": 0.9766082167625427,
        "recall": 0.9745358228683472,
        "f1-score": 0.9755709171295166,
        "specificity": 0.9973992705345154
    },
    "Normal": {
        "precision": 0.9726141095161438,
        "recall": 0.9549158215522766,
        "f1-score": 0.9636837244033813,
        "specificity": 0.9970818161964417
    },
    "Polyp": {
        "precision": 0.9540106654167175,
        "recall": 0.9619843363761902,
        "f1-score": 0.9579809308052063,
        "specificity": 0.9949259757995605
    },
    "Ulcer": {
        "precision": 0.9986677169799805,
        "recall": 0.9981358051300049,
        "f1-score": 0.9984017014503479,
        "specificity": 0.9998522996902466
    },
    "Worms": {
        "precision": 0.9991984963417053,
        "recall": 0.9989316463470459,
        "f1-score": 0.9990650415420532,
        "specificity": 0.9999114274978638
    },
    "macro avg": {
        "precision": 0.9682466387748718,
        "recall": 0.9682503938674927,
        "f1-score": 0.9682268500328064,
        "specificity": 0.9964593052864075
    },
    "accuracy": 0.9681442379951477,
    "auc_roc_scores": {
        "Angioectasia": 0.999518871307373,
        "Bleeding": 0.9995542764663696,
        "Erosion": 0.9971193075180054,
        "Erythema": 0.9990260601043701,
        "Foreign Body": 0.9997027516365051,
        "Lymphangiectasia": 0.9997508525848389,
        "Normal": 0.9986910223960876,
        "Polyp": 0.9992564916610718,
        "Ulcer": 0.9999987483024597,
        "Worms": 0.999999463558197
    },
    "mean_auc": 0.9992617964744568,
    "average_precision_scores": {
        "Angioectasia": 0.996060311794281,
        "Bleeding": 0.996605396270752,
        "Erosion": 0.9790422916412354,
        "Erythema": 0.9912610650062561,
        "Foreign Body": 0.9978559017181396,
        "Lymphangiectasia": 0.998083233833313,
        "Normal": 0.9919983744621277,
        "Polyp": 0.9937127828598022,
        "Ulcer": 0.9999884366989136,
        "Worms": 0.9999951124191284
    },
    "mean_average_precision": 0.9944602847099304,
    "mean_f1_score": 0.9682268500328064,
    "mean_specificity": 0.9964593052864075,
    "mean_sensitivity": 0.9682503938674927,
    "balanced_accuracy": 0.9682503938674927
}
2024-10-20 17:53:34,615 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.784466028213501,
        "recall": 0.8128772377967834,
        "f1-score": 0.7984189987182617,
        "specificity": 0.992900550365448
    },
    "Bleeding": {
        "precision": 0.7488038539886475,
        "recall": 0.8718662858009338,
        "f1-score": 0.8056628108024597,
        "specificity": 0.9933430552482605
    },
    "Erosion": {
        "precision": 0.6548148393630981,
        "recall": 0.7653679847717285,
        "f1-score": 0.7057884335517883,
        "specificity": 0.968885600566864
    },
    "Erythema": {
        "precision": 0.5422740578651428,
        "recall": 0.6262626051902771,
        "f1-score": 0.581250011920929,
        "specificity": 0.990085244178772
    },
    "Foreign Body": {
        "precision": 0.8446327447891235,
        "recall": 0.8794117569923401,
        "f1-score": 0.8616714477539062,
        "specificity": 0.9965172410011292
    },
    "Lymphangiectasia": {
        "precision": 0.6928406357765198,
        "recall": 0.8746355772018433,
        "f1-score": 0.7731958627700806,
        "specificity": 0.9915764331817627
    },
    "Normal": {
        "precision": 0.9866907000541687,
        "recall": 0.9352160692214966,
        "f1-score": 0.9602640867233276,
        "specificity": 0.9596878886222839
    },
    "Polyp": {
        "precision": 0.6382978558540344,
        "recall": 0.7200000286102295,
        "f1-score": 0.6766917109489441,
        "specificity": 0.9869498610496521
    },
    "Ulcer": {
        "precision": 0.6318181753158569,
        "recall": 0.9720279574394226,
        "f1-score": 0.7658402323722839,
        "specificity": 0.989776611328125
    },
    "Worms": {
        "precision": 0.95652174949646,
        "recall": 0.970588207244873,
        "f1-score": 0.9635036587715149,
        "specificity": 0.9998132586479187
    },
    "macro avg": {
        "precision": 0.748116135597229,
        "recall": 0.8428254127502441,
        "f1-score": 0.7892287373542786,
        "specificity": 0.9869535565376282
    },
    "accuracy": 0.9038556814193726,
    "auc_roc_scores": {
        "Angioectasia": 0.9782495498657227,
        "Bleeding": 0.9900096654891968,
        "Erosion": 0.9683758616447449,
        "Erythema": 0.9674303531646729,
        "Foreign Body": 0.9854476451873779,
        "Lymphangiectasia": 0.9913038611412048,
        "Normal": 0.9898951649665833,
        "Polyp": 0.978425920009613,
        "Ulcer": 0.9985668063163757,
        "Worms": 0.9977927803993225
    },
    "mean_auc": 0.9845497012138367,
    "average_precision_scores": {
        "Angioectasia": 0.8611904978752136,
        "Bleeding": 0.9092664122581482,
        "Erosion": 0.7883082032203674,
        "Erythema": 0.6315492987632751,
        "Foreign Body": 0.918938398361206,
        "Lymphangiectasia": 0.8958805799484253,
        "Normal": 0.996871829032898,
        "Polyp": 0.7544491291046143,
        "Ulcer": 0.9702228307723999,
        "Worms": 0.9829083681106567
    },
    "mean_average_precision": 0.8709585070610046,
    "mean_f1_score": 0.7892287373542786,
    "mean_specificity": 0.9869535565376282,
    "mean_sensitivity": 0.8428254127502441,
    "balanced_accuracy": 0.8428254127502441
}
2024-10-20 17:53:34,616 - DeiT - INFO - train_loss: 0.0346 | train_acc: 0.9681 | test_loss: 0.1724 | test_acc: 0.9039
2024-10-20 17:53:34,617 - DeiT - INFO - No improvement for 1 consecutive epochs.
2024-10-20 17:53:34,620 - DeiT - INFO - Epoch 13/20
2024-10-20 18:06:55,594 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9655172228813171,
        "recall": 0.9701137542724609,
        "f1-score": 0.9678100347518921,
        "specificity": 0.9961272478103638
    },
    "Bleeding": {
        "precision": 0.9601805210113525,
        "recall": 0.9712674617767334,
        "f1-score": 0.9656921625137329,
        "specificity": 0.9955729842185974
    },
    "Erosion": {
        "precision": 0.9350828528404236,
        "recall": 0.9116617441177368,
        "f1-score": 0.9232237935066223,
        "specificity": 0.9930666089057922
    },
    "Erythema": {
        "precision": 0.9453145265579224,
        "recall": 0.960354745388031,
        "f1-score": 0.952775239944458,
        "specificity": 0.9936931729316711
    },
    "Foreign Body": {
        "precision": 0.9755144715309143,
        "recall": 0.9813941121101379,
        "f1-score": 0.9784454703330994,
        "specificity": 0.9972181916236877
    },
    "Lymphangiectasia": {
        "precision": 0.9815013408660889,
        "recall": 0.9788770079612732,
        "f1-score": 0.9801874160766602,
        "specificity": 0.9979625940322876
    },
    "Normal": {
        "precision": 0.9783711433410645,
        "recall": 0.9670097827911377,
        "f1-score": 0.9726572632789612,
        "specificity": 0.9976048469543457
    },
    "Polyp": {
        "precision": 0.963208019733429,
        "recall": 0.9644845128059387,
        "f1-score": 0.9638458490371704,
        "specificity": 0.9958916902542114
    },
    "Ulcer": {
        "precision": 0.9991852045059204,
        "recall": 0.9989139437675476,
        "f1-score": 0.9990495443344116,
        "specificity": 0.9999115467071533
    },
    "Worms": {
        "precision": 0.9997334480285645,
        "recall": 0.9992008805274963,
        "f1-score": 0.9994670748710632,
        "specificity": 0.9999704360961914
    },
    "macro avg": {
        "precision": 0.9703608751296997,
        "recall": 0.9703277945518494,
        "f1-score": 0.9703153967857361,
        "specificity": 0.9967020153999329
    },
    "accuracy": 0.970324695110321,
    "auc_roc_scores": {
        "Angioectasia": 0.9996017217636108,
        "Bleeding": 0.9995956420898438,
        "Erosion": 0.9972753524780273,
        "Erythema": 0.9991611838340759,
        "Foreign Body": 0.9997917413711548,
        "Lymphangiectasia": 0.999856173992157,
        "Normal": 0.9991046786308289,
        "Polyp": 0.9993389248847961,
        "Ulcer": 0.9999986886978149,
        "Worms": 0.9999995231628418
    },
    "mean_auc": 0.9993724226951599,
    "average_precision_scores": {
        "Angioectasia": 0.9966612458229065,
        "Bleeding": 0.9963573217391968,
        "Erosion": 0.9792990684509277,
        "Erythema": 0.9925610423088074,
        "Foreign Body": 0.9983046650886536,
        "Lymphangiectasia": 0.9988361597061157,
        "Normal": 0.9946495294570923,
        "Polyp": 0.9946272969245911,
        "Ulcer": 0.9999881982803345,
        "Worms": 0.9999960660934448
    },
    "mean_average_precision": 0.9951280951499939,
    "mean_f1_score": 0.9703153967857361,
    "mean_specificity": 0.9967020153999329,
    "mean_sensitivity": 0.9703277945518494,
    "balanced_accuracy": 0.9703277945518494
}
2024-10-20 18:06:55,596 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.7791411280632019,
        "recall": 0.7665995955467224,
        "f1-score": 0.772819459438324,
        "specificity": 0.99309241771698
    },
    "Bleeding": {
        "precision": 0.8042327761650085,
        "recall": 0.8467966318130493,
        "f1-score": 0.8249660730361938,
        "specificity": 0.9953084588050842
    },
    "Erosion": {
        "precision": 0.7050359845161438,
        "recall": 0.7636363506317139,
        "f1-score": 0.7331671118736267,
        "specificity": 0.975362241268158
    },
    "Erythema": {
        "precision": 0.4977477490901947,
        "recall": 0.744107723236084,
        "f1-score": 0.5964912176132202,
        "specificity": 0.9859172701835632
    },
    "Foreign Body": {
        "precision": 0.8607954382896423,
        "recall": 0.8911764621734619,
        "f1-score": 0.8757225275039673,
        "specificity": 0.9968971610069275
    },
    "Lymphangiectasia": {
        "precision": 0.8477011322975159,
        "recall": 0.8600583076477051,
        "f1-score": 0.8538350462913513,
        "specificity": 0.9966432452201843
    },
    "Normal": {
        "precision": 0.9836448431015015,
        "recall": 0.9593879580497742,
        "f1-score": 0.9713649749755859,
        "specificity": 0.9490247368812561
    },
    "Polyp": {
        "precision": 0.6594488024711609,
        "recall": 0.6700000166893005,
        "f1-score": 0.6646825671195984,
        "specificity": 0.9889329671859741
    },
    "Ulcer": {
        "precision": 0.915032684803009,
        "recall": 0.9790209531784058,
        "f1-score": 0.9459459185600281,
        "specificity": 0.998359203338623
    },
    "Worms": {
        "precision": 0.9166666865348816,
        "recall": 0.970588207244873,
        "f1-score": 0.9428571462631226,
        "specificity": 0.9996265172958374
    },
    "macro avg": {
        "precision": 0.7969447374343872,
        "recall": 0.8451372385025024,
        "f1-score": 0.8181852698326111,
        "specificity": 0.9879164099693298
    },
    "accuracy": 0.9208405613899231,
    "auc_roc_scores": {
        "Angioectasia": 0.98771071434021,
        "Bleeding": 0.9915276169776917,
        "Erosion": 0.9776050448417664,
        "Erythema": 0.9776426553726196,
        "Foreign Body": 0.9923306703567505,
        "Lymphangiectasia": 0.9946480989456177,
        "Normal": 0.9927624464035034,
        "Polyp": 0.9797767400741577,
        "Ulcer": 0.9990943670272827,
        "Worms": 0.9994817972183228
    },
    "mean_auc": 0.9892579913139343,
    "average_precision_scores": {
        "Angioectasia": 0.8586018681526184,
        "Bleeding": 0.9137723445892334,
        "Erosion": 0.8207100033760071,
        "Erythema": 0.6814907789230347,
        "Foreign Body": 0.9351414442062378,
        "Lymphangiectasia": 0.9252891540527344,
        "Normal": 0.9977644085884094,
        "Polyp": 0.7324155569076538,
        "Ulcer": 0.9889236092567444,
        "Worms": 0.9844323396682739
    },
    "mean_average_precision": 0.88385409116745,
    "mean_f1_score": 0.8181852698326111,
    "mean_specificity": 0.9879164099693298,
    "mean_sensitivity": 0.8451372385025024,
    "balanced_accuracy": 0.8451372385025024
}
2024-10-20 18:06:55,597 - DeiT - INFO - train_loss: 0.0298 | train_acc: 0.9703 | test_loss: 0.1454 | test_acc: 0.9208
2024-10-20 18:06:55,598 - DeiT - INFO - No improvement for 2 consecutive epochs.
2024-10-20 18:06:55,601 - DeiT - INFO - Epoch 14/20
2024-10-20 18:20:15,280 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9734098315238953,
        "recall": 0.9756990075111389,
        "f1-score": 0.9745530486106873,
        "specificity": 0.9969804883003235
    },
    "Bleeding": {
        "precision": 0.9666579961776733,
        "recall": 0.9747833013534546,
        "f1-score": 0.970703661441803,
        "specificity": 0.9962130188941956
    },
    "Erosion": {
        "precision": 0.9434523582458496,
        "recall": 0.9205385446548462,
        "f1-score": 0.9318546056747437,
        "specificity": 0.993820071220398
    },
    "Erythema": {
        "precision": 0.9449999928474426,
        "recall": 0.9640268683433533,
        "f1-score": 0.9544185996055603,
        "specificity": 0.9938315153121948
    },
    "Foreign Body": {
        "precision": 0.9796404242515564,
        "recall": 0.982758641242981,
        "f1-score": 0.9811970591545105,
        "specificity": 0.9977244138717651
    },
    "Lymphangiectasia": {
        "precision": 0.9833560585975647,
        "recall": 0.9817488193511963,
        "f1-score": 0.9825518131256104,
        "specificity": 0.9982025027275085
    },
    "Normal": {
        "precision": 0.9778481125831604,
        "recall": 0.969158411026001,
        "f1-score": 0.9734838604927063,
        "specificity": 0.9975134134292603
    },
    "Polyp": {
        "precision": 0.9637389183044434,
        "recall": 0.9650349617004395,
        "f1-score": 0.964386522769928,
        "specificity": 0.9960163831710815
    },
    "Ulcer": {
        "precision": 0.9986606240272522,
        "recall": 0.9989281892776489,
        "f1-score": 0.9987943768501282,
        "specificity": 0.9998524188995361
    },
    "Worms": {
        "precision": 0.9994654059410095,
        "recall": 0.998931348323822,
        "f1-score": 0.999198317527771,
        "specificity": 0.9999409317970276
    },
    "macro avg": {
        "precision": 0.9731230139732361,
        "recall": 0.9731607437133789,
        "f1-score": 0.9731141924858093,
        "specificity": 0.9970094561576843
    },
    "accuracy": 0.9730901122093201,
    "auc_roc_scores": {
        "Angioectasia": 0.9997324347496033,
        "Bleeding": 0.9996827840805054,
        "Erosion": 0.997687041759491,
        "Erythema": 0.9992677569389343,
        "Foreign Body": 0.9998663067817688,
        "Lymphangiectasia": 0.999882698059082,
        "Normal": 0.9991567134857178,
        "Polyp": 0.99952232837677,
        "Ulcer": 0.9999992251396179,
        "Worms": 0.9999998807907104
    },
    "mean_auc": 0.9994797110557556,
    "average_precision_scores": {
        "Angioectasia": 0.9977993965148926,
        "Bleeding": 0.9971950054168701,
        "Erosion": 0.9833440780639648,
        "Erythema": 0.9931796193122864,
        "Foreign Body": 0.9988511800765991,
        "Lymphangiectasia": 0.9989672899246216,
        "Normal": 0.9949465990066528,
        "Polyp": 0.9958451986312866,
        "Ulcer": 0.9999929070472717,
        "Worms": 0.9999982714653015
    },
    "mean_average_precision": 0.9960119128227234,
    "mean_f1_score": 0.9731141924858093,
    "mean_specificity": 0.9970094561576843,
    "mean_sensitivity": 0.9731607437133789,
    "balanced_accuracy": 0.9731607437133789
}
2024-10-20 18:20:15,282 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.8243801593780518,
        "recall": 0.8028169274330139,
        "f1-score": 0.8134556412696838,
        "specificity": 0.9945634603500366
    },
    "Bleeding": {
        "precision": 0.8181818127632141,
        "recall": 0.8523676991462708,
        "f1-score": 0.8349249362945557,
        "specificity": 0.9956888556480408
    },
    "Erosion": {
        "precision": 0.7015163898468018,
        "recall": 0.7610389590263367,
        "f1-score": 0.7300664186477661,
        "specificity": 0.975028395652771
    },
    "Erythema": {
        "precision": 0.5957446694374084,
        "recall": 0.6599326729774475,
        "f1-score": 0.6261980533599854,
        "specificity": 0.9916008710861206
    },
    "Foreign Body": {
        "precision": 0.8469945192337036,
        "recall": 0.9117646813392639,
        "f1-score": 0.8781869411468506,
        "specificity": 0.9964538812637329
    },
    "Lymphangiectasia": {
        "precision": 0.8474576473236084,
        "recall": 0.8746355772018433,
        "f1-score": 0.860832154750824,
        "specificity": 0.9965798854827881
    },
    "Normal": {
        "precision": 0.9828988909721375,
        "recall": 0.9636200666427612,
        "f1-score": 0.9731640219688416,
        "specificity": 0.9464239478111267
    },
    "Polyp": {
        "precision": 0.6309314370155334,
        "recall": 0.7179999947547913,
        "f1-score": 0.6716557741165161,
        "specificity": 0.9865660071372986
    },
    "Ulcer": {
        "precision": 0.9651567935943604,
        "recall": 0.9685314893722534,
        "f1-score": 0.9668411612510681,
        "specificity": 0.9993689060211182
    },
    "Worms": {
        "precision": 0.9428571462631226,
        "recall": 0.970588207244873,
        "f1-score": 0.95652174949646,
        "specificity": 0.9997509717941284
    },
    "macro avg": {
        "precision": 0.8156119585037231,
        "recall": 0.8483296632766724,
        "f1-score": 0.8311846852302551,
        "specificity": 0.9882025122642517
    },
    "accuracy": 0.9256137013435364,
    "auc_roc_scores": {
        "Angioectasia": 0.9865374565124512,
        "Bleeding": 0.9902665019035339,
        "Erosion": 0.975731372833252,
        "Erythema": 0.977928102016449,
        "Foreign Body": 0.9939662218093872,
        "Lymphangiectasia": 0.9932656288146973,
        "Normal": 0.9934475421905518,
        "Polyp": 0.9814167618751526,
        "Ulcer": 0.9983728528022766,
        "Worms": 0.9993042349815369
    },
    "mean_auc": 0.9890236854553223,
    "average_precision_scores": {
        "Angioectasia": 0.878960907459259,
        "Bleeding": 0.9121509790420532,
        "Erosion": 0.8195120096206665,
        "Erythema": 0.6665468811988831,
        "Foreign Body": 0.9409335255622864,
        "Lymphangiectasia": 0.919906497001648,
        "Normal": 0.997980535030365,
        "Polyp": 0.7426973581314087,
        "Ulcer": 0.9836748838424683,
        "Worms": 0.9846914410591125
    },
    "mean_average_precision": 0.8847055435180664,
    "mean_f1_score": 0.8311846852302551,
    "mean_specificity": 0.9882025122642517,
    "mean_sensitivity": 0.8483296632766724,
    "balanced_accuracy": 0.8483296632766724
}
2024-10-20 18:20:15,283 - DeiT - INFO - train_loss: 0.0258 | train_acc: 0.9731 | test_loss: 0.1424 | test_acc: 0.9256
2024-10-20 18:20:15,961 - DeiT - INFO - Best model saved with combined score: 0.9187 (Mean AUC: 0.9890, Balanced Accuracy: 0.8483)
2024-10-20 18:20:15,963 - DeiT - INFO - Epoch 15/20
2024-10-20 18:33:34,930 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9761137962341309,
        "recall": 0.9766380190849304,
        "f1-score": 0.9763758182525635,
        "specificity": 0.9973733425140381
    },
    "Bleeding": {
        "precision": 0.9673113822937012,
        "recall": 0.9790460467338562,
        "f1-score": 0.9731433391571045,
        "specificity": 0.9964684844017029
    },
    "Erosion": {
        "precision": 0.9485254883766174,
        "recall": 0.9196776747703552,
        "f1-score": 0.9338788390159607,
        "specificity": 0.9943128228187561
    },
    "Erythema": {
        "precision": 0.9506612420082092,
        "recall": 0.9696497917175293,
        "f1-score": 0.9600616693496704,
        "specificity": 0.9942522048950195
    },
    "Foreign Body": {
        "precision": 0.9753186702728271,
        "recall": 0.9833196401596069,
        "f1-score": 0.9793028235435486,
        "specificity": 0.9973195791244507
    },
    "Lymphangiectasia": {
        "precision": 0.9840755462646484,
        "recall": 0.9838100671768188,
        "f1-score": 0.9839428067207336,
        "specificity": 0.9982596635818481
    },
    "Normal": {
        "precision": 0.9828586578369141,
        "recall": 0.9736154675483704,
        "f1-score": 0.978215217590332,
        "specificity": 0.9980757236480713
    },
    "Polyp": {
        "precision": 0.9691861867904663,
        "recall": 0.9689310193061829,
        "f1-score": 0.9690585732460022,
        "specificity": 0.9965393543243408
    },
    "Ulcer": {
        "precision": 0.9981427192687988,
        "recall": 0.9986726641654968,
        "f1-score": 0.9984076619148254,
        "specificity": 0.9997931718826294
    },
    "Worms": {
        "precision": 0.9994733929634094,
        "recall": 0.9994733929634094,
        "f1-score": 0.9994733929634094,
        "specificity": 0.9999408721923828
    },
    "macro avg": {
        "precision": 0.9751667380332947,
        "recall": 0.9752834439277649,
        "f1-score": 0.9751859903335571,
        "specificity": 0.9972335696220398
    },
    "accuracy": 0.9751110076904297,
    "auc_roc_scores": {
        "Angioectasia": 0.9997249245643616,
        "Bleeding": 0.9997459650039673,
        "Erosion": 0.9978352785110474,
        "Erythema": 0.9994235038757324,
        "Foreign Body": 0.9998450875282288,
        "Lymphangiectasia": 0.9999135732650757,
        "Normal": 0.9994596242904663,
        "Polyp": 0.9996552467346191,
        "Ulcer": 0.9999991655349731,
        "Worms": 0.9999998807907104
    },
    "mean_auc": 0.9995602965354919,
    "average_precision_scores": {
        "Angioectasia": 0.997726559638977,
        "Bleeding": 0.9976610541343689,
        "Erosion": 0.9844011068344116,
        "Erythema": 0.9949448108673096,
        "Foreign Body": 0.9985747933387756,
        "Lymphangiectasia": 0.9992435574531555,
        "Normal": 0.9966055154800415,
        "Polyp": 0.9970855712890625,
        "Ulcer": 0.999993085861206,
        "Worms": 0.9999991059303284
    },
    "mean_average_precision": 0.9966235160827637,
    "mean_f1_score": 0.9751859903335571,
    "mean_specificity": 0.9972335696220398,
    "mean_sensitivity": 0.9752834439277649,
    "balanced_accuracy": 0.9752834439277649
}
2024-10-20 18:33:34,931 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.8275862336158752,
        "recall": 0.772635817527771,
        "f1-score": 0.7991675138473511,
        "specificity": 0.9948832988739014
    },
    "Bleeding": {
        "precision": 0.8410958647727966,
        "recall": 0.8551532030105591,
        "f1-score": 0.8480662703514099,
        "specificity": 0.9963228106498718
    },
    "Erosion": {
        "precision": 0.6937073469161987,
        "recall": 0.7922077775001526,
        "f1-score": 0.7396928071975708,
        "specificity": 0.9730253219604492
    },
    "Erythema": {
        "precision": 0.6241829991340637,
        "recall": 0.6430976390838623,
        "f1-score": 0.6334991455078125,
        "specificity": 0.9927375912666321
    },
    "Foreign Body": {
        "precision": 0.8516483306884766,
        "recall": 0.9117646813392639,
        "f1-score": 0.8806818127632141,
        "specificity": 0.9965805411338806
    },
    "Lymphangiectasia": {
        "precision": 0.8405796885490417,
        "recall": 0.8454810380935669,
        "f1-score": 0.8430232405662537,
        "specificity": 0.9965165853500366
    },
    "Normal": {
        "precision": 0.9829469919204712,
        "recall": 0.9663872122764587,
        "f1-score": 0.9745967984199524,
        "specificity": 0.9464239478111267
    },
    "Polyp": {
        "precision": 0.649350643157959,
        "recall": 0.699999988079071,
        "f1-score": 0.6737247109413147,
        "specificity": 0.9879094362258911
    },
    "Ulcer": {
        "precision": 0.9684210419654846,
        "recall": 0.9650349617004395,
        "f1-score": 0.9667250514030457,
        "specificity": 0.9994320273399353
    },
    "Worms": {
        "precision": 0.9846153855323792,
        "recall": 0.9411764740943909,
        "f1-score": 0.9624060392379761,
        "specificity": 0.9999377727508545
    },
    "macro avg": {
        "precision": 0.8264134526252747,
        "recall": 0.839293897151947,
        "f1-score": 0.8321582674980164,
        "specificity": 0.9883769154548645
    },
    "accuracy": 0.9274113774299622,
    "auc_roc_scores": {
        "Angioectasia": 0.984813928604126,
        "Bleeding": 0.9918190240859985,
        "Erosion": 0.9777747392654419,
        "Erythema": 0.9747785329818726,
        "Foreign Body": 0.993133544921875,
        "Lymphangiectasia": 0.9934068918228149,
        "Normal": 0.9941012263298035,
        "Polyp": 0.9794980883598328,
        "Ulcer": 0.9998462200164795,
        "Worms": 0.9997820854187012
    },
    "mean_auc": 0.9888954162597656,
    "average_precision_scores": {
        "Angioectasia": 0.8698643445968628,
        "Bleeding": 0.9221664071083069,
        "Erosion": 0.8244776725769043,
        "Erythema": 0.6743251085281372,
        "Foreign Body": 0.946361780166626,
        "Lymphangiectasia": 0.9156301617622375,
        "Normal": 0.9981817007064819,
        "Polyp": 0.7421074509620667,
        "Ulcer": 0.9931292533874512,
        "Worms": 0.9859467148780823
    },
    "mean_average_precision": 0.8872190713882446,
    "mean_f1_score": 0.8321582674980164,
    "mean_specificity": 0.9883769154548645,
    "mean_sensitivity": 0.839293897151947,
    "balanced_accuracy": 0.839293897151947
}
2024-10-20 18:33:34,932 - DeiT - INFO - train_loss: 0.0232 | train_acc: 0.9751 | test_loss: 0.1395 | test_acc: 0.9274
2024-10-20 18:33:34,933 - DeiT - INFO - No improvement for 1 consecutive epochs.
2024-10-20 18:33:34,934 - DeiT - INFO - Epoch 16/20
2024-10-20 18:46:54,379 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9807435274124146,
        "recall": 0.9786495566368103,
        "f1-score": 0.9796954393386841,
        "specificity": 0.9978736042976379
    },
    "Bleeding": {
        "precision": 0.9650924205780029,
        "recall": 0.9773849844932556,
        "f1-score": 0.9711998105049133,
        "specificity": 0.9959715604782104
    },
    "Erosion": {
        "precision": 0.9626522064208984,
        "recall": 0.9362990260124207,
        "f1-score": 0.949292778968811,
        "specificity": 0.9959181547164917
    },
    "Erythema": {
        "precision": 0.9476759433746338,
        "recall": 0.9677244424819946,
        "f1-score": 0.9575952887535095,
        "specificity": 0.9941922426223755
    },
    "Foreign Body": {
        "precision": 0.9790940880775452,
        "recall": 0.9841055870056152,
        "f1-score": 0.9815934300422668,
        "specificity": 0.9976987838745117
    },
    "Lymphangiectasia": {
        "precision": 0.9870365858078003,
        "recall": 0.9867807030677795,
        "f1-score": 0.9869086146354675,
        "specificity": 0.9985184669494629
    },
    "Normal": {
        "precision": 0.9889867901802063,
        "recall": 0.9790133833885193,
        "f1-score": 0.983974814414978,
        "specificity": 0.9988213777542114
    },
    "Polyp": {
        "precision": 0.9736204743385315,
        "recall": 0.974669873714447,
        "f1-score": 0.9741448760032654,
        "specificity": 0.9971088171005249
    },
    "Ulcer": {
        "precision": 0.9992179274559021,
        "recall": 0.9992179274559021,
        "f1-score": 0.9992179274559021,
        "specificity": 0.9999111890792847
    },
    "Worms": {
        "precision": 0.9997326731681824,
        "recall": 0.9997326731681824,
        "f1-score": 0.9997326731681824,
        "specificity": 0.9999704957008362
    },
    "macro avg": {
        "precision": 0.9783853888511658,
        "recall": 0.9783579111099243,
        "f1-score": 0.9783355593681335,
        "specificity": 0.9975984692573547
    },
    "accuracy": 0.9783816933631897,
    "auc_roc_scores": {
        "Angioectasia": 0.9998328685760498,
        "Bleeding": 0.9997521638870239,
        "Erosion": 0.9986164569854736,
        "Erythema": 0.9994627833366394,
        "Foreign Body": 0.9998839497566223,
        "Lymphangiectasia": 0.9999168515205383,
        "Normal": 0.9996554851531982,
        "Polyp": 0.9997619390487671,
        "Ulcer": 0.9999997019767761,
        "Worms": 0.9999998211860657
    },
    "mean_auc": 0.9996882677078247,
    "average_precision_scores": {
        "Angioectasia": 0.9985573291778564,
        "Bleeding": 0.9978270530700684,
        "Erosion": 0.989905834197998,
        "Erythema": 0.9950211644172668,
        "Foreign Body": 0.9989548325538635,
        "Lymphangiectasia": 0.9993124008178711,
        "Normal": 0.9975293278694153,
        "Polyp": 0.9979131817817688,
        "Ulcer": 0.9999978542327881,
        "Worms": 0.9999985098838806
    },
    "mean_average_precision": 0.997501790523529,
    "mean_f1_score": 0.9783355593681335,
    "mean_specificity": 0.9975984692573547,
    "mean_sensitivity": 0.9783579111099243,
    "balanced_accuracy": 0.9783579111099243
}
2024-10-20 18:46:54,381 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.8170478343963623,
        "recall": 0.7907444834709167,
        "f1-score": 0.803680956363678,
        "specificity": 0.9943715929985046
    },
    "Bleeding": {
        "precision": 0.8222222328186035,
        "recall": 0.8245125412940979,
        "f1-score": 0.8233658075332642,
        "specificity": 0.9959424138069153
    },
    "Erosion": {
        "precision": 0.7156473398208618,
        "recall": 0.7800865769386292,
        "f1-score": 0.7464788556098938,
        "specificity": 0.9760966897010803
    },
    "Erythema": {
        "precision": 0.6526315808296204,
        "recall": 0.6262626051902771,
        "f1-score": 0.6391752362251282,
        "specificity": 0.9937480092048645
    },
    "Foreign Body": {
        "precision": 0.8474114537239075,
        "recall": 0.9147058725357056,
        "f1-score": 0.8797736763954163,
        "specificity": 0.9964538812637329
    },
    "Lymphangiectasia": {
        "precision": 0.9102166891098022,
        "recall": 0.8571428656578064,
        "f1-score": 0.8828828930854797,
        "specificity": 0.9981632828712463
    },
    "Normal": {
        "precision": 0.9794464707374573,
        "recall": 0.9734678864479065,
        "f1-score": 0.9764479994773865,
        "specificity": 0.9347203969955444
    },
    "Polyp": {
        "precision": 0.7054108381271362,
        "recall": 0.7039999961853027,
        "f1-score": 0.7047047019004822,
        "specificity": 0.9905962347984314
    },
    "Ulcer": {
        "precision": 0.9750889539718628,
        "recall": 0.9580419659614563,
        "f1-score": 0.9664903283119202,
        "specificity": 0.9995582699775696
    },
    "Worms": {
        "precision": 0.9846153855323792,
        "recall": 0.9411764740943909,
        "f1-score": 0.9624060392379761,
        "specificity": 0.9999377727508545
    },
    "macro avg": {
        "precision": 0.8409738540649414,
        "recall": 0.8370141386985779,
        "f1-score": 0.8385406732559204,
        "specificity": 0.9879589080810547
    },
    "accuracy": 0.9318125247955322,
    "auc_roc_scores": {
        "Angioectasia": 0.9850503206253052,
        "Bleeding": 0.9924476146697998,
        "Erosion": 0.976219654083252,
        "Erythema": 0.9809978604316711,
        "Foreign Body": 0.9921755790710449,
        "Lymphangiectasia": 0.9947254657745361,
        "Normal": 0.9936560988426208,
        "Polyp": 0.9809665679931641,
        "Ulcer": 0.999160885810852,
        "Worms": 0.9992226958274841
    },
    "mean_auc": 0.9894623160362244,
    "average_precision_scores": {
        "Angioectasia": 0.8677740097045898,
        "Bleeding": 0.9079079627990723,
        "Erosion": 0.8291971683502197,
        "Erythema": 0.6723349690437317,
        "Foreign Body": 0.9428017735481262,
        "Lymphangiectasia": 0.9283049702644348,
        "Normal": 0.9980378150939941,
        "Polyp": 0.7582036256790161,
        "Ulcer": 0.9876918196678162,
        "Worms": 0.9832023978233337
    },
    "mean_average_precision": 0.8875457048416138,
    "mean_f1_score": 0.8385406732559204,
    "mean_specificity": 0.9879589080810547,
    "mean_sensitivity": 0.8370141386985779,
    "balanced_accuracy": 0.8370141386985779
}
2024-10-20 18:46:54,382 - DeiT - INFO - train_loss: 0.0192 | train_acc: 0.9784 | test_loss: 0.1405 | test_acc: 0.9318
2024-10-20 18:46:54,383 - DeiT - INFO - No improvement for 2 consecutive epochs.
2024-10-20 18:46:54,384 - DeiT - INFO - Epoch 17/20
2024-10-20 19:00:14,457 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9827120304107666,
        "recall": 0.9803287386894226,
        "f1-score": 0.9815189242362976,
        "specificity": 0.9981118440628052
    },
    "Bleeding": {
        "precision": 0.9648662805557251,
        "recall": 0.9808102250099182,
        "f1-score": 0.9727729558944702,
        "specificity": 0.9960419535636902
    },
    "Erosion": {
        "precision": 0.9611219167709351,
        "recall": 0.929377019405365,
        "f1-score": 0.9449829459190369,
        "specificity": 0.9958681464195251
    },
    "Erythema": {
        "precision": 0.9473684430122375,
        "recall": 0.9684154391288757,
        "f1-score": 0.9577763080596924,
        "specificity": 0.9940657019615173
    },
    "Foreign Body": {
        "precision": 0.9760192036628723,
        "recall": 0.9870654940605164,
        "f1-score": 0.9815112352371216,
        "specificity": 0.9973447918891907
    },
    "Lymphangiectasia": {
        "precision": 0.9869542121887207,
        "recall": 0.9851182699203491,
        "f1-score": 0.9860354065895081,
        "specificity": 0.9985522031784058
    },
    "Normal": {
        "precision": 0.9882227182388306,
        "recall": 0.9806109070777893,
        "f1-score": 0.984402060508728,
        "specificity": 0.9986998438835144
    },
    "Polyp": {
        "precision": 0.9742990732192993,
        "recall": 0.9702688455581665,
        "f1-score": 0.9722797870635986,
        "specificity": 0.9970657229423523
    },
    "Ulcer": {
        "precision": 0.9997380375862122,
        "recall": 0.9989528656005859,
        "f1-score": 0.9993453025817871,
        "specificity": 0.9999703764915466
    },
    "Worms": {
        "precision": 0.9997338056564331,
        "recall": 0.9997338056564331,
        "f1-score": 0.9997338056564331,
        "specificity": 0.9999704360961914
    },
    "macro avg": {
        "precision": 0.9781035780906677,
        "recall": 0.9780681729316711,
        "f1-score": 0.9780359268188477,
        "specificity": 0.9975690841674805
    },
    "accuracy": 0.9781157970428467,
    "auc_roc_scores": {
        "Angioectasia": 0.999884843826294,
        "Bleeding": 0.9997658133506775,
        "Erosion": 0.9984897971153259,
        "Erythema": 0.9994504451751709,
        "Foreign Body": 0.9998932480812073,
        "Lymphangiectasia": 0.9999395608901978,
        "Normal": 0.9996809959411621,
        "Polyp": 0.9997425079345703,
        "Ulcer": 0.9999983310699463,
        "Worms": 0.9999998807907104
    },
    "mean_auc": 0.9996845126152039,
    "average_precision_scores": {
        "Angioectasia": 0.9989944100379944,
        "Bleeding": 0.9978868961334229,
        "Erosion": 0.9883602857589722,
        "Erythema": 0.9950121641159058,
        "Foreign Body": 0.9990316033363342,
        "Lymphangiectasia": 0.9994643926620483,
        "Normal": 0.9980679154396057,
        "Polyp": 0.9978551268577576,
        "Ulcer": 0.9999858140945435,
        "Worms": 0.9999995827674866
    },
    "mean_average_precision": 0.9974657893180847,
    "mean_f1_score": 0.9780359268188477,
    "mean_specificity": 0.9975690841674805,
    "mean_sensitivity": 0.9780681729316711,
    "balanced_accuracy": 0.9780681729316711
}
2024-10-20 19:00:14,459 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.800804853439331,
        "recall": 0.800804853439331,
        "f1-score": 0.800804853439331,
        "specificity": 0.9936680793762207
    },
    "Bleeding": {
        "precision": 0.8364611268043518,
        "recall": 0.8690807819366455,
        "f1-score": 0.8524590134620667,
        "specificity": 0.9961326122283936
    },
    "Erosion": {
        "precision": 0.7277913689613342,
        "recall": 0.7731601595878601,
        "f1-score": 0.7497900724411011,
        "specificity": 0.9776991605758667
    },
    "Erythema": {
        "precision": 0.6401383876800537,
        "recall": 0.6228955984115601,
        "f1-score": 0.6313993334770203,
        "specificity": 0.9934322834014893
    },
    "Foreign Body": {
        "precision": 0.8563535809516907,
        "recall": 0.9117646813392639,
        "f1-score": 0.8831908702850342,
        "specificity": 0.9967072010040283
    },
    "Lymphangiectasia": {
        "precision": 0.8347339034080505,
        "recall": 0.8688046932220459,
        "f1-score": 0.8514285683631897,
        "specificity": 0.9962632060050964
    },
    "Normal": {
        "precision": 0.9800525307655334,
        "recall": 0.9716773629188538,
        "f1-score": 0.9758470058441162,
        "specificity": 0.936801016330719
    },
    "Polyp": {
        "precision": 0.7104722857475281,
        "recall": 0.6919999718666077,
        "f1-score": 0.7011144757270813,
        "specificity": 0.9909800291061401
    },
    "Ulcer": {
        "precision": 0.9586206674575806,
        "recall": 0.9720279574394226,
        "f1-score": 0.9652777910232544,
        "specificity": 0.9992427229881287
    },
    "Worms": {
        "precision": 0.9852941036224365,
        "recall": 0.9852941036224365,
        "f1-score": 0.9852941036224365,
        "specificity": 0.9999377727508545
    },
    "macro avg": {
        "precision": 0.833072304725647,
        "recall": 0.8467510342597961,
        "f1-score": 0.8396605849266052,
        "specificity": 0.9880864024162292
    },
    "accuracy": 0.9314405918121338,
    "auc_roc_scores": {
        "Angioectasia": 0.9887635707855225,
        "Bleeding": 0.9921749830245972,
        "Erosion": 0.9786853790283203,
        "Erythema": 0.973774254322052,
        "Foreign Body": 0.99348384141922,
        "Lymphangiectasia": 0.9938867092132568,
        "Normal": 0.9938946962356567,
        "Polyp": 0.9796339273452759,
        "Ulcer": 0.9998137354850769,
        "Worms": 0.9995056390762329
    },
    "mean_auc": 0.9893617033958435,
    "average_precision_scores": {
        "Angioectasia": 0.8775784373283386,
        "Bleeding": 0.9170809388160706,
        "Erosion": 0.8245930075645447,
        "Erythema": 0.6719416975975037,
        "Foreign Body": 0.9428654909133911,
        "Lymphangiectasia": 0.9205063581466675,
        "Normal": 0.9981327652931213,
        "Polyp": 0.7527839541435242,
        "Ulcer": 0.9928312301635742,
        "Worms": 0.9867252707481384
    },
    "mean_average_precision": 0.8885039687156677,
    "mean_f1_score": 0.8396605849266052,
    "mean_specificity": 0.9880864024162292,
    "mean_sensitivity": 0.8467510342597961,
    "balanced_accuracy": 0.8467510342597961
}
2024-10-20 19:00:14,460 - DeiT - INFO - train_loss: 0.0186 | train_acc: 0.9781 | test_loss: 0.1445 | test_acc: 0.9314
2024-10-20 19:00:14,461 - DeiT - INFO - No improvement for 3 consecutive epochs.
2024-10-20 19:00:14,464 - DeiT - INFO - Epoch 18/20
2024-10-20 19:13:34,784 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9794110059738159,
        "recall": 0.9817137122154236,
        "f1-score": 0.9805610179901123,
        "specificity": 0.997661292552948
    },
    "Bleeding": {
        "precision": 0.9686121940612793,
        "recall": 0.9841855764389038,
        "f1-score": 0.9763367772102356,
        "specificity": 0.9964215159416199
    },
    "Erosion": {
        "precision": 0.9679039716720581,
        "recall": 0.926034688949585,
        "f1-score": 0.9465065598487854,
        "specificity": 0.9966038465499878
    },
    "Erythema": {
        "precision": 0.9475616216659546,
        "recall": 0.9686411023139954,
        "f1-score": 0.9579854011535645,
        "specificity": 0.9940961003303528
    },
    "Foreign Body": {
        "precision": 0.9802597165107727,
        "recall": 0.9856359362602234,
        "f1-score": 0.9829404950141907,
        "specificity": 0.9977500438690186
    },
    "Lymphangiectasia": {
        "precision": 0.9867028594017029,
        "recall": 0.9861676096916199,
        "f1-score": 0.9864351749420166,
        "specificity": 0.9985554218292236
    },
    "Normal": {
        "precision": 0.9898768663406372,
        "recall": 0.9823513627052307,
        "f1-score": 0.9860997796058655,
        "specificity": 0.9989093542098999
    },
    "Polyp": {
        "precision": 0.9733472466468811,
        "recall": 0.9776902794837952,
        "f1-score": 0.9755139350891113,
        "specificity": 0.9969819784164429
    },
    "Ulcer": {
        "precision": 0.9994809031486511,
        "recall": 0.9994809031486511,
        "f1-score": 0.9994809031486511,
        "specificity": 0.9999407529830933
    },
    "Worms": {
        "precision": 0.999725878238678,
        "recall": 1.0,
        "f1-score": 0.9998629093170166,
        "specificity": 0.999970555305481
    },
    "macro avg": {
        "precision": 0.9792882800102234,
        "recall": 0.9791900515556335,
        "f1-score": 0.9791723489761353,
        "specificity": 0.9976890683174133
    },
    "accuracy": 0.9792060256004333,
    "auc_roc_scores": {
        "Angioectasia": 0.9998946189880371,
        "Bleeding": 0.9998178482055664,
        "Erosion": 0.9987682700157166,
        "Erythema": 0.9994470477104187,
        "Foreign Body": 0.999839186668396,
        "Lymphangiectasia": 0.9999534487724304,
        "Normal": 0.999701976776123,
        "Polyp": 0.9997981786727905,
        "Ulcer": 0.9999998807907104,
        "Worms": 1.0
    },
    "mean_auc": 0.9997221231460571,
    "average_precision_scores": {
        "Angioectasia": 0.9990931153297424,
        "Bleeding": 0.9983786344528198,
        "Erosion": 0.9902948141098022,
        "Erythema": 0.9949777722358704,
        "Foreign Body": 0.9989495277404785,
        "Lymphangiectasia": 0.9995801448822021,
        "Normal": 0.9981040954589844,
        "Polyp": 0.9982520937919617,
        "Ulcer": 0.9999990463256836,
        "Worms": 0.9999996423721313
    },
    "mean_average_precision": 0.9977628588676453,
    "mean_f1_score": 0.9791723489761353,
    "mean_specificity": 0.9976890683174133,
    "mean_sensitivity": 0.9791900515556335,
    "balanced_accuracy": 0.9791900515556335
}
2024-10-20 19:13:34,786 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.8577877879142761,
        "recall": 0.7645875215530396,
        "f1-score": 0.8085106611251831,
        "specificity": 0.995970606803894
    },
    "Bleeding": {
        "precision": 0.8365122675895691,
        "recall": 0.8551532030105591,
        "f1-score": 0.8457300066947937,
        "specificity": 0.9961960315704346
    },
    "Erosion": {
        "precision": 0.7370583415031433,
        "recall": 0.7766233682632446,
        "f1-score": 0.7563237547874451,
        "specificity": 0.9786338806152344
    },
    "Erythema": {
        "precision": 0.6338461637496948,
        "recall": 0.6936026811599731,
        "f1-score": 0.6623794436454773,
        "specificity": 0.992484986782074
    },
    "Foreign Body": {
        "precision": 0.8465753197669983,
        "recall": 0.908823549747467,
        "f1-score": 0.8765957355499268,
        "specificity": 0.9964538812637329
    },
    "Lymphangiectasia": {
        "precision": 0.8691860437393188,
        "recall": 0.8717201352119446,
        "f1-score": 0.8704512119293213,
        "specificity": 0.9971498847007751
    },
    "Normal": {
        "precision": 0.980498194694519,
        "recall": 0.9738748073577881,
        "f1-score": 0.9771752953529358,
        "specificity": 0.9381014108657837
    },
    "Polyp": {
        "precision": 0.71875,
        "recall": 0.7360000014305115,
        "f1-score": 0.7272727489471436,
        "specificity": 0.9907881021499634
    },
    "Ulcer": {
        "precision": 0.9719298481941223,
        "recall": 0.9685314893722534,
        "f1-score": 0.9702276587486267,
        "specificity": 0.9994951486587524
    },
    "Worms": {
        "precision": 0.9428571462631226,
        "recall": 0.970588207244873,
        "f1-score": 0.95652174949646,
        "specificity": 0.9997509717941284
    },
    "macro avg": {
        "precision": 0.8395000696182251,
        "recall": 0.851950466632843,
        "f1-score": 0.8451188206672668,
        "specificity": 0.9885025024414062
    },
    "accuracy": 0.9344780445098877,
    "auc_roc_scores": {
        "Angioectasia": 0.985649824142456,
        "Bleeding": 0.9920278787612915,
        "Erosion": 0.9786993861198425,
        "Erythema": 0.9800902605056763,
        "Foreign Body": 0.9926837682723999,
        "Lymphangiectasia": 0.9957928657531738,
        "Normal": 0.9944093227386475,
        "Polyp": 0.982064425945282,
        "Ulcer": 0.9998916983604431,
        "Worms": 0.9999405145645142
    },
    "mean_auc": 0.9901250004768372,
    "average_precision_scores": {
        "Angioectasia": 0.8747047185897827,
        "Bleeding": 0.9187850952148438,
        "Erosion": 0.8359402418136597,
        "Erythema": 0.689703106880188,
        "Foreign Body": 0.9436042308807373,
        "Lymphangiectasia": 0.9314451813697815,
        "Normal": 0.9982701539993286,
        "Polyp": 0.7811880111694336,
        "Ulcer": 0.9948877096176147,
        "Worms": 0.9904546141624451
    },
    "mean_average_precision": 0.8958983421325684,
    "mean_f1_score": 0.8451188206672668,
    "mean_specificity": 0.9885025024414062,
    "mean_sensitivity": 0.851950466632843,
    "balanced_accuracy": 0.851950466632843
}
2024-10-20 19:13:34,787 - DeiT - INFO - train_loss: 0.0165 | train_acc: 0.9792 | test_loss: 0.1362 | test_acc: 0.9345
2024-10-20 19:13:35,529 - DeiT - INFO - Best model saved with combined score: 0.9210 (Mean AUC: 0.9901, Balanced Accuracy: 0.8520)
2024-10-20 19:13:35,531 - DeiT - INFO - Epoch 19/20
2024-10-20 19:26:55,931 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9807844161987305,
        "recall": 0.9771833419799805,
        "f1-score": 0.978980541229248,
        "specificity": 0.9978398680686951
    },
    "Bleeding": {
        "precision": 0.9675118923187256,
        "recall": 0.9812483191490173,
        "f1-score": 0.9743316769599915,
        "specificity": 0.9963688850402832
    },
    "Erosion": {
        "precision": 0.9703221917152405,
        "recall": 0.929848313331604,
        "f1-score": 0.949654221534729,
        "specificity": 0.9969040155410767
    },
    "Erythema": {
        "precision": 0.9441884160041809,
        "recall": 0.9710373878479004,
        "f1-score": 0.9574247002601624,
        "specificity": 0.993552029132843
    },
    "Foreign Body": {
        "precision": 0.9759191870689392,
        "recall": 0.9838162064552307,
        "f1-score": 0.9798518419265747,
        "specificity": 0.9972465634346008
    },
    "Lymphangiectasia": {
        "precision": 0.9859002232551575,
        "recall": 0.9885807633399963,
        "f1-score": 0.9872386455535889,
        "specificity": 0.9984673857688904
    },
    "Normal": {
        "precision": 0.9910544753074646,
        "recall": 0.9846485257148743,
        "f1-score": 0.9878411293029785,
        "specificity": 0.999026358127594
    },
    "Polyp": {
        "precision": 0.9740056991577148,
        "recall": 0.9704739451408386,
        "f1-score": 0.9722366333007812,
        "specificity": 0.9970366954803467
    },
    "Ulcer": {
        "precision": 0.9992084503173828,
        "recall": 1.0,
        "f1-score": 0.9996040463447571,
        "specificity": 0.9999113082885742
    },
    "Worms": {
        "precision": 0.9994597434997559,
        "recall": 0.9997298121452332,
        "f1-score": 0.9995947480201721,
        "specificity": 0.9999409914016724
    },
    "macro avg": {
        "precision": 0.9788355231285095,
        "recall": 0.9786565899848938,
        "f1-score": 0.9786758422851562,
        "specificity": 0.9976293444633484
    },
    "accuracy": 0.9786741733551025,
    "auc_roc_scores": {
        "Angioectasia": 0.999862015247345,
        "Bleeding": 0.9997954368591309,
        "Erosion": 0.9987471103668213,
        "Erythema": 0.9994544982910156,
        "Foreign Body": 0.9998671412467957,
        "Lymphangiectasia": 0.9999281167984009,
        "Normal": 0.9997512698173523,
        "Polyp": 0.9997726678848267,
        "Ulcer": 1.0,
        "Worms": 0.9999998807907104
    },
    "mean_auc": 0.9997178316116333,
    "average_precision_scores": {
        "Angioectasia": 0.9988144636154175,
        "Bleeding": 0.9981459975242615,
        "Erosion": 0.9901688098907471,
        "Erythema": 0.9951416254043579,
        "Foreign Body": 0.9988298416137695,
        "Lymphangiectasia": 0.9993937611579895,
        "Normal": 0.9983375072479248,
        "Polyp": 0.998058557510376,
        "Ulcer": 0.9999997615814209,
        "Worms": 0.9999995231628418
    },
    "mean_average_precision": 0.9976889491081238,
    "mean_f1_score": 0.9786758422851562,
    "mean_specificity": 0.9976293444633484,
    "mean_sensitivity": 0.9786565899848938,
    "balanced_accuracy": 0.9786565899848938
}
2024-10-20 19:26:55,933 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.8059999942779541,
        "recall": 0.8108651638031006,
        "f1-score": 0.80842524766922,
        "specificity": 0.9937959909439087
    },
    "Bleeding": {
        "precision": 0.8472222089767456,
        "recall": 0.8495821952819824,
        "f1-score": 0.8484005331993103,
        "specificity": 0.9965130090713501
    },
    "Erosion": {
        "precision": 0.721439778804779,
        "recall": 0.7982683777809143,
        "f1-score": 0.7579120397567749,
        "specificity": 0.9762302041053772
    },
    "Erythema": {
        "precision": 0.6303630471229553,
        "recall": 0.6430976390838623,
        "f1-score": 0.6366666555404663,
        "specificity": 0.992927074432373
    },
    "Foreign Body": {
        "precision": 0.8850574493408203,
        "recall": 0.9058823585510254,
        "f1-score": 0.895348846912384,
        "specificity": 0.9974671006202698
    },
    "Lymphangiectasia": {
        "precision": 0.8600000143051147,
        "recall": 0.8775510191917419,
        "f1-score": 0.868686854839325,
        "specificity": 0.9968965649604797
    },
    "Normal": {
        "precision": 0.9823984503746033,
        "recall": 0.9720843434333801,
        "f1-score": 0.9772141575813293,
        "specificity": 0.9443433284759521
    },
    "Polyp": {
        "precision": 0.7295082211494446,
        "recall": 0.7120000123977661,
        "f1-score": 0.7206477522850037,
        "specificity": 0.9915558099746704
    },
    "Ulcer": {
        "precision": 0.9683098793029785,
        "recall": 0.9615384340286255,
        "f1-score": 0.9649122953414917,
        "specificity": 0.9994320273399353
    },
    "Worms": {
        "precision": 1.0,
        "recall": 0.9264705777168274,
        "f1-score": 0.9618320465087891,
        "specificity": 1.0
    },
    "macro avg": {
        "precision": 0.8430299162864685,
        "recall": 0.8457340598106384,
        "f1-score": 0.8440046310424805,
        "specificity": 0.9889160990715027
    },
    "accuracy": 0.9340441226959229,
    "auc_roc_scores": {
        "Angioectasia": 0.9877549409866333,
        "Bleeding": 0.991080641746521,
        "Erosion": 0.9791316390037537,
        "Erythema": 0.9780067205429077,
        "Foreign Body": 0.9914816617965698,
        "Lymphangiectasia": 0.9959512948989868,
        "Normal": 0.9942666292190552,
        "Polyp": 0.9805569648742676,
        "Ulcer": 0.9998183250427246,
        "Worms": 0.999981701374054
    },
    "mean_auc": 0.9898030161857605,
    "average_precision_scores": {
        "Angioectasia": 0.8844997882843018,
        "Bleeding": 0.9157450795173645,
        "Erosion": 0.8356777429580688,
        "Erythema": 0.6824340224266052,
        "Foreign Body": 0.941001832485199,
        "Lymphangiectasia": 0.9277384877204895,
        "Normal": 0.9982399940490723,
        "Polyp": 0.7739750146865845,
        "Ulcer": 0.992502748966217,
        "Worms": 0.996143102645874
    },
    "mean_average_precision": 0.894795835018158,
    "mean_f1_score": 0.8440046310424805,
    "mean_specificity": 0.9889160990715027,
    "mean_sensitivity": 0.8457340598106384,
    "balanced_accuracy": 0.8457340598106384
}
2024-10-20 19:26:55,934 - DeiT - INFO - train_loss: 0.0167 | train_acc: 0.9787 | test_loss: 0.1391 | test_acc: 0.9340
2024-10-20 19:26:55,934 - DeiT - INFO - No improvement for 1 consecutive epochs.
2024-10-20 19:26:55,936 - DeiT - INFO - Epoch 20/20
2024-10-20 19:40:16,703 - DeiT - INFO - Train Metrics:
{
    "Angioectasia": {
        "precision": 0.9794392585754395,
        "recall": 0.9812734127044678,
        "f1-score": 0.9803555011749268,
        "specificity": 0.997726559638977
    },
    "Bleeding": {
        "precision": 0.9652448892593384,
        "recall": 0.9844253659248352,
        "f1-score": 0.974740743637085,
        "specificity": 0.9961042404174805
    },
    "Erosion": {
        "precision": 0.9757062196731567,
        "recall": 0.9299946427345276,
        "f1-score": 0.9523021578788757,
        "specificity": 0.9974626302719116
    },
    "Erythema": {
        "precision": 0.94526207447052,
        "recall": 0.9726355075836182,
        "f1-score": 0.9587534666061401,
        "specificity": 0.9937357902526855
    },
    "Foreign Body": {
        "precision": 0.9792036414146423,
        "recall": 0.9852002859115601,
        "f1-score": 0.9821928143501282,
        "specificity": 0.9975659251213074
    },
    "Lymphangiectasia": {
        "precision": 0.985722005367279,
        "recall": 0.9873178601264954,
        "f1-score": 0.9865192770957947,
        "specificity": 0.9984366297721863
    },
    "Normal": {
        "precision": 0.9908503890037537,
        "recall": 0.9818666577339172,
        "f1-score": 0.9863380789756775,
        "specificity": 0.9989957809448242
    },
    "Polyp": {
        "precision": 0.9773575067520142,
        "recall": 0.974760890007019,
        "f1-score": 0.9760574698448181,
        "specificity": 0.9974883794784546
    },
    "Ulcer": {
        "precision": 1.0,
        "recall": 0.9997288584709167,
        "f1-score": 0.999864399433136,
        "specificity": 1.0
    },
    "Worms": {
        "precision": 0.9997395277023315,
        "recall": 0.9994791746139526,
        "f1-score": 0.9996093511581421,
        "specificity": 0.9999703764915466
    },
    "macro avg": {
        "precision": 0.9798524975776672,
        "recall": 0.9796682596206665,
        "f1-score": 0.9796733260154724,
        "specificity": 0.9977486729621887
    },
    "accuracy": 0.9797378182411194,
    "auc_roc_scores": {
        "Angioectasia": 0.9999037981033325,
        "Bleeding": 0.9998071193695068,
        "Erosion": 0.99886155128479,
        "Erythema": 0.999477744102478,
        "Foreign Body": 0.9998815655708313,
        "Lymphangiectasia": 0.999944806098938,
        "Normal": 0.9996755123138428,
        "Polyp": 0.9997990131378174,
        "Ulcer": 1.0,
        "Worms": 0.9999998807907104
    },
    "mean_auc": 0.9997350573539734,
    "average_precision_scores": {
        "Angioectasia": 0.999150276184082,
        "Bleeding": 0.9982484579086304,
        "Erosion": 0.9910911321640015,
        "Erythema": 0.9952752590179443,
        "Foreign Body": 0.9990599155426025,
        "Lymphangiectasia": 0.9995220303535461,
        "Normal": 0.99825519323349,
        "Polyp": 0.9982048273086548,
        "Ulcer": 1.0,
        "Worms": 0.9999996423721313
    },
    "mean_average_precision": 0.9978806376457214,
    "mean_f1_score": 0.9796733260154724,
    "mean_specificity": 0.9977486729621887,
    "mean_sensitivity": 0.9796682596206665,
    "balanced_accuracy": 0.9796682596206665
}
2024-10-20 19:40:16,706 - DeiT - INFO - Test Metrics:
{
    "Angioectasia": {
        "precision": 0.811475396156311,
        "recall": 0.7967807054519653,
        "f1-score": 0.8040609359741211,
        "specificity": 0.9941157698631287
    },
    "Bleeding": {
        "precision": 0.8438355922698975,
        "recall": 0.8579387068748474,
        "f1-score": 0.8508287072181702,
        "specificity": 0.9963862299919128
    },
    "Erosion": {
        "precision": 0.729099690914154,
        "recall": 0.7852813601493835,
        "f1-score": 0.7561483979225159,
        "specificity": 0.9774988293647766
    },
    "Erythema": {
        "precision": 0.6474575996398926,
        "recall": 0.6430976390838623,
        "f1-score": 0.6452702879905701,
        "specificity": 0.9934322834014893
    },
    "Foreign Body": {
        "precision": 0.8941176533699036,
        "recall": 0.8941176533699036,
        "f1-score": 0.8941176533699036,
        "specificity": 0.9977203607559204
    },
    "Lymphangiectasia": {
        "precision": 0.8617647290229797,
        "recall": 0.8542274236679077,
        "f1-score": 0.8579794764518738,
        "specificity": 0.9970232248306274
    },
    "Normal": {
        "precision": 0.9800392389297485,
        "recall": 0.9750142693519592,
        "f1-score": 0.9775202870368958,
        "specificity": 0.936540961265564
    },
    "Polyp": {
        "precision": 0.7078189253807068,
        "recall": 0.6880000233650208,
        "f1-score": 0.6977687478065491,
        "specificity": 0.9909160733222961
    },
    "Ulcer": {
        "precision": 0.9753521084785461,
        "recall": 0.9685314893722534,
        "f1-score": 0.9719298481941223,
        "specificity": 0.9995582699775696
    },
    "Worms": {
        "precision": 0.9848484992980957,
        "recall": 0.9558823704719543,
        "f1-score": 0.9701492786407471,
        "specificity": 0.9999377727508545
    },
    "macro avg": {
        "precision": 0.8435810208320618,
        "recall": 0.8418871164321899,
        "f1-score": 0.8425773978233337,
        "specificity": 0.9883129000663757
    },
    "accuracy": 0.9338581562042236,
    "auc_roc_scores": {
        "Angioectasia": 0.9867385625839233,
        "Bleeding": 0.9912633895874023,
        "Erosion": 0.9785627126693726,
        "Erythema": 0.9814439415931702,
        "Foreign Body": 0.9928736686706543,
        "Lymphangiectasia": 0.9962054491043091,
        "Normal": 0.9942474961280823,
        "Polyp": 0.9801300764083862,
        "Ulcer": 0.9994066953659058,
        "Worms": 0.9994415044784546
    },
    "mean_auc": 0.990031361579895,
    "average_precision_scores": {
        "Angioectasia": 0.8800002336502075,
        "Bleeding": 0.917201578617096,
        "Erosion": 0.8336453437805176,
        "Erythema": 0.6741514205932617,
        "Foreign Body": 0.939978837966919,
        "Lymphangiectasia": 0.9287866353988647,
        "Normal": 0.9982205033302307,
        "Polyp": 0.7564163208007812,
        "Ulcer": 0.9913238883018494,
        "Worms": 0.9815617799758911
    },
    "mean_average_precision": 0.8901287317276001,
    "mean_f1_score": 0.8425773978233337,
    "mean_specificity": 0.9883129000663757,
    "mean_sensitivity": 0.8418871164321899,
    "balanced_accuracy": 0.8418871164321899
}
2024-10-20 19:40:16,707 - DeiT - INFO - train_loss: 0.0155 | train_acc: 0.9797 | test_loss: 0.1399 | test_acc: 0.9339
2024-10-20 19:40:16,708 - DeiT - INFO - No improvement for 2 consecutive epochs.
2024-10-20 19:40:16,711 - DeiT - INFO - Training completed. Best model at epoch 18 with combined score: 0.9210
